import{A as Qc,B as an,C as el,E as tl,F as ol,a as Dc,b as nn,c as Bc,d as Vc,f as qc,g as Hc,h as ai,i as Wc,p as $c,r as Gc,s as zc,u as Kc,v as Zc,w as Yc,y as Jc,z as Xc}from"https://app.framerstatic.com/chunk-INENDETB.js";import{a as cn}from"https://app.framerstatic.com/chunk-J24U346W.js";import{a as rl}from"https://app.framerstatic.com/chunk-V3YPSQHW.js";import{a as sn,b as Oc}from"https://app.framerstatic.com/chunk-56ZQTPX5.js";import{b as _c}from"https://app.framerstatic.com/chunk-MBF5FLJ6.js";import"https://app.framerstatic.com/chunk-Q7C7AGEO.js";import{A as Ac,B as Ze,C as Rc,D as tn,E as ii,F as jc,G as on,H as xc,I as si,J as rn,K as Fc,L as Uc,M as Nc,a as kr,b as hs,c as tc,d as oc,e as rc,f as d,g as Yt,h as sc,i as ac,j as Yr,k as cc,l as lc,m as pc,n as ri,o as mc,p as fc,q as yc,r as hc,s as vc,t as bc,u as Sc,v as Xr,w as Cc,x as Qr,y as wc,z as Ic}from"https://app.framerstatic.com/chunk-MD5HLGJY.js";import"https://app.framerstatic.com/chunk-DSERDOJV.js";import"https://app.framerstatic.com/chunk-GHAI6QGM.js";import"https://app.framerstatic.com/chunk-DSERDOJV.js";import"https://app.framerstatic.com/chunk-CLA6MD3D.js";import"https://app.framerstatic.com/chunk-HEXXU5LW.js";import{a as Gr,b as Be}from"https://app.framerstatic.com/chunk-W3IFBT3R.js";import"https://app.framerstatic.com/chunk-YH3RKPES.js";import"https://app.framerstatic.com/chunk-JAWKSEN5.js";import{P as Kr,g as Ja,ib as en,ka as Qo,v as Tt}from"https://app.framerstatic.com/chunk-FWUB2OBU.js";import{C as nc}from"https://app.framerstatic.com/chunk-3V7WN6QC.js";import{a as s}from"https://app.framerstatic.com/chunk-FL4POVUO.js";import"https://app.framerstatic.com/chunk-DD55VUMR.js";import"https://app.framerstatic.com/chunk-GS5KZNKX.js";import{e as Ga}from"https://app.framerstatic.com/chunk-CRLGSQFB.js";import{Ab as Ba,F as Na,Hd as Va,I as du,Id as qa,Kd as Ha,Ld as Wa,Od as $a,Ve as Za,Xb as _a,Ye as Ya,a as ms,b as Gn,c as ds,d as us,e as fs,f as gs,g as ys,hf as ti,jf as oi,l as xa,m as La,u as Qn,v as Ua,w as C,x as rt,y as yt}from"https://app.framerstatic.com/chunk-JCMPKQMJ.js";import"https://app.framerstatic.com/chunk-DSERDOJV.js";import"https://app.framerstatic.com/chunk-UGTINA4M.js";import"https://app.framerstatic.com/chunk-F7NGTTMP.js";import{X as Ra,c as Ls,md as zr}from"https://app.framerstatic.com/chunk-N62MZVVV.js";import{e as Da}from"https://app.framerstatic.com/chunk-GMGYALSL.js";import"https://app.framerstatic.com/chunk-5GPLGJBJ.js";import"https://app.framerstatic.com/chunk-YNETUNJC.js";import"https://app.framerstatic.com/chunk-XL4HHLKU.js";import"https://app.framerstatic.com/chunk-UEHVGUV3.js";import"https://app.framerstatic.com/chunk-B2IBNAJ6.js";import"https://app.framerstatic.com/chunk-RAGJTGMK.js";import"https://app.framerstatic.com/chunk-DSERDOJV.js";import{H as Lc,e as dc,f as uc,w as tr}from"https://app.framerstatic.com/chunk-XGC63FPG.js";import"https://app.framerstatic.com/chunk-Q4BH2KDO.js";import"https://app.framerstatic.com/chunk-GVUHZY5J.js";import"https://app.framerstatic.com/chunk-VNVJYMIT.js";import{a as er,c as Jr,f as gc,g as ni,l as Pc}from"https://app.framerstatic.com/chunk-WQOZLKZD.js";import{a as Se}from"https://app.framerstatic.com/chunk-VGOXK5NS.js";import{a as wo,b as Io}from"https://app.framerstatic.com/chunk-M6SYOE37.js";import{d as Ka}from"https://app.framerstatic.com/chunk-343OC6BN.js";import"https://app.framerstatic.com/chunk-QEZAGZZ4.js";import"https://app.framerstatic.com/chunk-KCRDHQ4E.js";import{b as E}from"https://app.framerstatic.com/chunk-P62HMCIK.js";import{A as Mc,C as Ec,v as kc,w as Tc}from"https://app.framerstatic.com/chunk-DTGRQ6I6.js";import"https://app.framerstatic.com/chunk-WCFPQ6TF.js";import"https://app.framerstatic.com/chunk-L6CRAHXJ.js";import"https://app.framerstatic.com/chunk-EKWQMBYQ.js";import{b as ic}from"https://app.framerstatic.com/chunk-47IYVVWD.js";import{c as Zr}from"https://app.framerstatic.com/chunk-LQIEW443.js";import{a as Wr,c as $r,e as Fa}from"https://app.framerstatic.com/chunk-XKJPCEMW.js";import"https://app.framerstatic.com/chunk-DSERDOJV.js";import{d as gt}from"https://app.framerstatic.com/chunk-VG723PYU.js";import{D as Zt,E as Oe,F as be,K as Co,L as Ia,O as ka,P as Po,Q as Ke,S as Ta,T as Ma,U as Ea,X as Aa,Y as Hr,ea as kt,f as ya,h as ha,i as Or,j as Xn,k as Br,l as _r,m as Vr,n as va,o as qr,p as Xo,q as ba,r as So,s as Sa,t as Ca,u as Pa,v as wa}from"https://app.framerstatic.com/chunk-Q2X7KIBC.js";import"https://app.framerstatic.com/chunk-P4EPE6MV.js";import"https://app.framerstatic.com/chunk-YS6AIAKZ.js";import"https://app.framerstatic.com/chunk-BTHOS2UU.js";import"https://app.framerstatic.com/chunk-5OT6VZ2X.js";import"https://app.framerstatic.com/chunk-AYPJYRAD.js";import"https://app.framerstatic.com/chunk-JB6O2ZHZ.js";import{a as ht}from"https://app.framerstatic.com/chunk-LL55HCXN.js";import"https://app.framerstatic.com/chunk-3W6ZTZAY.js";import"https://app.framerstatic.com/chunk-S6FXAQW3.js";import"https://app.framerstatic.com/chunk-PMAOQFH2.js";import"https://app.framerstatic.com/chunk-44X45VL3.js";import"https://app.framerstatic.com/chunk-UKMR7LKE.js";import"https://app.framerstatic.com/chunk-TJMMUQMT.js";import"https://app.framerstatic.com/chunk-W66R4FHL.js";import"https://app.framerstatic.com/chunk-ASW726LD.js";import"https://app.framerstatic.com/chunk-DVJXKY62.js";import"https://app.framerstatic.com/chunk-OKOAMIYK.js";import"https://app.framerstatic.com/chunk-BF2NTWHL.js";import{$u as mo,Ai as qs,Bb as Bs,Cb as Rr,Du as ea,Fq as Zn,Gi as Hs,Jq as Zs,Ps as Js,Rq as Yn,Rv as ta,Tk as Ws,Uk as $s,Wk as jr,Wq as Ys,Xd as Vs,Zb as _s,_v as Ko,d as Fs,il as Gs,kt as Xs,mb as Ds,oj as L,sb as Ut,tb as Ar,xb as Os}from"https://app.framerstatic.com/chunk-DKOXMNKG.js";import"https://app.framerstatic.com/chunk-CKP2GXTU.js";import"https://app.framerstatic.com/chunk-ZAVCCCEM.js";import"https://app.framerstatic.com/chunk-DSERDOJV.js";import{c as zs,d as Ks,j as Nt}from"https://app.framerstatic.com/chunk-OVRPKLAN.js";import{b as Qs,f as q}from"https://app.framerstatic.com/chunk-HDYNDSQI.js";import"https://app.framerstatic.com/chunk-2XLEMDET.js";import{a as ps,b as za}from"https://app.framerstatic.com/chunk-J4D3ZIM5.js";import{a as Bt}from"https://app.framerstatic.com/chunk-JCSLEJQI.js";import"https://app.framerstatic.com/chunk-XG7HFYCL.js";import"https://app.framerstatic.com/chunk-KRXOCUZK.js";import"https://app.framerstatic.com/chunk-M7IU6JKZ.js";import{$e as fa,Ad as F,Bd as ma,Cd as ne,Ce as Nr,D as xr,Da as Yo,De as Dr,E as na,Ec as ca,Ed as J,Fd as yo,Fe as ft,Gc as la,Gd as tt,Ia as ia,Jd as Jo,Kd as k,Nd as ho,Ne as bo,Oa as go,Od as da,Pa as sa,Qd as ua,Sd as ye,Wa as Lr,Xd as Fr,_d as vo,_e as Jn,c as fo,d as Zo,eb as aa,ff as ga,oe as Dt,pe as Ot,se as ot,ve as Ur,xa as ze,zd as pa}from"https://app.framerstatic.com/chunk-2WLVVGB2.js";import{a as Qa,b as ec}from"https://app.framerstatic.com/chunk-FVJCUIQH.js";import{a as ko}from"https://app.framerstatic.com/chunk-GSGXB2GS.js";import"https://app.framerstatic.com/chunk-SFYC6EGM.js";import{b as Oa}from"https://app.framerstatic.com/chunk-6AHRWCXD.js";import{a as ei}from"https://app.framerstatic.com/chunk-GK6AYZCV.js";import{i as uo,k as oa,p as ra}from"https://app.framerstatic.com/chunk-SAE32BGN.js";import{R as Rs,S as Ns,j as zt}from"https://app.framerstatic.com/chunk-QBNACNR4.js";import{b as ut,c as zo,e as Us}from"https://app.framerstatic.com/chunk-F4NXOBHC.js";import{b as Ps}from"https://app.framerstatic.com/chunk-J2WXO73V.js";import"https://app.framerstatic.com/chunk-BYZCNSNK.js";import"https://app.framerstatic.com/chunk-DETFLWJD.js";import"https://app.framerstatic.com/chunk-QWSCHP2Z.js";import{a as ja}from"https://app.framerstatic.com/chunk-RROMVHYB.js";import{a as Xa}from"https://app.framerstatic.com/chunk-FABTAVFP.js";import{a as V}from"https://app.framerstatic.com/chunk-6KZDXDRD.js";import{Na as Ie,Oa as Kt,V as Es,u as Ts,w as Ms}from"https://app.framerstatic.com/chunk-MQUEQ42D.js";import{l as Er,r as js,v as It,x as Ft,z as xs}from"https://app.framerstatic.com/chunk-DDX2LCTW.js";import"https://app.framerstatic.com/chunk-S3XK3B27.js";import{a as Is,b as ks}from"https://app.framerstatic.com/chunk-M5JBPS3M.js";import"https://app.framerstatic.com/chunk-TWKDNXKF.js";import{a as As}from"https://app.framerstatic.com/chunk-AD2YDBYK.js";import{Sa as ws,Ta as Mr,a as N,ka as se,pa as dt}from"https://app.framerstatic.com/chunk-SSFV7Z3X.js";import{a as _}from"https://app.framerstatic.com/chunk-BG526CLQ.js";import{C as Te,D as lo,E as Fe}from"https://app.framerstatic.com/chunk-ZQZGYOKV.js";import{c as ls,e as pt}from"https://app.framerstatic.com/chunk-N7CDOI6S.js";import{A as Kn,B as Tr,C as $o,D as Ss,J as Go,X as Cs,d as po,e as ce,f as pe,h as O,i as vs,l as mt,v as bs,y as zn}from"https://app.framerstatic.com/chunk-6P446G74.js";import{e as g,g as wt,h as wr,i as Ir}from"https://app.framerstatic.com/chunk-G6RVR2BI.js";var To;(p=>{p.copyFilePath=a=>{if(typeof a!="object"||a===null)throw new Error(`Expected FilePath object but received: ${a}`);return Object.freeze({path:Te.Validation.copyString(a.path)})},p.copyFile=a=>{if(typeof a!="object"||a===null)throw new Error(`Expected File object but received: ${a}`);return Object.freeze({path:Te.Validation.copyString(a.path),content:Te.Validation.copyString(a.content)})},p.copyFileResult=a=>{if(typeof a!="object"||a===null)throw new Error(`Expected FileResult object but received: ${a}`);return Object.freeze({file:p.copyFileOrDirectoryMetadata(a.file)})},p.copyFileListResult=a=>{if(typeof a!="object"||a===null)throw new Error(`Expected FileListResult object but received: ${a}`);return Object.freeze({fileList:Te.Validation.copyArray.bind(void 0,p.copyFileOrDirectoryMetadata)(a.fileList)})};let i={file:a=>{if(typeof a!="object"||a===null)throw new Error(`Expected non-null object but received: ${a}`);return Object.freeze({type:"file",path:Te.Validation.copyString(a.path),content:Te.Validation.copyOptional.bind(void 0,Te.Validation.copyString)(a.content)})},directory:a=>{if(typeof a!="object"||a===null)throw new Error(`Expected non-null object but received: ${a}`);return Object.freeze({type:"directory",path:Te.Validation.copyString(a.path)})}};p.copyFileOrDirectoryMetadataType=a=>{if(typeof a!="string")throw new Error(`Expected string for type but received: ${a}`);if(!i[a])throw new Error(`Expected valid value for type but received: ${a}`);return a},p.copyFileOrDirectoryMetadata=a=>{if(typeof a!="object"||a===null)throw new Error(`Expected FileOrDirectoryMetadata object but received: ${a}`);let u=a.type;if(typeof u!="string")throw new Error(`Expected string for type but received: ${a}`);let v=i[u];if(!v)throw new Error(`Expected valid value for type but received: ${a}`);return v(a)},p.copyBuildOutputFile=a=>{if(typeof a!="object"||a===null)throw new Error(`Expected BuildOutputFile object but received: ${a}`);return Object.freeze({filename:Te.Validation.copyString(a.filename),contents:Te.Validation.copyString(a.contents)})},p.copyBuildOutput=a=>{if(typeof a!="object"||a===null)throw new Error(`Expected BuildOutput object but received: ${a}`);return Object.freeze({files:Te.Validation.copyArray.bind(void 0,p.copyBuildOutputFile)(a.files)})}})(To||(To={}));var{onewayMethodTemplate:Ng,voidMethodTemplate:nl,valueMethodTemplate:ci,streamMethodTemplate:uu}=Te,ln;(e=>e.service={id:"__Files__",fingerprint:"c5bf053de2ec5854cd50f4b4c3b84ae8",methods:{saveFile:{},deleteFile:{},getFile:{},getFileList:{},buildOutputStream:{},getBuildOutput:{}},newOutgoingWrapper:(o,r)=>{let{validateValues:i}=o;return{saveFile:nl.bind(-1,"saveFile",!0,r),deleteFile:nl.bind(-1,"deleteFile",!0,r),getFile:ci.bind(-1,"getFile",!0,i?To.copyFileResult:void 0,r),getFileList:ci.bind(-1,"getFileList",!1,i?To.copyFileListResult:void 0,r),buildOutputStream:uu.bind(-1,"buildOutputStream",r),getBuildOutput:ci.bind(-1,"getBuildOutput",!0,i?To.copyFileResult:void 0,r)}}})(ln||(ln={}));var Mo;(r=>{r.service=ln.service;function e(i){let n=lo.shared();return{expect:c=>n.expectWithoutDiscovery(r.service,i,c),discover:c=>n.discover(r.service,i,c),register:c=>n.register({channel:i,service:r.service,implementation:c})}}r.on=e;async function o(i){lo.shared().unregister(i)}r.unregister=o})(Mo||(Mo={}));var{onewayMethodTemplate:ey,voidMethodTemplate:fu,valueMethodTemplate:ty,streamMethodTemplate:gu}=Te,pn;(e=>e.service={id:"__FileUpdates__",fingerprint:"bf8799d0b289a18e9b9b6eccc76173fa",methods:{fileUpdatesStream:{},notify:{}},newOutgoingWrapper:(o,r)=>{let{validateValues:i}=o;return{fileUpdatesStream:gu.bind(-1,"fileUpdatesStream",r),notify:fu.bind(-1,"notify",!0,r)}}})(pn||(pn={}));var mn;(r=>{r.service=pn.service;function e(i){let n=lo.shared();return{expect:c=>n.expectWithoutDiscovery(r.service,i,c),discover:c=>n.discover(r.service,i,c),register:c=>n.register({channel:i,service:r.service,implementation:c})}}r.on=e;async function o(i){lo.shared().unregister(i)}r.unregister=o})(mn||(mn={}));var yu={track:!0};function il(t){let e={...t,event:"file_save"};Ps(e,yu)}var at=g(_());var al=g(_());var dn=null;function sl(){return dn||(dn=hu(),dn)}function hu(){return Mo.on(Na).discover()}var vu=mt("useLegacyBuildOutput"),bu=["index.js","vendors.js"];async function Su(){let t={};for(let e of bu)try{let o=await sl(),{file:r}=await o.getBuildOutput({path:e});r.type==="file"&&r.content&&(t[e]=r.content)}catch(o){vu.debug("Could not load build output:",o)}return t}function cl(){(0,al.useEffect)(()=>{Ie.isOn("sites")||Ie.isOn("codeModules")&&Ie.get("packages")==="off"||Su().then(t=>{Object.keys(t).length!==0&&(oi.shared().componentsStore.updateBundleScripts(t),oi.shared().previewConnection.sendScriptsUpdate())}).catch(O)},[])}function ll(t){let e=po(),o=new URL(e.app);return o.protocol=o.protocol==="http:"?"ws:":"wss:",o.pathname=`/projects/${t}/socket`,o.href}var or,Jt,_t,un=class{constructor(e){this.localHandler=e;wr(this,or,void 0);wr(this,Jt,{});wr(this,_t,null);this.socketStats=null}get treeSchema(){return this.localHandler.treeSchema}get treeVersion(){return this.localHandler.treeVersion()}setSendFunction(e){Ir(this,_t,e)}setGetUserInfoFunction(e){this.localHandler.getUserInfo=e}sendMessage(e){wt(this,_t)&&wt(this,_t).call(this,e)}onConnect(){this.localHandler.setRemoteConnection(this)}onDisconnect(e){this.localHandler.setRemoteConnectionFailure(e)}onMessage(e){switch(e.type){case"leave":this.localHandler.handleLeave(e.id);break;case"lock":this.localHandler.handleLock(e.id,e.value);break;case"state":e.id===wt(this,or)&&Object.assign(wt(this,Jt),e.value),this.localHandler.handleUserStateUpdate(e.id,e.value);break;case"treeMessage":this.localHandler.handleTreeMessage(e.id,e.value);break;case"treeUpdate":this.localHandler.handleTreeUpdate(e.id,e.value);break;case"treeVerify":this.localHandler.handleTreeVerify(e.value);break;case"welcome":{let{userId:o,userStates:r,protocolVersion:i}=e.value;Ir(this,or,o),Ir(this,Jt,{...r[o]});for(let[n,c]of Object.entries(r))this.localHandler.handleUserStateUpdate(n,c);i&&i>Va&&E({type:"add",variant:"warning",key:"outdated-client",text:"A new version of Framer is available.",duration:1/0});break}}}setSocketStats(e){this.socketStats=e}rtt(){return this.socketStats?this.socketStats.rtt():NaN}updateUserState(e){if(!wt(this,_t))return;let o=!1,r={};for(let i of Object.keys(e))e[i]!==void 0&&(Es(e[i],wt(this,Jt)[i],!0)||(r[i]=e[i],o=!0));o&&(Object.assign(wt(this,Jt),r),wt(this,_t).call(this,{type:"state",value:r}))}};or=new WeakMap,Jt=new WeakMap,_t=new WeakMap;var fn=g(_());function pl(t,e){let[o,r]=(0,fn.useReducer)((i,n)=>{let c=Oa(i,m=>Cu(m,n));return s.processWhenReady(()=>s.projectStore.update(c)),c},t,i=>({acl:[],accessRequests:[],aclById:{},activeIds:new Set,projectId:i,userStates:{}}));return(0,fn.useEffect)(()=>e.onMessage(i=>{r({type:"handleMessage",message:i})}),[e]),[o,r]}function Cu(t,e){if(e.type==="handleMessage"){let{message:o}=e;if(o.type==="join"){if(t.activeIds.has(o.id)){console.warn("User joined twice:",o.id);return}else t.activeIds.add(o.id);t.userStates[o.id]={}}else if(o.type==="leave"){if(t.activeIds.has(o.id))t.activeIds.delete(o.id);else{console.warn("Unknown user left:",o.id);return}delete t.userStates[o.id]}else if(o.type==="state"){let r=t.userStates[o.id];if(!r){console.warn("Got user state data for unknown user:",o.id);return}Object.assign(r,o.value)}else o.type==="welcome"&&(t.activeIds=new Set(Object.keys(o.value.userStates)),t.userStates=o.value.userStates)}else if(e.type==="updateACL"||e.type==="resetACL"){let o={};for(let r of e.acl)o[r.user.id]=r;if(e.type==="resetACL"){t.acl=e.acl,t.accessRequests=e.accessRequests,t.aclById=o;return}t.aclById={...t.aclById,...o},t.acl=Object.keys(t.aclById).map(r=>t.aclById[r])}else e.type==="updateProject"?(ce(t.project,"Project must be set before updating it"),Object.assign(t.project,e.changes)):e.type==="setProject"?t.project===void 0?t.project=e.project:Object.assign(t.project,e.project):pe(e)}var ml=g(_());var gn=class{constructor(e){this.api=e}async getThreads(e){return this.api.getThreads(e)}async createThread(e){return{thread:await this.api.createThread(e)}}async updateThread(e){return{thread:await this.api.updateThread(e)}}async markAsSeen(e){return{thread:await this.api.markAsSeen(e)}}async createComment(e){return{comment:await this.api.createComment(e)}}async updateComment(e){return{comment:await this.api.updateComment(e)}}async deleteComment(e){return{comment:await this.api.deleteComment(e)}}};function dl({api:t,channel:e,engine:o}){(0,ml.useEffect)(()=>{if(!e)return;let r=ms.on(e).register(new gn(t));return o.feedbackStore.initialize(o).catch(O),r},[t,e,o])}var fl=g(_());async function rr(t){if(t.status>=200&&t.status<300)return t;throw new Error(t.statusText)}async function li(t){return t.json()}function ul(t){return{type:t.dir?"directory":"file",path:t.path,content:t.content}}var yn=class{constructor(e,o,r){this.projectId=e;this.api=o;this.fileUpdatesService=r;this.buildOutputEmitter=new pt;this.buildOutputStream=this.buildOutputEmitter.newStream;this.buildRequestFileMap=new Map}async saveFile(e){let o=performance.now(),r=!1;try{let{path:i,content:n}=e,c=(this.buildRequestFileMap.get(i)||0)+1;this.buildRequestFileMap.set(i,c);let m=await this.api.saveFile(i,n);await rr(m),this.broadcast([{path:i,type:"added"}])}catch(i){throw r=!0,i}finally{il({durationMs:Math.round(performance.now()-o),failed:r,filename:e.path,fileSize:e.content.length})}}async deleteFile(e){let{path:o}=e,r=(this.buildRequestFileMap.get(o)||0)+1;this.buildRequestFileMap.set(o,r);let i=await this.api.deleteFile(o);await rr(i),this.broadcast([{path:o,type:"deleted"}])}async getFile(e){let o=await this.api.getFile(e.path);await rr(o);let r=await li(o);return{file:ul(r)}}async getFileList(){let e=await this.api.getFileList();await rr(e);let{files:o}=await li(e);return{fileList:o.map(ul)}}async handleBuildOutputResponse(e,o,r){let i=await li(e);if(r!==this.buildRequestFileMap.get(o))return;let n=[];for(let c in i.chunks){let m=i.chunks[c];m&&n.push({filename:c,contents:m})}this.buildOutputEmitter.emit({files:n})}async getBuildOutput(e){let{path:o}=e,r=await this.api.getBuildOutput(o);await rr(r);let i=await r.text();return{file:{type:"file",path:o,content:i}}}broadcast(e){this.fileUpdatesService.notify({files:e}).catch(O)}};function gl({projectId:t,api:e,channel:o,fileUpdatesService:r}){(0,fl.useEffect)(()=>{if(o)return Mo.on(o).register(new yn(t,e,r))},[t,e,o,r])}var Eo=g(_());var hn=class{constructor(e){this.socket=e;this.fileUpdatesEmitter=new pt;this.fileUpdatesStream=this.fileUpdatesEmitter.newStream;this.socket.onMessage(o=>{if(o.type==="fileUpdate"){let r=o.value;this.fileUpdatesEmitter.emit(r)}})}async notify(e){this.socket.send({type:"fileUpdate",value:e})}};function yl({channel:t,socket:e}){let o=(0,Eo.useRef)((0,Eo.useMemo)(()=>new hn(e),[e]));return(0,Eo.useEffect)(()=>{if(t)return mn.on(t).register(o.current)},[t]),o.current}var vl=g(_());var pi="http://127.0.0.1:37263",Vt=class{static async getVersion(){try{return await fetch(`${pi}/version`,{mode:"cors"}).then(e=>e.json())}catch{throw new Error("Framer Tools app is not found")}}static async sampleColor(){return await Vt.getVersion(),fetch(`${pi}/sample_color`,{mode:"cors"}).then(e=>e.json())}static async getPermissions(){return await Vt.getVersion(),fetch(`${pi}/permissions`,{mode:"cors"}).then(e=>e.json()).catch(()=>({}))}};var hl={type:"add",variant:"info",icon:"color-wheel",action:{title:"Install",onClick:Ta},text:"To sample colors, please use the new desktop app",key:"install-desktop-app",duration:5e3};function bl({channel:t,toast:e}){(0,vl.useEffect)(()=>{if(!t)return;let o={async sampleColor(){if(window.EyeDropper)return{color:(await new EyeDropper().open().catch(n=>{if((n==null?void 0:n.name)==="AbortError")return{sRGBHex:void 0};throw n})).sRGBHex};if(Fa())return e(hl),{};try{let r=await Vt.getPermissions();return(r==null?void 0:r.screen)===!1?(e({type:"add",variant:"info",icon:"apple",action:{title:"Learn More",onClick:()=>{Ke("https://www.framer.com/support/using-framer/color-picker-access/")}},text:"Framer Tools requires Screen Recording access",key:"screen-permissions",duration:5e3}),{}):await Vt.sampleColor()}catch(r){return r instanceof Error&&r.message!=="Framer Tools app is not found"?{}:(e(hl),{})}}};return ys.on(t).register(o)},[t,e])}var Sl=g(_());function Cl({channel:t,api:e,socket:o,fileUpdatesService:r}){(0,Sl.useEffect)(()=>{if(!t)return;let i=new pt,n=o.onMessage(async l=>{if(l.type!=="moduleEvents")return;let p=await Promise.all(l.value.events.map(async a=>{if(a.type==="delete")return a;if(a.type==="save")return{type:"save",module:await e.getModule({moduleId:a.id})};pe(a)}));i.emit({events:p})});function c(l){o.send({type:"moduleEvents",value:{events:l}})}let m=ds.on(t).register({async create(l){let p=await e.createModule(l);return c([{type:"save",id:p.id,saveId:p.saveId}]),r.notify({files:[{type:"added",path:p.name}]}),p},async delete(l){let p=await e.deleteModule(l);return c([{type:"delete",id:p.id}]),r.notify({files:[{type:"deleted",path:p.name}]}),p},async getModuleDependencies(l){return e.getModuleDependencies(l)},async list(l){return await e.listModules(l)},async listNamespaces(){return await e.listNamespaces()},async listPublishedModules(l){return await e.listPublishedModules(l)},async lookUpModules(l){return await e.lookUpModules(l)},moduleEventsStream:i.newStream,async publish(l){return await e.publishModule(l)},async save(l){let p=await e.saveModule(l);return c([{type:"save",id:p.id,saveId:p.saveId}]),r.notify({files:[{type:"changed",path:p.name}]}),p},async saveBatch(l){let p=await e.saveModules(l);return c(p.data.map(a=>({type:"save",id:a.id,saveId:a.saveId}))),r.notify({files:p.data.map(a=>({type:"changed",path:a.name}))}),p},async update(l){let p=await e.updateModule(l);return c([{type:"save",id:p.id,saveId:p.saveId}]),p}});return()=>{n(),m()}},[t,o,e,r])}var Pl=g(_());var vn=class{constructor(e){this.api=e}async listPhotos(e){return this.api.listPhotos(e)}async searchPhotos(e){return this.api.searchPhotos(e)}async getRandomPhoto(e){return this.api.getRandomPhoto(e)}async downloadPhoto(e){return this.api.downloadPhoto(e)}};function wl({api:t,channel:e}){(0,Pl.useEffect)(()=>{if(e)return us.on(e).register(new vn(t))},[t,e])}var fi=g(_());var nr;(U=>{async function t(){if(!s.loadingStore.documentLoaded)return new Promise(f=>{let y=s.changes.observe(s.loadingStore,async()=>{s.loadingStore.documentLoaded&&(s.changes.removeObserver(y),f())})})}U.ready=t;function e(f){return u(s.getNode(f))}U.get=e;function o(f){return s.processWhenReadyAsync(()=>{let y=[];for(let b of s.tree.root.walk()){let P=u(b);f(P)&&y.push(P)}return y})}U.find=o;function r(f){let y=S(),b=w([f]);return s.modulesStore.addExternalModulesToProject([...b],{onTreeUpdate:()=>{let{__parentId:P,__position:A,...M}=u(f);if(P&&!ut(P))throw y.getError("Invalid parentId property");let R=s.getNode(P&&ut(P)?P:s.scopeStore.activeId);if(!R)throw y.getError("Parent not found");return u(v(y,M,R.id,zo(A)?A:void 0))}})}U.create=r;async function i(f){let y=S(),b=w(f);return s.modulesStore.addExternalModulesToProject([...b],{onTreeUpdate:()=>{let P=[];for(let A of f){let{id:M,__parentId:R,__position:h,children:T,__class:j,...D}=A;if(!M||!ut(M))throw y.getError('Missing a valid "id" field');let W=s.getNode(M);if(!W)throw y.getError("Not found",M);if(R&&ut(R)){let Y=s.getNode(R);if(!Y)throw y.getError("Not found as parent",R);if(!Hs(s.tree,Y,W,s.scopeStore.active.id,zt))throw y.getError(`Cannot move to parent with ID ${R}`,M)}T&&y.warn("Skipping children, recursive updates not supported",M),j&&y.warn("Node type (__class) cannot be updated",M);let $=u(W),Z=Object.keys($),he={};Object.keys(D).forEach(Y=>{if(!Z.includes(Y)&&!Fs(Y)){y.warn("Skipping setting ${key}, not found on original",M);return}he[Y]=D[Y]}),P.push(()=>{if(W.set(D),ut(R)||zo(h)){let Y=ut(R)?R:W.parentid,De=zo(h)?h:void 0;s.moveNode(W.id,Y,De)}})}P.map(A=>A())}})}U.update=i;async function n(f,...y){return s.processWhenReadyAsync(()=>{[f,...y].forEach(b=>{s.tree.remove(b)})})}U.remove=n;function c(){return u(s.selection.nodes[0])}U.selected=c;async function m(f,y=!0){return s.processWhenReadyAsync(()=>{let b=s.getNode(f);if(b&&(s.scopeStore.selectByNode(b.id),s.selection.set(b.id),y)){let P=s.tree.getBoundingFrameForNodes([b]);s.canvasStore.zoomToCenter(P,{animated:s.persistedUserDefaults.animateOnZoom})}})}U.select=m;function l(f){let y=s.getNode(f);if(!(y instanceof Zn))return;let b=s.modulesStore.getPersistedModuleByLocalIdentifier(y.codeComponentIdentifier);if(b)return`${b.importURL}@${b.saveId}`}U.componentURL=l;function p(f){let y=Go(f);if(!y)return;let b=zt.componentForIdentifier(f);if(!b)return;let{name:P,properties:A,file:M,packageIdentifier:R}=b,h={name:P,properties:A};if(Tr(y))return y.type==="codeFile"?{...h,file:M}:h;if(Kn(y))return{...h,url:R}}U.componentInfo=p;async function a(f,y){let b=S(),{reorder:P=!1,reset:A=!1}=y||{};return s.processWhenReadyAsync(()=>{let M=s.tree.ensureColorStyleTokenListNode(),R=[],h;A&&(h=new Set(M.children.filter(T=>T.installed).map(T=>T.id))),Object.entries(f).forEach(([T,{name:j,color:D,darkColor:W}])=>{let $=s.getNode(T);if($===null)s.tree.insertNode(new Yn({id:T,name:j,light:D,dark:W,installed:!0}),M.id),R.unshift(T);else{if(!($ instanceof Yn)||$.parentid!==M.id){b.warn("Node exists but is not a color, skipping",T);return}$.set({name:j,light:D,dark:W,installed:!0}),R.unshift(T)}h==null||h.delete(T)}),P&&R.forEach(T=>{s.tree.move(T,M.id,0)}),h==null||h.forEach(T=>{s.tree.remove(T)})})}U.installColors=a;function u(f){if(!f)return;let y=["cache","mutable","update"],b={};return Object.keys(f).forEach(P=>{if(y.includes(P))return;let A=f[P];P==="children"&&(A=A==null?void 0:A.map(u)),b[P]=A}),b}function v(f,y,b,P){if(!y)throw f.getError("Missing properties");let A=Js,{id:M,__class:R,children:h,...T}=y;switch(R){case"CodeComponentNode":{A=Zn;break}case"CanvasPageNode":{A=Xs,b=void 0;break}}let j=s.tree.create(A,b,T);if(j.parentid&&zo(P)&&s.tree.moveNode(j,j.parentid,P),Array.isArray(h))try{h.forEach(D=>v(f,D,j.id))}catch(D){throw s.tree.remove(j.id),D}return j}function w(f,y=new Set){for(let{__class:b,codeComponentIdentifier:P,children:A}of f){if(Us(A)&&w(A,y),b!=="CodeComponentNode"||!ut(P))continue;let M=Go(P);!M||!Kn(M)||!$o(M)||y.add(M)}return y}function S(){var h,T,j;let f=new Error,y=(T=(h=f.stack)==null?void 0:h.split(`
`))!=null?T:[],b;y[0]==="Error"?(b=y[2],y[0]="Error: $$message$$",y.splice(1,1)):y.splice(0,1);let P=b==null?void 0:b.match(/\s*at Object\.(\S+)( \[as (\S+)\])?/),A=P?`.${(j=P[3])!=null?j:P[1]}`:"",M=(D,W)=>{let $=W?`[Node ${W}] `:"";return`VEX${A}: ${$}${D}`},R=D=>{var $,Z;let W=[...y];return W[0]=(Z=($=W[0])==null?void 0:$.replace("$$message$$",D))!=null?Z:"",W.join(`
`)};return{warn:(D,W)=>{console.warn(M(D,W))},getError:(D,W)=>(f.message=M(D,W),f.stack=R(f.message),f)}}})(nr||(nr={}));var ui=g(_());var kl=g(_()),Ao={},qt=window,di=new class{updateActionManager(t){qt&&(qt.actionManager=t)}hotKeysDisabled(){if(s.chromeStore.isProjectMenuOpen)return!0;switch(s.chromeStore.mainView){case 3:return!0;default:return!1}}};function Tl(t){if("_bridge"in t)return;qt=t,qt._bridge=(o,...r)=>{var i;Ao[o]&&((i=Ao[o])==null||i.forEach(n=>n(...r)))};function e(o){qt==null||qt._bridge("error",o)}qt.addEventListener("error",e)}function Ml(t){(0,kl.useEffect)(()=>(t((e,o)=>{var r;Ao[e]||(Ao[e]=[]),(r=Ao[e])==null||r.push(o)}),()=>{Ao={}}),[t])}var El="container_c1m6xhbt";var bn=g(N()),wu=za(s.canvasStore.assetMap);Rs({assetResolver:wu,fetchGoogleFontsList:ec,fetchFontshareFontsList:Qa,enableFontStore:!0,executionTimeBudgets:{frame:500,component:150},experiments:It,projectFeatures:Ie});if(s.chromeStore.userIsEmployee||bs.isDevelopment)window.Vekter=Ja.Vekter,window.VEX=nr;else{let t=["e96bd9c5-e994-4069-955c-a665e70135ef"];(window==null?void 0:window.framerUser.spaces.some(o=>be(o)&&o.organization&&t.includes(o.organization.id)))&&(window.VEX=nr)}Ts({target:Ms.canvas});var Al=ui.default.memo(()=>{let{isDarkMode:t}=Se(),{isSmartComponentOverlayEditMode:e,isGraphicMode:o}=Tt([s.scopeStore,s.chromeStore,s.overlayStore,s.toolStore],()=>({isGraphicMode:s.toolStore.shapeModeActive,isSmartComponentOverlayEditMode:Ut(s.scopeStore.active)&&s.overlayStore.editModeActive&&s.chromeStore.mainView===0}));return s.documentSettings.syncDarkAppearance(t),Tl(window),window.addEventListener("touchmove",Iu,{passive:!1}),ui.default.useEffect(()=>{document.body.classList.toggle(tc,e),document.body.classList.toggle(oc,e&&o)},[e,o]),(0,bn.jsx)("div",{className:El,children:(0,bn.jsx)(rc,{children:(0,bn.jsx)(Nc,{})})})});function Iu(t){t.preventDefault(),t.stopPropagation()}var vt=g(N());function Rl({socket:t,projectId:e,userId:o,documentConnection:r}){return(0,fi.useEffect)(()=>{r.setSendFunction(m=>{t.send(m)});let i=t.onConnect(m=>{r.onConnect(),m||s.modulesStore.refresh().catch(O)}),n=t.onDisconnect(m=>r.onDisconnect(m)),c=t.onMessage(m=>r.onMessage(m));return t.connect(),()=>{i(),n(),c()}},[r,t,e,o]),(0,fi.useEffect)(()=>t.onDisconnect(n=>{switch(n){case"AccessDenied":{window.location.reload();break}case"DocumentNotFound":{E({type:"add",variant:"error",key:"document-not-found",text:"The project data could not be loaded. If this error persists, please notify Framer Support.",duration:1/0,icon:"error",showCloseButton:"never"});break}case"UnsupportedSchema":{E({type:"add",variant:"error",key:"unsupported-schema",text:"Outdated document version. Opening this document is no longer supported.",duration:1/0,icon:"error",showCloseButton:"never"});break}}}),[t,e]),(0,vt.jsx)(nn,{location:"vekter",title:"Failed to load editor",description:(0,vt.jsxs)(vt.Fragment,{children:[(0,vt.jsx)(k,{children:"Something unexpected happened while loading the editor. Try disabling any ad-blocking browser extensions and reload the page."}),(0,vt.jsx)("br",{}),(0,vt.jsx)("br",{})]}),children:(0,vt.jsx)(Al,{})})}var Tu={label:"Edit",submenu:[{label:d.undo,role:"undo"},{label:d.redo,role:"redo"},{type:"separator"},{label:d.goBack,role:"goBack",acceleratorLabel:C.goBack},{label:d.goForward,role:"goForward",acceleratorLabel:C.goForward},{type:"separator"},{label:d.cut,role:"cut",requiresUserInteraction:!0},{label:"Copy",submenu:[{label:d.copy,role:"copy",requiresUserInteraction:!0},{label:d.copyStyle,role:"copyStyle",accelerator:C.copyStyle,requiresUserInteraction:!0},{label:d.copyImage,role:"copyImage",accelerator:C.copyImage,requiresUserInteraction:!0},{label:d.copyImport,role:"copyImport",requiresUserInteraction:!0},{label:d.copyLink,role:"copyLink",requiresUserInteraction:!0},{label:d.copyCSS,role:"copyCSS",requiresUserInteraction:!0},{label:d.copySVG,role:"copySVG",requiresUserInteraction:!0},{label:d.copyText,role:"copyText",requiresUserInteraction:!0},{label:d.copyGrid,role:"copyGrid",requiresUserInteraction:!0},{label:d.copyEffects,role:"copyEffects",requiresUserInteraction:!0},{label:d.copyCursor,role:"copyCursor",requiresUserInteraction:!0},{type:"separator"},{label:d.copyCodeComponentIdentifier,role:"copyCodeComponentIdentifier",requiresUserInteraction:!0}]},{label:"Paste",submenu:[{label:d.paste,role:"paste",requiresUserInteraction:!0},{label:d.pasteStyle,role:"pasteStyle",accelerator:C.pasteStyle,requiresUserInteraction:!0},{label:d.pasteInPlace,role:"pasteInPlace",accelerator:C.pasteInPlace,requiresUserInteraction:!0},{label:d.pasteEffects,role:"pasteEffects",requiresUserInteraction:!0},{label:d.pasteCursor,role:"pasteCursor",requiresUserInteraction:!0},{label:d.pasteGrid,role:"pasteGrid",requiresUserInteraction:!0}]},{label:d.duplicate,role:"duplicate",accelerator:C.duplicate},{label:d.delete,role:"delete"},{type:"separator"},{label:d.rename,role:"rename",accelerator:C.rename},{label:d.toggleLayerLock,role:"toggleLayerLock",accelerator:C.toggleLayerLock},{label:d.toggleLayerVisible,role:"toggleLayerVisible",accelerator:C.toggleLayerVisible},{type:"separator"},{label:d.selectMostRecentPage,role:"selectMostRecentPage",accelerator:C.selectMostRecentPage},{label:d.selectGroundNode,role:"selectGroundNode",acceleratorLabel:C.selectGroundNode,acceleratorLabelWindows:rt.selectGroundNode},{label:d.selectParent,role:"selectParent",acceleratorLabel:C.selectParent},{label:d.selectAll,role:"selectAll"},{label:d.selectSiblings,role:"selectSiblings",accelerator:C.selectSiblings},{label:d.selectChildren,role:"selectChildren"},{label:d.selectAllTopParents,role:"selectAllTopParents"},{label:d.selectTextNodes,role:"selectTextNodes"}]},Mu={label:"Tool",submenu:[{label:"Insert",role:"toggleInsert",accelerator:C.toggleInsert},{label:"Library",role:"toggleLibraryModal",acceleratorLabel:C.toggleLibraryModal},{type:"separator"},{label:"Layout",submenu:[...It.isOn("singleStackLayoutMenuItem")?[{label:d[L.actionForCase(19)],role:L.actionForCase(19),accelerator:C[L.actionForCase(19)]}]:[{label:d[L.actionForCase(20)],role:L.actionForCase(20),accelerator:C[L.actionForCase(20)]},{label:d[L.actionForCase(21)],role:L.actionForCase(21),accelerator:C[L.actionForCase(21)]}],{label:d[L.actionForCase(22)],role:L.actionForCase(22),accelerator:C[L.actionForCase(22)]},{label:d[L.actionForCase(24)],role:L.actionForCase(24)},{label:d[L.actionForCase(23)],role:L.actionForCase(23)}]},{label:d[L.actionForCase(12)],role:L.actionForCase(12),accelerator:C[L.actionForCase(12)]},{label:d[L.actionForCase(10)],role:L.actionForCase(10),accelerator:C[L.actionForCase(10)]},{label:d[L.actionForCase(11)],role:L.actionForCase(11),accelerator:C[L.actionForCase(11)]},{label:d[L.actionForCase(44)],role:L.actionForCase(44),accelerator:C[L.actionForCase(44)]},{label:d[L.actionForCase(14)],role:L.actionForCase(14),accelerator:C[L.actionForCase(14)]},{label:d.startLinkTool,role:"startLinkTool",accelerator:C.startLinkTool},{label:d[L.actionForCase(19)],role:L.actionForCase(19),accelerator:C[L.actionForCase(19)]},{label:d[L.actionForCase(25)],role:L.actionForCase(25)},{label:d[L.actionForCase(26)],role:L.actionForCase(26)},{label:d[L.actionForCase(13)],role:L.actionForCase(13),accelerator:C[L.actionForCase(13)]},{label:d[L.actionForCase(32)],role:L.actionForCase(32),accelerator:C[L.actionForCase(32)]},{label:d[L.actionForCase(16)],role:L.actionForCase(16),accelerator:C[L.actionForCase(16)]},{label:d[L.actionForCase(15)],role:L.actionForCase(15),accelerator:C[L.actionForCase(15)]},{label:d[L.actionForCase(17)],role:L.actionForCase(17)},{label:d[L.actionForCase(18)],role:L.actionForCase(18)},{type:"separator"},{label:d[L.actionForCase(4)],role:L.actionForCase(4),accelerator:C[L.actionForCase(4)]},{label:d[L.actionForCase(40)],role:L.actionForCase(40),accelerator:C[L.actionForCase(40)]},{label:d[L.actionForCase(39)],role:L.actionForCase(39),accelerator:C[L.actionForCase(39)]},{label:d.sampleColor,role:"sampleColor",accelerator:C.sampleColor}]},Eu={label:"Layout",submenu:[{label:d.addEnclosingFrame,role:"addEnclosingFrame",accelerator:C.addEnclosingFrame},{label:d.addEnclosingStack,role:"addEnclosingStack",accelerator:C.addEnclosingStack},{label:d.removeFramePreservingChildren,role:"removeFramePreservingChildren",accelerator:C.removeFramePreservingChildren},{type:"separator"},{label:d.autoSize,role:"autoSize",accelerator:C.autoSize},{label:d.sizeToFitContent,role:"sizeToFitContent",accelerator:C.sizeToFitContent},{type:"separator"},{label:d.moveToFront,role:"moveToFront",accelerator:C.moveToFront},{label:d.moveForward,role:"moveForward",accelerator:C.moveForward},{label:d.moveBackward,role:"moveBackward",accelerator:C.moveBackward},{label:d.moveToBack,role:"moveToBack",accelerator:C.moveToBack},{type:"separator"},{label:"Align",submenu:[{label:d.alignLeft,role:"alignLeft",accelerator:C.alignLeft},{label:d.alignCenter,role:"alignCenter",accelerator:C.alignCenter},{label:d.alignRight,role:"alignRight",accelerator:C.alignRight},{type:"separator"},{label:d.alignTop,role:"alignTop",accelerator:C.alignTop},{label:d.alignMiddle,role:"alignMiddle",accelerator:C.alignMiddle},{label:d.alignBottom,role:"alignBottom",accelerator:C.alignBottom},{type:"separator"},{label:d.distributeHorizontal,role:"distributeHorizontal",accelerator:C.distributeHorizontal,acceleratorWindows:rt.distributeHorizontal},{label:d.distributeVertical,role:"distributeVertical",accelerator:C.distributeVertical,acceleratorWindows:rt.distributeVertical},{type:"separator"},{label:d.alignToSelection,role:"alignToSelection"},{label:d.alignToParent,role:"alignToParent"}]}]},Au={label:"Text",submenu:[{label:d.makeBold,role:"makeBold",accelerator:C.makeBold},{label:d.makeItalic,role:"makeItalic",accelerator:C.makeItalic},{label:d.makeUnderlined,role:"makeUnderlined",accelerator:C.makeUnderlined},{label:d.chooseFontFamily,role:"chooseFontFamily",accelerator:C.chooseFontFamily},{label:d.rewriteText,ellipsis:!0,role:"rewriteText"},{label:d.rewriteTextInPlace,role:"rewriteTextInPlace"}]},Ru={label:"Graphic",submenu:[{label:"Group",role:"group",accelerator:C.group},{label:"Ungroup",role:"ungroup",accelerator:C.ungroup},{type:"separator"},{label:d.flipHorizontal,role:"flipHorizontal"},{label:d.flipVertical,role:"flipVertical"},{type:"separator"},{label:"Flatten",role:"flattenPath"},{label:"Reverse Path Direction",role:"reversePath"}]},ju={label:"Component",submenu:[{label:d.makeComponent,ellipsis:!0,role:"makeComponent",accelerator:C.makeComponent},{label:d.makeCodeComponent,ellipsis:!0,role:"makeCodeComponent",accelerator:C.makeCodeComponent},{type:"separator"},{label:d.showComponentMaster,role:"showComponentMaster"},{label:d.detachComponentInstanceFromMaster,role:"detachComponentInstanceFromMaster"},{label:d.updateComponentMasterFromInstance,role:"updateComponentMasterFromInstance"},{type:"separator"},{label:d.resetComponentInstanceOverrides,role:"resetComponentInstanceOverrides"}]},xu={label:"Preview",submenu:[{role:"showPreview",accelerator:C.showPreview}]},Lu={label:"Code",submenu:[{label:d.createCodeComponent,role:"createCodeComponent"},{label:d.createOverride,role:"createOverride"},{label:d.createDataFileFromEndpoint,ellipsis:!0,role:"createDataFileFromEndpoint",visible:It.isOn("collectionsFromCode")},{type:"separator"},{label:d.saveCodeFile,role:"saveCodeFile",acceleratorLabel:C.saveCodeFile},{type:"separator"},{label:d.showAPIDocumentation,role:"showAPIDocumentation",requiresUserInteraction:!0}]},Fu={label:"Help",submenu:[{label:d.sitesGetStarted,role:"sitesGetStarted",requiresUserInteraction:!0},{label:d.startAppTour,role:"startAppTour",requiresUserInteraction:!0},{type:"separator"},{label:d.requestFeature,role:"requestFeature",requiresUserInteraction:!0},{label:d.openCommunity,role:"openCommunity",requiresUserInteraction:!0},{label:d.openChangelog,role:"openChangelog",requiresUserInteraction:!0},{type:"separator"},{label:d.keyboardShortcuts,role:"keyboardShortcuts"},{label:d.copyVersion,role:"copyVersion",requiresUserInteraction:!0}]},jl={label:d.goToProjects,role:"goToProjects"},Uu={label:d.quickActions,role:"quickActions",ellipsis:!0,accelerator:C.quickActions},xl=t=>({role:"publishSite",accelerator:t?C.publishSite:void 0}),Ro=zn({view:()=>({label:"View",submenu:[{label:d.zoomIn,role:"zoomIn",accelerator:C.zoomIn},{label:d.zoomOut,role:"zoomOut",accelerator:C.zoomOut},{label:d.resetZoom,role:"resetZoom",accelerator:C.resetZoom,acceleratorWindows:rt.resetZoom},{label:d.zoomToFitAll,role:"zoomToFitAll",accelerator:C.zoomToFitAll,acceleratorWindows:rt.zoomToFitAll},{label:d.zoomToFitSelection,role:"zoomToFitSelection",accelerator:C.zoomToFitSelection,acceleratorWindows:rt.zoomToFitSelection},{label:d.collapseLayers,role:"collapseLayers",accelerator:C.collapseLayers},{type:"separator"},{label:d.showPages,role:"showPages",accelerator:C.showPages},{label:d.showLayers,role:"showLayers",accelerator:C.showLayers},{label:d.showAssets,role:"showAssets",accelerator:C.showAssets},{type:"separator"},{label:d.toggleInterface,role:"toggleInterface",accelerator:C.toggleInterface,acceleratorWindows:rt.toggleInterface},{label:d.toggleShowAllLinks,role:"toggleShowAllLinks"},{label:"Show Handoff",role:"toggleShowHandoff"},{label:d.toggleRulers,role:"toggleRulers",accelerator:C.toggleRulers,acceleratorWindows:rt.toggleRulers},{label:d.toggleGrids,role:"toggleGrids",accelerator:C.toggleGrids,acceleratorWindows:rt.toggleGrids},{label:d.toggleToolbarLabels,role:"toggleToolbarLabels"},{label:d.toggleShowPixelGrid,role:"toggleShowPixelGrid"}]}),webViewMenu:()=>({label:"View",submenu:[{label:"Appearance",submenu:[{label:d.toggleAppearanceSystem,role:"toggleAppearanceSystem"},{role:"toggleAppearance",accelerator:C.toggleAppearance,acceleratorWindows:rt.toggleAppearance}]},{type:"separator"},{role:"toggleLocalization",label:d.toggleLocalization,accelerator:C.toggleLocalization},{type:"separator"},...Array.isArray(Ro.view.submenu)?Ro.view.submenu:[]]}),webFileMenu:()=>({label:"File",submenu:[{role:"newProject",ellipsis:!0,accelerator:C.newProject,requiresUserInteraction:!0},{label:"New Page",role:"newWebPage"},{label:"New Page Folder",role:"newWebPageFolder"},{label:"Generate Page",role:"generateWebPage",ellipsis:!0},{label:"Sort Alphabetically",role:"sortWebPagesAlphabetically"},{type:"separator"},{role:"duplicateProject",requiresUserInteraction:!0},{role:"archiveProject"},{type:"separator"},{role:"copyRemixLink",requiresUserInteraction:!0},{type:"separator"},{role:"inviteCollaborators",ellipsis:!0},{role:"toggleVersionHistory",label:d.toggleVersionHistory,accelerator:C.toggleVersionHistory},{type:"separator"},{label:d.importSketch,ellipsis:!0,role:"importSketch"},{label:d.importFigma,ellipsis:!0,role:"importFigma",accelerator:C.importFigma},{type:"separator"},{role:"uploadImage",accelerator:C.uploadImage,requiresUserInteraction:!0},{role:"uploadVideo",requiresUserInteraction:!0},{type:"separator"},xl(!0),{role:"openPublishedSite",accelerator:C.openPublishedSite}]}),preferencesMenu:()=>({label:"Preferences",submenu:[{label:d.useDirectSelect,role:"useDirectSelect"},{label:d.useSmartLayoutPins,role:"useSmartLayoutPins"},{label:d.reverseZoomDirection,role:"reverseZoomDirection"},{label:d.fastZoom,role:"fastZoom"},{label:d.animateOnZoom,role:"animateOnZoom"},{label:d.autoSwitchToLayers,role:"autoSwitchToLayers"},{label:d.showScrollToContentToast,role:"showScrollToContentToast"},{type:"separator"},{label:d.resetDefaultFrameBackground,role:"resetDefaultFrameBackground"},{label:d.resetVideoBanners,role:"resetVideoBanners"},{type:"separator"},{label:d.nudgePreferences,role:"nudgePreferences"},{type:"separator"},{label:d.togglePerformanceMode,role:"togglePerformanceMode"},{label:d.toggleCanvasPages,role:"toggleCanvasPages"},{type:"separator"},{label:d.togglePluginBeta,role:"togglePluginBeta"}]}),settingsMenu:()=>({label:"Site Settings",submenu:[{label:d.openSiteSettings,role:"openSiteSettings",accelerator:C.openSiteSettings},{type:"separator"},{label:d.openGeneralSettings,role:"openGeneralSettings"},{label:d.openDomainSettings,role:"openDomainSettings"},{label:d.openRedirects,role:"openRedirects"},{label:d.openForms,role:"openForms"},{label:d.openVersions,role:"openVersions"},{label:d.openAnalytics,role:"openAnalytics"},{label:d.openPlans,role:"openPlans"}]})}),Nu={role:"openAccountSettings",label:d.openAccountSettings},Du={role:"toggleBetaChannel",label:d.toggleBetaChannel,badge:"beta"},gi=zn({mobileWebAppMenu:()=>[jl,{type:"separator"},xl(!1)],webAppMenu:()=>[jl,{type:"separator"},Uu,{type:"separator"},Ro.webFileMenu,Tu,Ro.webViewMenu,Mu,Eu,Au,Ru,ju,xu,Lu,Ro.preferencesMenu,{type:"separator"},Ro.settingsMenu,Fu,Nu,{type:"separator"},Du]});var nt=g(N());function Ll({onDismiss:t,onConfirm:e,unsupportedFeatures:o}){return(0,nt.jsx)(Dt,{visible:!0,onDismiss:t,className:Ot.container,children:(0,nt.jsxs)(F,{gap:20,children:[(0,nt.jsx)(ye,{className:Ot.title,children:"Duplicate as Site"}),(0,nt.jsxs)(ye,{size:ra.size.base,className:Ot.secondaryText,children:["Some features of your project are not supported and will be not be duplicated:",(0,nt.jsx)("ul",{children:o.map((r,i)=>(0,nt.jsx)("li",{children:r},i))})]}),(0,nt.jsxs)(F,{direction:"row",children:[(0,nt.jsx)(J,{title:"Cancel",onClick:t,large:!0,className:Ot.grow}),(0,nt.jsx)(J,{onClick:e,variant:"primary",large:!0,className:Ot.grow,children:"Duplicate"})]})]})})}var G=g(_());var Mt=g(_());var Fl="modal_m1k7kvam",Ul="moveDraftTitle_m12ee7ht",Nl="moveDraftDescription_m1jpz33r",Dl="moveDraftButton_mwem6zi",Ol="confirmMoveDraftButton_c1qp1m89",Bl="buttonChevron_bl7xnjh";var Ue=g(N());function _l({project:t,user:e,onShowMoveProjectMenu:o,onConfirmMoveProject:r,moveProjectDestination:i,onDismiss:n}){let c=(0,Mt.useRef)(null),[m,l]=(0,Mt.useState)(!1);Mt.default.useEffect(()=>{q("ui_impression",{page:"deprecate-drafts-modal"})},[]);let p=(0,Mt.useMemo)(()=>{let v=Po(t,e),w=v.label==="Drafts"?"Choose\u2026":"Drafts";return{...v,label:w}},[t,e]);async function a(){if(c.current===null)return;let v=c.current.getBoundingClientRect();l(!0),await o({location:{x:v.left,y:v.bottom},showBackToDashboardItem:!1,skipConfirmation:!0,hideDrafts:!0}),l(!1)}let u=Mt.default.useCallback(async()=>{q("ui_interaction",{page:"deprecate-drafts-modal",id:"move-to-teams"}),await r(),n()},[r,n]);return(0,Ue.jsx)(Dt,{hasBackdrop:!0,visible:!0,onDismiss:ht,zIndex:14,className:Fl,children:(0,Ue.jsxs)(F,{gap:15,alignItems:"flex-start",justifyContent:"flex-start",children:[(0,Ue.jsxs)(F,{gap:10,children:[(0,Ue.jsx)("div",{className:Ul,children:"Select a Workspace"}),(0,Ue.jsx)("div",{className:Nl,children:(0,Ue.jsx)(k,{children:"You have multiple workspaces where you can create projects. Please choose a workspace to add this project to."})})]}),(0,Ue.jsxs)(J,{className:Dl,large:!0,onClick:a,ref:c,children:[(0,Ue.jsx)("div",{className:ne,children:i||p.label}),(0,Ue.jsx)("div",{className:Bl,children:(0,Ue.jsx)(xr,{isActive:m})})]}),(0,Ue.jsx)(J,{onClick:u,large:!0,className:Ol,variant:"primary",enabled:!!i&&i!==p.label,children:(0,Ue.jsx)(k,{children:"Confirm"})})]})})}var vi=g(_());var Vl="modal_m1sbcbyn",ql="title_t14j9fcj",yi="checkBoxLabel_cr11tra",hi="checkBoxLabelLink_chr9530",Hl="continueButton_chz9b7s";var Sn=g(_());var Ce=g(N()),Bu=mt("signup");function $l({firstName:t,lastName:e,email:o,onContinue:r}){let[i,n]=Sn.default.useState(!1),[c,m]=Sn.default.useState(!1),l=Sn.default.useCallback(p=>{gt.post("/auth/v2/signup/google-one-tap",{subscribe:c,origin:"framer-web",firstName:t,lastName:e,email:o}).then(r).catch(a=>Bu.reportError(a)),p.preventDefault()},[c,o,t,e,r]);return(0,Ce.jsx)("form",{onSubmit:l,children:(0,Ce.jsxs)(F,{gap:25,padding:10,children:[(0,Ce.jsx)("div",{className:ql,children:"Before you continue\u2026"}),(0,Ce.jsxs)(F,{gap:20,direction:"column",children:[(0,Ce.jsxs)(F,{direction:"row",alignItems:"center",children:[(0,Ce.jsx)(Jo,{large:!0,id:"tos-accept",value:i,onChange:n}),(0,Ce.jsx)("label",{htmlFor:"tos-accept",children:(0,Ce.jsx)(_u,{})})]}),(0,Ce.jsxs)(F,{direction:"row",alignItems:"center",children:[(0,Ce.jsx)(Jo,{large:!0,id:"tos-email-optin",title:"Send me updates via email. Unsubscribe any time",value:c,onChange:m}),(0,Ce.jsx)("label",{htmlFor:"tos-email-optin",children:(0,Ce.jsx)(ye,{className:yi,children:"Send me updates via email. Unsubscribe any time"})})]})]}),(0,Ce.jsx)(J,{type:"submit",large:!0,variant:"primary",title:"Continue","aria-label":"continue",enabled:i,className:Hl})]})})}function _u(){return(0,Ce.jsxs)(ye,{className:yi,children:["I agree to the"," ",(0,Ce.jsx)("a",{href:"https://www.framer.com/support/accounts/terms-of-service/",target:"_blank",className:hi,children:"Terms of Service"})," ","and"," ",(0,Ce.jsx)("a",{href:"https://www.framer.com/support/accounts/privacy-statement/",target:"_blank",className:hi,children:"Privacy Statement"})]})}function Vu(t,e){var o;(o=window.dataLayer)==null||o.push({event:"eventTracking",trackingEventCategory:e,trackingEventAction:t,trackingEventLabel:"",trackingEventValue:""})}var Gl=()=>Vu("Web","CompleteRegistration");var Cn=g(N());function zl({accountApi:t}){var n;let{account:e,fetchProfile:o,fetchMe:r}=t;vi.default.useEffect(()=>{Gl(),o()},[o]);let i=vi.default.useCallback(async()=>{await r(),s.modalStore.set({type:"Welcome",source:"automatic"})},[r]);return(0,Cn.jsx)(Dt,{hasBackdrop:!0,visible:!0,onDismiss:ht,className:Vl,children:(n=e==null?void 0:e.profile)!=null&&n.email?(0,Cn.jsx)($l,{firstName:e.profile.firstName,lastName:e.profile.lastName,email:e.profile.email,onContinue:i}):(0,Cn.jsx)(ot,{})})}var bi=g(_());function Kl(t){let[e,o]=ft.extract(t);(0,bi.useEffect)(()=>{if(!e)return Yc();document.querySelectorAll("link[rel='icon']").forEach(r=>{r.setAttribute("href",e)})},[e]),(0,bi.useEffect)(()=>{document.title=`${o} \u2013 Framer`},[o])}var Yl=g(_());var Zl=new Yr;function Jl(t,e){return(0,Yl.useEffect)(()=>{let o=Zl,r=[];return t((i,n,c)=>{o.set(i,n,c),r.push(i)}),()=>{r.forEach(i=>o.remove(i))}},e),Zl}var Xl=g(_());function Ql(){return(0,Xl.useCallback)(async(t,e,o,r)=>{switch(r||(r=s.canvasStore.getViewportCenter()),t){case"image":await Ga(s,[o],r,e);break;case"video":await nc(s,[o],r,e);break;default:pe(t)}},[])}var ir=g(_());function ep({channel:t,project:e,canMoveProject:o,onShowMoveProjectMenu:r,onShowUpgradeOrTrialModal:i}){let n=new pt,c=(0,ir.useRef)(n);(0,ir.useEffect)(()=>{if(!t)return;let m=kr.on(t).expect();return kr.on(t).register({currentProjectStream:c.current.newStream,showMoveProjectMenu:async({location:l})=>{await r({location:l,showBackToDashboardItem:!1})},showUpgradeOrTrialModal:async({show:l,trackingPage:p})=>{let a;switch(l){case"fonts":a="fonts";break;default:pe(l)}i(a,p)}}),()=>{kr.unregister(m)}},[t,o,r,i]),(0,ir.useEffect)(()=>{var m,l,p,a;c.current.emit({title:(m=e.title)!=null?m:void 0,space:{...e.space,displayName:(l=e.space.displayName)!=null?l:void 0,icon:(p=e.space.icon)!=null?p:void 0},shareLinks:(a=e.shareLinks)!=null?a:void 0,canMoveProject:o})},[e,o])}var tp="moveProjectMenu_mqspbls";var op=new pt,rp=!1;function np({channel:t,user:e,permissions:o}){if(op.emit(o),rp)return;let r={getSessionIdentity:async()=>({user:e}),permissionsStream:op.newStream};gs.on(t).register(r),rp=!0}var Pn=g(_());function ip(t,e){let{url:o,title:r}=e,i={__framerProjectTitle:r,__framerProjectURL:o,...t.toJS()};return JSON.stringify(i,null,4)}function sp(t){return t?t.trim().replace(/\W+(\b\w|$)/g,(e,o)=>o.toUpperCase()):"document"}var Xt=async t=>{var o;let e=(o=s.remoteDocument)==null?void 0:o.projectId;e&&(await gt.post(`/web/projects/${e}`,{releaseChannel:t}),window.location.reload())};function ap(t){var a;let e=((a=t.get(ea))==null?void 0:a.getRedirects())||[],{linksWithLocale:o,linkWithLocaleByRedirect:r}=Fc(e,t.root.locales),i=o.map(({link:u})=>u),n=lc(t,i),c=cc(n),m=pc(t,o,c),l=u=>{let v=r.get(u);if(v)return m.get(v)},p="";for(let u of e){let v=u.path,w=Uc(u,l);v&&w&&(p+=`${JSON.stringify(v)},${JSON.stringify(w)}
`)}en(p,"redirects.csv",{type:"text/csv",endings:"native"})}var qu="Settings";function cp(){let t=uc(Bt,Er,"employeesOnlySettings");return[{label:qu,submenu:t.options},t.actionHandlers]}var Si="employees-only-menu",Hu="Employees Only",Ci=async t=>{var o;let e=(o=s.remoteDocument)==null?void 0:o.projectId;e&&(await gt.post(`/web/projects/${e}`,{canvasFeatures:{[t]:!Ie.isOn(t)}}),window.location.reload())};function lp(t,e){let o={[t]:e?"on":"off"};Bt.update(o),dc(o,"employeesOnlySettings",Er)}function Wu(){return mc({label:"Show Status Bar",role:"toggleStatusBar",accelerator:"CommandOrControl+Option+Shift+B",action(){let t=!s.chromeStore.statusBarIsVisible;lp("showStatusBar",t),s.chromeStore.statusBarIsVisible=t},checked:()=>s.chromeStore.statusBarIsVisible},{label:"Show Debug Bar",role:"toggleDebugBar",accelerator:"CommandOrControl+Shift+D",action(){lp("showDebugBar",!Bt.isOn("showDebugBar"))},checked:()=>Bt.isOn("showDebugBar")},{label:"Show NUX Steps",role:"showNuxSidebar",action:async()=>{await xc(),window.location.reload()}},{type:"separator"},{label:"Kit Project",role:"toggleKitProjectFeature",action:()=>Ci("kit").catch(O),checked:()=>Ie.isOn("kit")},{label:"Skip Duplication Page",role:"toggleSkipInterstitial",action:()=>Ci("skipInterstitial").catch(O),checked:()=>Ie.isOn("skipInterstitial")},{label:"CMS Database",role:"toggleCmsDatabase",action:()=>Ci("cmsDatabase").catch(O),checked:()=>Ie.isOn("cmsDatabase")},{label:"Project Release Channel",submenu:[{label:"Default",role:"defaultReleaseChannel",action:()=>Xt(null).catch(O),checked:()=>{var t;return((t=s.projectStore.project)==null?void 0:t.releaseChannel)===null}},{type:"separator"},{label:"Stable",role:"stableReleaseChannel",action:()=>Xt("stable").catch(O),checked:()=>{var t;return((t=s.projectStore.project)==null?void 0:t.releaseChannel)==="stable"}},{label:"Beta",role:"betaReleaseChannel",action:()=>Xt("beta").catch(O),checked:()=>{var t;return((t=s.projectStore.project)==null?void 0:t.releaseChannel)==="beta"}},{label:"Alpha",role:"alphaReleaseChannel",action:()=>Xt("alpha").catch(O),checked:()=>{var t;return((t=s.projectStore.project)==null?void 0:t.releaseChannel)==="alpha"}}]},{type:"separator"},{label:"Duplicate Version\u2026",role:"duplicateProjectWithVersion",action(){s.modalStore.set({type:"DuplicateProjectWithVersion",source:"main_menu"})}},{label:"Download Document Fixture\u2026",role:"downloadDocumentFixture",requiresUserInteraction:!0,action(){let t=s.projectStore.project;if(!t)return;let e=ip(s.tree,t),o=`${sp(t.title)}.json`;en(e,o)}},{type:"separator"},{label:"Export Redirects",role:"exportRedirects",action(){ap(s.tree)}},{label:"Import Redirects\u2026",role:"importRedirects",action(){s.modalStore.set({type:"ImportRedirects",source:"main_menu"})}},{type:"separator"},{label:"Instant NPM",submenu:[{label:"Reinstall Import Map",role:"reinstallImportMap",async action(){q("ui_interaction",{page:Si,id:"employees-reinstall-import-map"});let t="reinstall-import-map";E({type:"add",key:t,text:"Reinstalling import map dependencies",variant:"progress",duration:1/0,showCloseButton:"never"});try{await s.modulesStore.uninstallBlockedNpmDependencies();let{importMap:e}=await s.modulesStore.reinstallNpmDependencies();E({type:"add",key:t,text:`Reinstalled ${ei(Object.keys(e.imports).length,"dependency","dependencies")}. Reloading Project.`,duration:5e3,variant:"success"}),window.location.reload()}catch(e){E({type:"add",key:t,text:`Reinstall failed: ${e}`,variant:"error",duration:5e3})}}},{label:"Rebuild Import Map from Dependencies",role:"rebuildImportMap",async action(){q("ui_interaction",{page:Si,id:"employees-rebuild-import-map"});let t="rebuild-import-map";E({type:"add",key:t,text:"Rebuilding Import Map from Dependencies.json",variant:"progress",duration:1/0});try{await s.modulesStore.removeBlockedNpmDependencies();let{importMap:e}=await s.modulesStore.rebuildImportMapFromDependencies();E({type:"add",key:t,text:`Built an import map with ${ei(Object.keys(e.imports).length,"dependency","dependencies")}. Reloading Project.`,duration:5e3,variant:"success"}),window.location.reload()}catch(e){console.error("Rebuild of import map failed",e),E({type:"add",key:t,text:`Rebuild of import map failed: ${e}`,variant:"error",duration:1/0})}}},{type:"separator"},{label:"Clear NPM Dependencies",role:"clearNpmDependencies",async action(){async function t(){q("ui_interaction",{page:Si,id:"employees-clear-dependencies"});try{await s.modulesStore.clearNpmDependencies(),E({type:"add",text:"NPM Dependencies are cleared. Reloading Project.",variant:"success",duration:5e3}),window.location.reload()}catch(e){E({type:"add",text:`Clearing Dependencies failed: ${e}`,variant:"error",duration:5e3})}}s.modalStore.set({type:"Confirmation",title:"Clear NPM Dependencies",variant:"destructive",description:"This will break any local or external components in your project that use Instant NPM. Are you sure?",onConfirm:t,confirmLabel:"Confirm",source:"main_menu"})}}]},{label:"Repair Corrupt Modules",role:"repairCorruptModules",async action(){let t=Object.values(s.modulesStore.localModules),e="repair-corrupt-modules",o={method:"HEAD",mode:"cors"},r=[];for(let[l,p]of t.entries()){E({type:"add",key:e,text:`Analyzing module ${l+1} out of ${t.length} for corruption\u2026`,duration:1/0,variant:"progress"});let a=s.modulesStore.getPersistedModuleByLocalId(p.localId);if(!a)continue;let u=[];try{for(let[v,w]of Object.entries(a.files))(await fetch(a.baseURL+w,o)).ok||u.push({type:v,name:w})}catch{continue}u.length&&r.push({localId:p.localId,type:p.type,files:u})}if(!r.length){E({type:"add",key:e,text:"No corrupt modules found.",duration:5e3,variant:"success"});return}E({type:"remove",key:e}),console.log(r);let n=["The following module(s) are corrupt. Repair?","WARNING: This will replace the corrupt files with empty content.",r.map(({localId:l,files:p})=>`${l} (${p.map(a=>a.name).join(", ")})`).join(`
`)];if(!window.confirm(n.join(`

`)))return;let c=r.length,m=0;for(let l=0;l<c;l++){let p=r[l];if(p){E({type:"add",key:e,text:`Repairing corrupt module ${l+1} out of ${c}\u2026`,duration:1/0,variant:"progress"});try{let a=s.modulesStore.forType(p.type).getByLocalId(p.localId),u=p.files.map(v=>({...v,content:""}));await a.persist({files:u})}catch(a){E({type:"add",text:`Repairing ${p.localId} failed: ${a}`,variant:"error",duration:5e3}),m++}}}E({type:"add",key:e,text:m>0?`Repaired ${c-m} out of ${c} module(s).`:`Repaired ${c} module(s).`,duration:5e3,variant:m>0?"error":"success"})}},{label:"Replace module in CMS",role:"replaceModuleInCMS",async action(){let t="repair-corrupt-modules",e=prompt("existing module identifier to replace"),o=prompt("new module identifier to replace");e&&o&&$o(e)&&$o(o)?s.processWhenReady(()=>{Gs(s.tree,e,o),E({type:"add",key:t,text:`replaced all references of from:'${e}' with to:'${o}' in CMS collection items`,duration:5e3,variant:"success"})}):E({type:"add",key:t,text:`from:'${e}' OR to:'${o}' are not values is not a valid ModuleExportIdentifer`,duration:5e3,variant:"error"})}},{label:"Vacuum Modules w/ Deleted Nodes",role:"vacuumModules",async action(){let t=Object.values(s.modulesStore.localModules),e=t.filter(c=>{let m=c.type;switch(m){case"canvasComponent":case"collection":case"css":case"prototype":case"screen":case"webPageMetadata":break;case"codeFile":case"componentPresets":case"config":case"siteMetadata":return!1;default:pe(m,`Unhandled module type ${c.type}`)}let l=s.tree.get(c.name);if(!l)return!0;try{if((m==="webPageMetadata"?Ba(l.id).type:Wa(l,s.tree))!==m)return!0}catch{return!0}return!1}),o=s.modulesStore.localModules["config/site"];o&&e.push(o);let r="vacuum-modules";if(!e.length){E({type:"add",key:r,text:"No modules to delete.",duration:5e3,variant:"success"});return}console.log(e);let i=`${e.length} out of ${t.length}`,n=e.map(c=>c.localId).join(", ");if(window.confirm(`Found ${i} unused module(s). Delete?

${n}`)){E({type:"add",key:r,text:`Deleting ${e.length} modules\u2026`,duration:1/0,variant:"progress"});try{await s.modulesStore.deleteModules(e.map(c=>c.localId)),E({type:"add",key:r,text:`Deleted ${e.length} module(s).`,duration:5e3,variant:"success"})}catch{E({type:"add",key:r,text:"Failed to delete one or more modules. See console for more details.",duration:5e3,variant:"error"})}}},visible:()=>Ie.isOn("codeModules")})}function pp(t,e,o){let r=o.findIndex(n=>n.label===t)+1,i=[...o];return i.splice(r,0,e),i}function mp(){let[t,e]=fc(),[o,r]=cp(),[i,n]=Wu();return[{label:Hu,submenu:[t,o,...i]},{...e,...r,...n}]}var Pi={delete:"Delete",redo:"CommandOrControl+Shift+Z",selectAll:"CommandOrControl+A",undo:"CommandOrControl+Z"},dp={copy:"CommandOrControl+C",cut:"CommandOrControl+X",paste:"CommandOrControl+V"};Wr()||(Pi.sampleColor="");var $u=new Set(["toolCreateScreen","toolCreateFrame","toolCreateText","toolCreateStack","toolNavigationLink","toolCreateScrollComponent","toolCreatePageComponent","toolCreateShapeContainer","toolPath","toolCreateRectangleShape","toolCreateOvalShape","toolCreatePolygonShape","toolCreateStarShape","toolComment","toolZoom","sampleColor","quickActions"]),Gu={duplicateTemplate:"canUseCustomTemplates"},zu=new Set(["Delete"]),sr=class{constructor(e,o){this.onCancelledDispatch=o;this.actionHandlers={};this.acceleratorToAction={};this.bindings=new Yr;this.menu=Ua(e,r=>{if(r.type!=="normal"||!r.action)return;let i=Pi[r.action];i!==void 0&&(r.accelerator=i,r.acceleratorLabelTokens=Qn(i)),r.accelerator&&(this.acceleratorToAction[r.accelerator]=r.action);let n=dp[r.action];n!==void 0&&(r.acceleratorLabelTokens=Qn(n))});for(let r in this.acceleratorToAction){if(zu.has(r))continue;let i=this.acceleratorToAction[r];i&&this.bindings.set(r,n=>this.dispatch(i,n),i)}}updateActionHandlers(e){Object.assign(this.actionHandlers,e)}async dispatch(e,o={altKey:!1,ctrlKey:!1,metaKey:!1,shiftKey:!1}){switch(e){case"toolCreateScreen":return!1}let r=await this.getActionHandler(e),i=r.enabled&&!r.enabled(),n=r.visible&&!r.visible();return i||n?(this.onCancelledDispatch(e,{disabled:i,hidden:n}),!1):(await r.action(o),!0)}async getActionHandler(e){let o=this.actionHandlers[e];if(o)return o;let r=this.defaultActionHandler&&await this.defaultActionHandler(e);if(!r)throw Error("Could not get action handler");return r}async handleKeyboardEvent(e){if(Kr())return!0;let o=this.bindings.get(e);if(!o)return!1;let{action:r,actionName:i}=o;if(e.repeat&&$u.has(i))return e.preventDefault(),e.stopPropagation(),!0;let n=await r(e);return n&&(e.preventDefault(),e.stopPropagation()),n}async validateMenu(e){var o;for(let r of e)if(r.type==="normal"){if(r.action){let i=await this.getActionHandler(r.action);if(i.checked){let c=i.checked();c!==void 0&&(r.checked=c)}if(i.enabled&&(r.disabled=!i.enabled()),i.label){let c=i.label();c!==void 0&&(r.label=`${c}${(o=i.ellipsis)!=null&&o.call(i)?"\u2026":""}`)}if(i.visible){let c=i.visible();c!==void 0&&(r.visible=c)}let n=Gu[r.action];!r.disabled&&n&&Gr.is(n,"upsell")&&(r.badge="pro")}!r.disabled&&r.submenu&&await this.validateMenu(r.submenu)}}};function up(t){let e=new URL(window.location.href);e.searchParams.delete("node"),Nt(e.href),t({type:"add",variant:"success",icon:"success",text:"Copied Project Link"})}function fp(t){let e=`FramerWeb/63c002f ${navigator.userAgent}`;Nt(e),t==null||t({type:"add",variant:"success",icon:"success",text:"Copied Framer version: 63c002f"})}function wi(t,e){let o=[];for(let r of t){let[i,n]=e(r);i!==void 0&&o.push(i),n&&n.length>0&&o.push(...wi(n,e))}return o}var xo={},ar;function yp(t,e){if(ar)return ar;let o=Ku(t,e);return ar=o,setTimeout(()=>{o===ar&&(ar=null)}),o}var gp=!1;async function Ku(t,e){if(!gp){gp=!0;let r=wi(t,i=>i.role?[e.validate({action:i.role}).then(()=>{}),i.submenu]:[void 0,i.submenu]);await Promise.all(r)}let{states:o}=await e.validate({action:"*"});for(let r of o)xo[r.action]=r}function hp({appMenu:t,archiveProject:e,handleNewProject:o,handleProjectDuplication:r,handleDuplicationAsSite:i,onPreviewToggle:n,filePickerRef:c,openAccountSettings:m,onUploadMediaFilePick:l,menuActionTargetService:p,saveTemplateAsProject:a,project:u,toast:v,unarchiveProject:w,user:S,userCanArchive:U}){let{isDarkMode:f,isOverridingSystem:y,setDarkMode:b,setOverrideSystem:P}=Se(),A=!Yt("canDesign"),M=!Yt("canInviteCollaborators"),R=(0,Pn.useMemo)(()=>{let h=Yu(t,S.isFramerEmployee?mp():void 0,v);return h.defaultActionHandler=async T=>(p&&await yp(t,p),{action:async()=>{p&&(window.focus(),await p.dispatch({action:T}))},checked:()=>{var D;let j=xo[T];return(D=j==null?void 0:j.checked)!=null?D:!1},enabled:()=>{let j=xo[T];return!!(j!=null&&j.enabled)},label:()=>{let j=xo[T];return j==null?void 0:j.label},visible:()=>{let j=xo[T];return j&&j.visible!==!1}}),h},[t,S.isFramerEmployee,v,p]);return(0,Pn.useEffect)(()=>{let h=T=>{!di.hotKeysDisabled()&&R.handleKeyboardEvent(T),Zu(T)};return window.addEventListener("keydown",h,!0),()=>{window.removeEventListener("keydown",h,!0)}},[R]),R.updateActionHandlers({copyVersion:{action:()=>{fp(v)}},saveTemplateAsProject:{action:()=>a(),label:()=>d.saveTemplateAsProject,enabled:()=>A,visible:()=>Zt(u)&&!u.archived&&!Oe(u.space)},archiveProject:{action:()=>e(),label:()=>d.archiveProject,enabled:()=>U,visible:()=>!u.archived},unarchiveProject:{action:()=>w(),label:()=>d.unarchiveProject,enabled:()=>U,visible:()=>u.archived},newProject:{action:()=>o(),label:()=>d.newProject},copyProjectLink:{action:()=>{up(v)},label:()=>d.copyProjectLink},duplicateProject:{action:()=>r(),label:()=>d.duplicateProject,visible:()=>!Zt(u),enabled:()=>er(S,u)},duplicateAsSite:{action:()=>{q("ui_interaction",{id:"duplicate-as-site",page:"main-menu"}),i()},label:()=>d.duplicateAsSite,visible:()=>!Zt(u)&&!u.canvasFeatures.sites,enabled:()=>er(S,u)},showPreview:{action:()=>{wo.close().catch(O),n()},label:()=>d.showPreview,enabled:()=>!s.siteSettings.isOpen},goToProjects:{action:({ctrlKey:h,metaKey:T})=>{var $;let j=S.spaces.find(Z=>u.space.id===Z.id&&Z.permissions.read),D=Zt(u)?"templates":(($=u.collection)==null?void 0:$.id)||"recent",W=u.space.scope==="organization"&&j?`${Co}folder/${D}?team=${u.space.id}`:Co;h||T?Ke(W):window.location.href=W}},toggleAppearanceSystem:{checked:()=>!y,action:()=>{P(!1)},enabled:()=>!s.siteSettings.isOpen&&y},toggleAppearance:{action:()=>{b(!f)},label:()=>f?"Day Mode":"Night Mode",enabled:()=>!s.siteSettings.isOpen},publishSite:{action:async()=>{if(await Sc(s),await bc(s),!s.publishStore.customHostname){let h=s.publishStore.getHomeNode();if(h&&ta(h)){s.popover.active=1;return}}await s.publishStore.publish(s)},label:()=>s.publishStore.publishStatus!==1?"Publish Update":d.publishSite,enabled:()=>s.publishStore.canPublish(s)},openPublishedSite:{action:async()=>{var T;let h=(T=s.publishStore.customHostname)!=null?T:s.publishStore.defaultHostname;h&&Ke(zr(s,h.hostname))},label:()=>d.openPublishedSite,enabled:()=>A&&!!s.publishStore.defaultHostname&&s.publishStore.defaultHostname.isPublished},inviteCollaborators:{action:()=>{s.popover.active=2,q("ui_interaction",{page:"main-menu",id:"share-project"})},label:()=>d.inviteCollaborators,ellipsis:()=>!0,enabled:()=>s.chromeStore.mainView!==2&&M},uploadImage:{action:()=>{var h;(h=c.current)==null||h.show(zs).then(T=>{if(T.isFile())return l("image","menu",T.value)}).catch(O)},label:()=>d.uploadImage,ellipsis:()=>!0,enabled:()=>A&&!s.siteSettings.isOpen},uploadVideo:{action:()=>{var h;(h=c.current)==null||h.show(Ks).then(T=>{if(T.isFile())return l("video","menu",T.value)}).catch(O)},label:()=>d.uploadVideo,ellipsis:()=>!0,enabled:()=>A&&!s.siteSettings.isOpen},openAccountSettings:{action:()=>{m()}},openSiteSettings:{enabled:()=>!s.siteSettings.isOpen,action:()=>s.siteSettings.open()},openGeneralSettings:{enabled:()=>{var h;return s.chromeStore.mainView!==4||((h=s.siteSettings.active)==null?void 0:h.tab)!=="project"},action:()=>s.siteSettings.setActiveTab({tab:"project"})},openDomainSettings:{enabled:()=>{var h;return s.chromeStore.mainView!==4||((h=s.siteSettings.active)==null?void 0:h.tab)!=="domains"},action:()=>s.siteSettings.setActiveTab({tab:"domains"})},openRedirects:{enabled:()=>{var h;return s.chromeStore.mainView!==4||((h=s.siteSettings.active)==null?void 0:h.tab)!=="redirects"},action:()=>s.siteSettings.setActiveTab({tab:"redirects"})},openForms:{visible:()=>It.isOn("forms"),enabled:()=>{var h;return s.chromeStore.mainView!==4||((h=s.siteSettings.active)==null?void 0:h.tab)!=="forms"},action:()=>s.siteSettings.setActiveTab({tab:"forms"})},openVersions:{enabled:()=>{var h;return s.chromeStore.mainView!==4||((h=s.siteSettings.active)==null?void 0:h.tab)!=="versions"},action:()=>s.siteSettings.setActiveTab({tab:"versions"})},openAnalytics:{enabled:()=>{var h;return s.chromeStore.mainView!==4||((h=s.siteSettings.active)==null?void 0:h.tab)!=="analytics"},action:()=>{q("ui_interaction",{id:"open-site-settings-analytics",page:"main-menu"}),s.siteSettings.setActiveTab({tab:"analytics"}).catch(O)}},openPlans:{enabled:()=>{var h;return s.chromeStore.mainView!==4||((h=s.siteSettings.active)==null?void 0:h.tab)!=="plans"},action:()=>s.siteSettings.setActiveTab({tab:"plans"})},copyRemixLink:{label:()=>d.copyRemixLink,action:()=>Qc(s.projectStore.projectId,u.publicAccess!=="none"||!!S.isFramerEmployee)},toggleBetaChannel:{visible:()=>{var h;return((h=s.projectStore.featureFlags)==null?void 0:h.canUseBetaChannel)==="on"},checked:()=>{var h;return((h=s.projectStore.project)==null?void 0:h.releaseChannel)==="beta"},action:()=>{var T;let h=((T=s.projectStore.project)==null?void 0:T.releaseChannel)==="beta"?null:"beta";Xt(h).catch(O)}}}),di.updateActionManager(R),R}function Zu(t){!Wr()&&t.key==="Alt"&&t.preventDefault()}function Yu(t,e,o){let r=i=>{Ra(s,"canDesign")||s.chromeStore.mainView===0&&(s.chromeStore.isPreviewingLocaleOnCanvas||Ma(i)&&Ea(i,o))};if(e){let[i,n]=e,c=pp("Preferences",i,t),m=new sr(c,r);return m.updateActionHandlers(n),m}else return new sr(t,r)}var Fo=g(_());function vp({vekterChannel:t,initialThread:e}){let o=(0,Fo.useRef)(null),[r,i]=(0,Fo.useState)(!!e);return(0,Fo.useEffect)(()=>{let n;if(t)return Gn.on(t).discover({timeout:3e4}).then(async c=>{o.current=c,n=c.feedbackStateStream({replay:"latest"}),await Promise.all([e?c.openThread(e):Promise.resolve(),n.read(async({isActive:m})=>{i(m)})])}).catch(Xu),()=>{n==null||n.cancel(),o.current&&Gn.unregister(o.current)}},[t,e]),{isFeedbackActive:r}}var Ju="t";function bp(t=window.location){let o=new URLSearchParams(t.search).get(Ju);if(o){let[r,i]=o.split(":");return{threadId:r,commentId:i}}return null}function Xu(t){if(t instanceof ls.TimedOut){console.warn("FeedbackDocument service discovery timed out: Feedback functionality may be limited");return}setTimeout(()=>{throw t})}var Sp=g(_());function Cp({toast:t,userNotifications:e,isFeedbackActive:o}){let[r,i]=Zr("has-seen-notifications-toast",!1);(0,Sp.useEffect)(()=>{if(!o||r)return;async function n(){(await e.getPermissionStatus()).status==="notDetermined"&&(t({type:"add",variant:"info",key:"notifications-opt-in-toast",text:"Stay up to date with browser notifications",action:{title:"Continue",onClick:()=>e.requestPermission()},icon:"notifications",duration:1e4,showCloseButton:"never"}),i(!0))}n()},[t,e,o,r,i])}var Pp=g(_());function Qu(t,e){let o={variant:"success",text:"You are now subscribed to updates",action:{title:"Unsubscribe",onClick:i},icon:"success",key:"feedback-updates-subbed-toast",duration:5e3,showCloseButton:"never"},r={variant:"success",text:"You have unsubscribed from updates",icon:"success",action:{title:"Subscribe",onClick:n},key:"feedback-updates-unsubbed-toast",duration:5e3,showCloseButton:"never"};async function i(){t({type:"remove",key:o.key}),await e("unsubscribe"),t({type:"add",...r})}async function n(){t({type:"remove",key:r.key}),await e("subscribe"),t({type:"add",...o})}return{subbedToast:o,unsubbedToast:r}}function wp({toast:t,isDocumentLoaded:e,action:o}){(0,Pp.useEffect)(()=>{let r=new URLSearchParams(window.location.search);if(e&&r.get("unsubscribed")==="true"){let{unsubbedToast:i}=Qu(t,o);t({type:"add",...i});let n=new URL(window.location.href);n.searchParams.delete("unsubscribed"),window.history.replaceState({},document.title,n.href)}},[t,e,o])}var Ip=g(_());function kp({channel:t}){return(0,Ip.useMemo)(()=>t?hs.on(t).expect():null,[t])}var In=g(_());function Tp(t){switch(t){case"granted":return{status:"granted"};case"denied":return{status:"denied"};case"default":default:return{status:"notDetermined"}}}var wn=class{constructor(){this.activeNotifications=new Map}async requestPermission(){return window.Notification?new Promise(e=>{let o=i=>e(Tp(i)),r=window.Notification.requestPermission(o);r&&r.then(o).catch(O)}):{status:"denied"}}async getPermissionStatus(){return window.Notification?Tp(window.Notification.permission):{status:"denied"}}async post(e){return new Promise(o=>{if(!window.Notification)return o({type:"cancel",reason:"unsupported"});if(e.notification.show==="backgrounded"&&!document.hidden)return o({type:"cancel",reason:"suppressed"});let r=new window.Notification(e.notification.title,{tag:e.notification.id,body:e.notification.body});this.activeNotifications.set(e.notification.id,r),r.onclick=()=>{window.focus(),o({type:"action"}),r.close()},r.onclose=()=>{this.activeNotifications.delete(e.notification.id),o({type:"cancel",reason:"dismissed"})}})}async cancel(e){if(!window.Notification)return;let o=this.activeNotifications.get(e.notificationId);o&&o.close()}};function Mp({channel:t}){let e=(0,In.useMemo)(()=>new wn,[]);return(0,In.useEffect)(()=>{if(t)return fs.on(t).register(e)},[t,e]),e}var Vo=g(_());var Qt=g(_()),Up=g(du());var Ep="container_c4mo4dy",Ap="title_thtz5ih",Rp="description_dx2e80q",jp="inputLabel_i1xbazds",xp="icon_i1254ef3",Uo="fullWidth_f1czdr5w";var re=g(N()),Lp=mt("ai-domain-popover");function tf(){var o,r;let t=s.siteSettings.metadata.title,e=(o=s.projectStore.project)==null?void 0:o.title;return rf((r=t!=null?t:e)!=null?r:"My AI Site")}var Np=({canPublish:t,publishStatus:e,onPublish:o,onDismiss:r})=>{let i=ko(tf),[n,c]=Qt.default.useState(i),[m,l]=Qt.default.useState(),[p,a]=Qt.default.useState(!0),u=ws();Qt.default.useEffect(()=>{q("ui_impression",{page:"ai-domain-popover"})},[]),Ic(n,500,y=>{let b=n.trim();if(si(b)){l("Invalid Domain"),a(!1);return}s.publishStore.isCustomDomainAvailable(Fp(b)).then(A=>{if(!y.outdated){if(!A&&b===i){let M=Math.floor(Math.random()*1e3).toString(10).padStart(3,"0");c(`${b}-${M}`);return}l(A?null:"Domain Taken")}}).catch(A=>{Lp.error("Failed to check domain availability",A)}).finally(()=>{y.outdated||a(!1)})});let v=y=>{y!==n&&(a(!0),c(y))},w=Qt.default.useCallback(()=>{q("ui_interaction",{page:"ai-domain-popover",id:"dismiss"}),r()},[r]),S=Qt.default.useCallback(async()=>{q("ui_interaction",{page:"ai-domain-popover",id:"publish"});let y=n.trim();if(si(y)){l("Invalid Domain");return}try{await o(Fp(y))}catch(P){Lp.error("Failed to publish",P),l(P instanceof kt&&P.status===409?"Domain Taken":null)}},[n,o]),U=y=>{if(y.key==="Enter"){if(p||m){u.start("error").catch(O);return}S().catch(O)}},f=e===3;return(0,re.jsxs)(F,{direction:"column",justifyContent:"flex-start",alignItems:"center",padding:"30px 15px 15px 15px",gap:15,className:Ep,children:[(0,re.jsx)("span",{className:xp,children:(0,re.jsx)(nf,{})}),(0,re.jsxs)(F,{gap:10,direction:"column",justifyContent:"flex-start",alignItems:"stretch",paddingLeft:35,paddingRight:35,paddingBottom:15,className:Uo,children:[(0,re.jsx)("p",{className:Ap,children:(0,re.jsx)(k,{children:"Here\u2019s your free AI domain."})}),(0,re.jsx)("p",{className:Rp,children:(0,re.jsx)(k,{children:"Your site\u2019s looking magical. Let\u2019s go live\u2014you get a free framer.ai domain, on us. Pick a custom name and then hit publish."})})]}),(0,re.jsx)(F,{gap:5,className:Uo,children:(0,re.jsx)(se.div,{variants:{default:{x:0},error:{x:[0,-4,4,0],transition:{duration:.2}}},animate:u,children:(0,re.jsxs)(ho,{children:[(0,re.jsx)(vo,{id:"ai-domain",autoComplete:"off",value:n,onChange:v,autoFocus:!0,constantChange:!0,changeOnBlur:!1,enabled:t&&!f,onKeyDown:U}),(0,re.jsx)("span",{className:V(jp,ne),children:".framer.ai"})]})})}),(0,re.jsxs)(F,{direction:"row",gap:10,alignItems:"center",justifyContent:"stretch",className:Uo,children:[(0,re.jsx)(J,{onClick:w,className:Uo,children:"Not Now"}),(0,re.jsx)(J,{variant:"AIGradient",enabled:t&&m===null&&!f&&!p,onClick:S,className:Uo,children:of(m,f||p)})]})]})};function of(t,e){return e?(0,re.jsx)(ot,{}):t||"Publish"}function rf(t,e=30){let o=(0,Up.default)(t,{strict:!0,lower:!0});for(;o.length>e;){let r=o.lastIndexOf("-");if(r<0){o.length>e&&(o=o.substring(0,e));break}o=o.substring(0,r)}return o||"my-ai-site"}function Fp(t){return`${t}.framer.ai`}function nf(){return(0,re.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"30",height:"30",children:(0,re.jsxs)("g",{children:[(0,re.jsx)("defs",{children:(0,re.jsxs)("linearGradient",{id:"idPYJOK145Pg116851",gradientTransform:"rotate(180, 0.5, 0.5)",children:[(0,re.jsx)("stop",{offset:"0",stopColor:"#b8f",stopOpacity:"1"}),(0,re.jsx)("stop",{offset:"1",stopColor:"#0bf",stopOpacity:"1"})]})}),(0,re.jsx)("path",{d:"M 13.379 11.638 C 13.758 11.554 14.054 11.258 14.138 10.879 L 15.024 6.893 C 15.256 5.849 16.744 5.849 16.976 6.893 L 17.862 10.879 C 17.946 11.258 18.242 11.554 18.621 11.638 L 22.607 12.524 C 23.651 12.756 23.651 14.244 22.607 14.476 L 18.621 15.362 C 18.242 15.446 17.946 15.742 17.862 16.121 L 16.976 20.107 C 16.744 21.151 15.256 21.151 15.024 20.107 L 14.138 16.121 C 14.054 15.742 13.758 15.446 13.379 15.362 L 9.393 14.476 C 8.349 14.244 8.349 12.756 9.393 12.524 Z M 8.061 19.82 C 8.44 19.736 8.736 19.44 8.82 19.061 L 9.091 17.841 C 9.188 17.403 9.812 17.403 9.909 17.841 L 10.18 19.061 C 10.264 19.44 10.56 19.736 10.939 19.82 L 12.159 20.091 C 12.597 20.188 12.597 20.812 12.159 20.909 L 10.939 21.18 C 10.56 21.264 10.264 21.56 10.18 21.939 L 9.909 23.159 C 9.812 23.597 9.188 23.597 9.091 23.159 L 8.82 21.939 C 8.736 21.56 8.44 21.264 8.061 21.18 L 6.841 20.909 C 6.403 20.812 6.403 20.188 6.841 20.091 Z",fill:"url(#idPYJOK145Pg116851)"})]})})}var cr=g(_());var Dp="moveDraft_m1cpkqs3",Op="moveDraftTitle_m1nbloso",Bp="buttons_bb1mirm",_p="moveDraftDescription_mo8n8ae",Vp="moveDraftButton_mr6y2w0",qp="confirmMoveDraftButton_c10bqkjb",Hp="buttonChevron_bd7crx9";var Re=g(N());function Wp({user:t,projectState:e,onShowMoveProjectMenu:o,onConfirmMoveProject:r,moveProjectDestination:i}){let{project:n}=e,c=cr.default.useRef(null),[m,l]=cr.default.useState(!1),p=cr.default.useMemo(()=>Po(n,t),[n,t]);async function a(){if(c.current===null)return;let v=c.current.getBoundingClientRect();l(!0),await o({location:{x:v.left,y:v.bottom},showBackToDashboardItem:!1,skipConfirmation:!0}),l(!1)}let u=cr.default.useCallback(async()=>{q("ui_interaction",{page:"invite-panel",id:"move-to-teams"}),await r()},[r]);return(0,Re.jsxs)(F,{padding:30,gap:15,alignItems:"center",justifyContent:"center",className:Dp,children:[(0,Re.jsx)("div",{className:Op,children:"Invite Collaborators"}),(0,Re.jsxs)("div",{className:_p,children:[(0,Re.jsx)(k,{children:"Move your projects to a team"}),(0,Re.jsx)("br",{}),(0,Re.jsx)(k,{children:"to add more collaborators."})]}),(0,Re.jsxs)(F,{className:Bp,direction:"row",gap:10,children:[(0,Re.jsxs)(J,{className:Vp,large:!0,onClick:a,ref:c,children:[(0,Re.jsx)("div",{className:ne,children:i||p.label}),(0,Re.jsx)("div",{className:Hp,children:(0,Re.jsx)(xr,{isActive:m})})]}),(0,Re.jsx)(J,{onClick:u,large:!0,className:qp,variant:"primary",enabled:!!i&&i!==p.label,children:(0,Re.jsx)(k,{children:"Move"})})]})]})}var Pm=g(_());var Et=g(_());function $p(t,e){let o=[...t],r=o.findIndex(({user:i})=>i.id===e);return o.splice(r,1),o}function af(t,e,o){let r=[...t],i=r.findIndex(({user:c})=>c.id===e),n=r[i];return n?(r.splice(i,1,{...n,success:o}),r):t}function cf(t,e){switch(e.type){case"addEntry":return{...t,invitedUsers:[e.entry,...t.invitedUsers]};case"resolveEntry":return{...t,invitedUsers:$p(t.invitedUsers,e.id),inviteMap:{...t.inviteMap,[e.resourceId]:e.id}};case"removeEntry":return{...t,invitedUsers:$p(t.invitedUsers,e.id)};case"updateInviteStatus":return{...t,invitedUsers:af(t.invitedUsers,e.id,e.status)};default:pe(e)}}function kn(t){let[e,o]=(0,Et.useReducer)(cf,{invitedUsers:[],inviteMap:{}}),{inviteMap:r,invitedUsers:i}=e,n=(0,Et.useRef)([]),c=(0,Et.useCallback)(l=>!(l.user.id in r&&i.some(p=>p.user.id===l.user.id)),[r,i]),m=(0,Et.useCallback)(l=>{let p=r[l.user.id];return p||l.user.id},[r]);return n.current=(0,Et.useMemo)(()=>i.length>0?n.current:t.filter(c),[t,i,c]),{acl:n.current,invitedUsers:i,dispatchInvites:o,getStableEntryKey:m}}var Wt=g(_());var Tn=15,Mn=20,eo=2,Gp="main_mtjdnlw",to="buttons_b16j3fv2",zp="header_h7bdi9s",Kp="sectionHeader_s12h9rvh",Zp="separator_sql7wjp",Mi="separatorWithPadding_s1gaa8io",Ei="isDisabled_ibeu8mf",Yp="inputGrid_imryu2",Ht="sidePadding_s1kcrkj9",Jp="users_unllbx4",Xp="roleSelect_r1a07q4t",oo="userInfoName_u1wvxecz",ro="userInfoDetail_u1axfeak",En="userInfoDetailText_ugv3bsa",Qp="userInfoStatus_u5ox40e",em="domains_den2nnp",tm="errorMessage_emichmx",om="warningMessage_wld01wx",no="avatarGrid_aiyskyy",io="editableRole_ehwjfgd",Ai="updating_u128a741",Ri="badgeFramerEmployeeWrapper_b1azfp4q",rm="badgeViewerWrapper_bvvl9i5",nm="shareLinkIcon_s1wgfjgu";var No=g(_());function im(t){return new Promise(e=>{setTimeout(e,t)})}var sm="container_c1246jw8",am="menu_mxpor1j",cm="menuIsClosing_mfp352",ji="menuRow_mihampg",lm="checkboxLabel_c6nal8x",pm="checkboxDescription_cj7iy0t",xi="checkboxDisabled_c14mb9fl",mm="clickable_c125bqli",dm="separator_s43hwdv";var Ve=g(N());function pr({alignmentRef:t,alignWidth:e,menuItems:o}){let[r,i]=No.default.useState(!1),[n,c]=No.default.useState(!1);return[{menuItems:o,alignmentRef:t,alignWidth:e,visible:r,closing:n,closeMenu:async()=>{c(!0),await im(200),c(!1),i(!1)}},()=>{n||i(!0)}]}function mr(t){let{menuItems:e,alignmentRef:o,alignWidth:r,visible:i,closing:n,closeMenu:c}=t,m=No.default.useRef(null);return No.default.useLayoutEffect(()=>{if(!i||!m.current||!o.current)return;let{top:l,left:p,width:a,height:u}=o.current.getBoundingClientRect();r&&(m.current.style.width=`${a}px`),m.current.style.marginTop=`${u}px`,m.current.style.top=`${l}px`,m.current.style.left=`${p}px`},[i,o,r]),No.default.useEffect(()=>{let l=a=>{i&&a.target instanceof Node&&m.current&&!m.current.contains(a.target)&&(c(),a.stopPropagation())},p=a=>{i&&(c(),a.stopPropagation())};return document.addEventListener("mousedown",l,!0),document.addEventListener("keydown",p,!0),()=>{document.removeEventListener("mousedown",l,!0),document.removeEventListener("keydown",p,!0)}},[c,i]),i?(0,Ve.jsx)(da,{children:(0,Ve.jsx)("div",{ref:m,className:sm,children:(0,Ve.jsx)("div",{className:V(am,n&&cm),children:e.filter(l=>l.visible!==!1).map((l,p)=>(0,Ve.jsx)(pf,{menuItem:l,closeMenu:c},p))})})}):null}function pf({menuItem:t,closeMenu:e}){let{type:o}=t;switch(o){case"checkbox":return(0,Ve.jsxs)(F,{gap:10,direction:"row",alignItems:"center",className:V(ji),children:[(0,Ve.jsx)(Jo,{id:t.actionId,value:t.checked,onChange:()=>t.action(t.actionId),enabled:!t.disabled}),(0,Ve.jsxs)("label",{htmlFor:t.actionId,className:V(lm,t.disabled&&xi),children:[t.label,t.description&&(0,Ve.jsxs)("span",{className:V(pm,t.disabled&&xi),children:[" ","\xB7 ",t.description]})]})]});case"option":return(0,Ve.jsxs)(F,{direction:"row",alignItems:"center",justifyContent:"space-between",onClick:()=>{t.action(),e()},className:V(ji,mm),children:[t.label,t.badge&&(0,Ve.jsx)(Zo,{className:"badge",children:t.badge})]});case"separator":return(0,Ve.jsx)("div",{className:dm});default:pe(o,"All menu items should get rendered")}}async function An(t){t.popover.active=0,await t.siteSettings.setActiveTab({tab:"plans",upsellTeamPlan:"teamPro"})}var me=g(N());function fm({isViewOnly:t,projectState:e,handleInvite:o,handleApiError:r,handleTeamUpgrade:i,pendingEntries:n,invitedUsers:c,dispatchInvites:m,currentUserPermissions:l}){let{project:p}=e,{settings:a}=p,u=Mr(),v=(0,Wt.useRef)(0),w=Be("canInviteEditors"),S=Be("canUseEditorPermissions"),[U,f]=(0,Wt.useState)(!1),[y,b]=(0,Wt.useState)(""),[P,A]=(0,Wt.useState)({role:"collaborator",permissions:l}),{role:M,permissions:R}=P,h=a.featureFlags.canInviteAnyDomain==="off";async function T(oe){oe.preventDefault();let Q=y.toLowerCase().trim();if(cn(Q)&&!c.find(({user:fe})=>fe.name===Q)&&!n.find(({user:fe})=>fe.name===Q)){let[,fe]=Q.split("@"),Ae=async()=>{if(fe&&h&&a.allowedDomains.length>0&&!a.allowedDomains.includes(fe)){f(!0);return}let ae=`${v.current++}`,Pe={kind:"invite",user:{id:ae,name:Q,initials:""},role:M,permissions:R,pending:!0,color:null,lastOpenedAt:null,success:null,email:Q};m({type:"addEntry",entry:Pe}),b("");try{let ve=await o({email:Q,role:M,permissions:R});ve&&m({type:"resolveEntry",id:ae,resourceId:ve.user.id})}catch(ve){r(ve,ae),m({type:"removeEntry",id:ae})}};if(!w&&!Io(Q)){i(0,[Q],Ae);return}Ae().catch(O)}else u.start({x:0,transition:{type:"spring",velocity:600,stiffness:5e3,damping:20}}).catch(O)}function j(oe){U&&f(!1),b(oe)}let D=async oe=>{A(Q=>{let fe=Br(Q.permissions[oe]),Ae={...Q.permissions,[oe]:fe};return{role:Object.entries(Ae).filter(([ve,St])=>St==="on").map(([ve,St])=>ve).length===0?"viewer":"collaborator",permissions:Ae}})},W=Wt.default.useRef(null),$=!S,he=[..._r.map(oe=>{let{label:Q,description:fe}=qr(oe);return{type:"checkbox",label:Q,description:fe,actionId:oe,action:D,checked:R[oe]==="on",disabled:$||l[oe]==="off"}}),{type:"separator",visible:$},{type:"option",label:"Upgrade",badge:"Pro Workspace",action:()=>An(s),visible:$}],[Y,De]=pr({alignmentRef:W,alignWidth:!0,menuItems:he});return(0,me.jsx)("div",{className:Ht,children:(0,me.jsxs)("form",{className:Yp,onSubmit:T,children:[(0,me.jsxs)(se.div,{animate:u,style:{originY:.9},children:[(0,me.jsxs)(ho,{ref:W,hasError:U,large:!0,children:[(0,me.jsx)(vo,{autoFocus:!0,type:"email",name:"email",placeholder:"name@email.com",value:y,onChange:j,constantChange:!0,enabled:!t,className:V(t&&Ei),"data-1p-ignore":!0}),(0,me.jsxs)(J,{variant:"link",enabled:!t,onClick:De,className:V(Xp,t&&Ei),children:[Xo(R,M),(0,me.jsx)(ze,{})]}),(0,me.jsx)(mr,{...Y})]}),(0,me.jsx)(bo,{className:om,visible:Io(y),children:(0,me.jsx)(k,{children:"You won\u2019t be billed for any invited Framer employees."})}),(0,me.jsx)(bo,{className:tm,visible:U,children:a.allowedDomains.length>2?(0,me.jsx)(k,{children:"The email domain you entered is not allowed"}):(0,me.jsxs)(me.Fragment,{children:[(0,me.jsx)(k,{children:"Only"}),(0,me.jsxs)("span",{className:em,children:[" ",a.allowedDomains.map(oe=>`@${oe}`).join(", ")," "]}),(0,me.jsx)(k,{children:"emails are allowed"})]})})]}),(0,me.jsx)(J,{enabled:!t,className:to,large:!0,title:"Send",type:"submit",variant:"primary",onClick:ht})]})})}var Me=g(_());function Rn(t){E({key:`deny-${t.id}-project-access-failed`,type:"add",variant:"error",text:`Failed to deny ${t.name} access to this project`,icon:"error",duration:3e3})}function jn(t,e){let o=`Failed to add ${t.name} as an editor to this project.`;e instanceof Tc?o="This request has already been reviewed by someone else in your workspace.":e instanceof kc&&(o="You have reached the editor limit, please upgrade your workspace."),E({key:`grant-${t.id}-project-access-failed`,type:"add",variant:"error",text:o,icon:"error",duration:3e3})}function xn(t,e,{ownerName:o,ownerId:r}){let{project:i}=t.projectStore;ce(i,"Project should exist when moving project owner");let n=i.space.ownerId,c=async()=>{await gt.put(`/web/projects/${i.id}/owner`,{ownerId:r})},m=async()=>{await(e==null?void 0:e.pollProject({intervalMillis:3e3,attempts:10,stopCondition:p=>p.owner.id===r})),await(e==null?void 0:e.forceRefreshACL())},l=()=>{t.popover.active=2};t.popover.active=0,t.modalStore.set({type:"Confirmation",source:"invite_panel",title:"Transfer Ownership",description:`To transfer ownership, ${o} must be an admin or editor in your workspace.`,confirmLabel:"Confirm",onConfirm:async()=>{try{await c(),await m()}catch(p){p.status===409?uf({teamId:n,ownerName:o}):ff()}finally{l()}},onCancel:()=>l(),onDismiss:()=>l(),variant:"destructive"})}var gm="move-project-owner";function uf({teamId:t,ownerName:e}){E({key:gm,type:"add",variant:"error",text:`${e} must be an editor or admin in your workspace.`,icon:"error",duration:5e3,action:{title:"Manage Workspace",onClick:()=>Ke(`${Ia}?teamId=${t}&open-settings=1&settings-tab=${"membersList"}`)}})}function ff(){E({key:gm,type:"add",variant:"error",text:"We\u2019re unable to move ownership. Please contact support.",icon:"error",duration:3e3,action:{title:"Contact Support",onClick:()=>Ke(Ka)}})}var B=g(N());function vm({isViewOnly:t,projectState:e,handleInvite:o,handleApiError:r,handleTeamUpgrade:i,currentUserEntry:n,invitedUsers:c,activeEntries:m,inactiveEntries:l,pendingEntries:p,accessRequestEntries:a,dispatchInvites:u,currentUserPermissions:v,currentUserIsTeamAdmin:w,currentUserIsProjectOwner:S,getStableEntryKey:U}){let f=(0,Me.useMemo)(()=>a.map(M=>({entry:M,ordering:""})).sort(Fi),[a]),[y,b]=gf(n,c,m,l,p);async function P(M){u({type:"updateInviteStatus",id:M,status:null});try{let R=c.find(({user:h})=>h.id===M);if(R)await o({email:R.email,role:R.role,permissions:R.permissions});else throw new Error}catch(R){r(R,M)}}let A=[{key:"0",title:"Requesting Access",rows:f},{key:"1",title:void 0,rows:y},{key:"2",title:void 0,rows:b}].filter(({rows:M})=>M.length>0);return(0,B.jsx)(dt,{initial:!1,children:(0,B.jsx)(F,{gap:Tn,direction:"column",className:Ht,children:A.map(({key:M,rows:R,title:h},T)=>(0,B.jsxs)(Me.default.Fragment,{children:[T>0&&(0,B.jsx)("div",{className:Zp}),h&&(0,B.jsx)("div",{className:Kp,children:(0,B.jsx)(k,{children:h})}),(0,B.jsx)(F,{gap:Mn,direction:"column",children:R.map(({entry:j,inactive:D})=>j.kind==="accessRequest"?(0,B.jsx)(hf,{handleTeamUpgrade:i,indicateFramerEmployee:!!j.user.isFramerEmployee&&!(n!=null&&n.user.isFramerEmployee),entry:j},j.id):(0,B.jsx)(yf,{projectState:e,indicateFramerEmployee:!!j.user.isFramerEmployee&&!(n!=null&&n.user.isFramerEmployee),isViewOnly:t,entry:j,handleRetry:P,handleTeamUpgrade:i,inactive:D,currentUserPermissions:v,currentUserIsTeamAdmin:w,currentUserIsProjectOwner:S},U(j)))})]},M))})})}function gf(t,e,o,r,i){let[n,c]=(0,Me.useMemo)(()=>{let m=[],l=[],p=a=>{(a.entry.role==="viewer"?l:m).push(a)};return t&&p({entry:t,ordering:"9"}),o.forEach(a=>{p({entry:a,ordering:"8"})}),r.forEach(a=>{p({entry:a,inactive:!0,ordering:ym("7",a)})}),e.forEach(a=>{p({entry:a,ordering:ym("7",a)})}),i.forEach(a=>{let u={...a,user:{...a.user,initials:a.user.initials||a.user.name.substr(0,2).toLocaleUpperCase()}};p({entry:u,inactive:!0,pending:!0,ordering:"0"})}),[m.sort(Fi),l.sort(Fi)]},[t,e,o,r,i]);return[n,c]}function ym(t,e){return`${t}-${e.lastOpenedAt||0}`}function Fi(t,e){return t.ordering!==e.ordering?t.ordering<e.ordering?1:-1:t.entry.user.name===e.entry.user.name?t.entry.user.id.localeCompare(e.entry.user.id):t.entry.user.name.localeCompare(e.entry.user.name,void 0,{sensitivity:"base"})}var hm={duration:.15,ease:"easeInOut"},Ln={initial:{opacity:0,scale:.5},animate:{opacity:1,scale:1,transition:hm},exit:{opacity:0,scale:.5,transition:hm}},yf=Me.default.forwardRef(function({projectState:e,isViewOnly:o,inactive:r=!1,entry:i,handleRetry:n,handleTeamUpgrade:c,currentUserPermissions:m,currentUserIsTeamAdmin:l,currentUserIsProjectOwner:p,indicateFramerEmployee:a},u){let v=Ze(),{user:w,role:S,permissions:U,pending:f}=i,{isDarkMode:y}=Se(),{project:b}=e,P=s.sessionStore.useState(we=>we.user.id),[A,M]=Me.default.useState(null),[R,h]=Me.default.useState(!1),[T,j]=Me.default.useState(!1),[D,W]=Me.default.useState(!1),$=w.id===P,Z=w.id===b.owner.id,he=S==="viewer",Y=Be("canInviteEditors"),De=Be("canUseEditorPermissions"),oe=l||p,Q=he&&D&&!o,fe=!r&&!$,Ae=(0,Me.useCallback)(we=>{var jt;(jt=s.remoteDocument)==null||jt.setSpectatedUser(we.id)},[]),$e=()=>{if(!v)return;let we=()=>v.updateUserPermissions({id:w.id,role:"collaborator",permissions:m});if(!Y&&!w.isFramerEmployee){c(1,[w.name],we);return}j(!0),we().catch(()=>{j(!1)})},ae=A||U||va,Pe=async we=>{if(!ae||!v)return;let jt=Br(ae[we]),$t={...ae,[we]:jt},Cr={id:w.id,role:"collaborator",permissions:$t},Pt=()=>v.updateUserPermissions(Cr);if(!Y&&!w.isFramerEmployee){c(1,[w.name],Pt);return}M(Cr.permissions),Pt().catch(()=>{M(null)})},ve=async()=>{xn(s,v,{ownerName:w.name,ownerId:w.id})},St=()=>{h(!0),f?v==null||v.removeInvite({id:w.id}).catch(()=>h(!1)):v==null||v.removeUserPermissions({id:w.id}).catch(()=>h(!1))},I=Me.default.useRef(null),z=!f&&!he&&!$,ge=oe&&!Z&&!f,Xe=!Z&&!$,xe=!De,qo=[..._r.map(we=>{let{label:jt,description:$t}=qr(we);return{type:"checkbox",label:jt,description:$t,actionId:we,action:Pe,checked:ae?ae[we]==="on":!1,visible:z,disabled:xe||m[we]==="off"}}),{type:"separator",visible:z&&(Xe||xe)},{type:"option",label:"Upgrade",badge:"Pro Workspace",action:()=>An(s),visible:z&&xe},{type:"option",label:"Make Project Owner",action:ve,visible:ge},{type:"option",label:"Remove",action:St,visible:Xe}],[Qe,Ct]=pr({alignmentRef:I,menuItems:qo}),ct,Ho=$&&ge;f&&i.success===!1?ct=(0,B.jsx)(tt,{as:se.button,variant:"link",className:V(io),onClick:()=>n(w.id),...Ln,children:(0,B.jsx)(k,{children:"Retry"})}):!Ho&&($||Z||o)?ct=(0,B.jsx)(se.span,{...Ln,children:(0,B.jsx)(tt,{as:se.button,variant:"link",className:io,enabled:!1,children:(0,B.jsx)(k,{children:Xo(U||null,S)})})},"role"):ct=(0,B.jsxs)(B.Fragment,{children:[(0,B.jsxs)(tt,{ref:I,as:se.button,variant:"link",className:io,onClick:Ct,children:[(0,B.jsx)(k,{children:Xo(ae,S)}),(0,B.jsx)(ze,{})]}),(0,B.jsx)(mr,{...Qe})]});let co=a?`${w.name.split(" ")[0]} from Framer`:w.name;return(0,B.jsxs)(se.li,{ref:u,...Ln,className:V(no,R&&Ai),onPointerEnter:()=>W(!0),onPointerLeave:()=>W(!1),children:[(0,B.jsxs)("div",{children:[(0,B.jsx)(So,{entry:i,isDarkMode:y,onClick:fe?()=>Ae(i.user):void 0,onClickHoverIcon:fe?(0,B.jsx)(Yo,{width:"18",height:"18"}):void 0,greyScale:he}),a?(0,B.jsx)("div",{className:Ri,title:"Framer Employee",children:(0,B.jsx)(go,{width:"6",height:"9"})}):he?(0,B.jsx)("div",{className:rm,title:"Framer Employee",children:(0,B.jsx)(Yo,{})}):null]}),(0,B.jsxs)(F,{gap:eo,direction:"column",justifyContent:"center",children:[(0,B.jsx)("div",{className:V(ne,oo),title:w.name,children:(0,B.jsx)(k,{children:co})}),(0,B.jsx)("div",{className:ro,children:ct})]}),(0,B.jsx)(dt,{initial:!1,mode:"wait",children:Q&&!f?(0,B.jsx)(J,{enabled:!o,className:to,large:!0,onClick:$e,children:T?(0,B.jsx)(ot,{}):(0,B.jsx)(k,{children:"Upgrade"})}):(0,B.jsx)(k,{className:Qp,children:f?"Pending":Or(i,!r,{shortDate:!0})})})]})}),hf=Me.default.forwardRef(function({entry:e,indicateFramerEmployee:o,handleTeamUpgrade:r},i){let n=Be("canInviteEditors"),c=Me.default.useRef(null),[m,l]=Me.default.useState(!1),p=Ze(),{isDarkMode:a}=Se(),[u,v]=pr({alignmentRef:c,menuItems:[{type:"option",label:"Decline",action:y,visible:!0}]}),{user:w,email:S,id:U}=e;function f(){if(!p||m)return;q("ui_interaction",{id:"grant-access",page:"invite-panel"});let b=async()=>{l(!0),await p.grantProjectAccessRequest({id:U}).catch(P=>{jn(w,P),l(!1)})};n||w.isFramerEmployee?b():r(2,[w.name],b)}function y(){!p||m||(q("ui_interaction",{id:"deny-access",page:"invite-panel"}),l(!0),p.denyProjectAccessRequest({id:U}).catch(()=>{Rn(w),l(!1)}))}return(0,B.jsxs)(se.li,{ref:i,...Ln,className:V(no,m&&Ai),children:[(0,B.jsxs)("div",{children:[(0,B.jsx)(So,{entry:e,isDarkMode:a}),o?(0,B.jsx)("div",{className:Ri,title:"Framer Employee",children:(0,B.jsx)(go,{width:"6",height:"9"})}):null]}),(0,B.jsxs)(F,{gap:eo,direction:"column",justifyContent:"center",children:[(0,B.jsx)("div",{className:V(ne,oo),title:w.name,children:(0,B.jsx)(k,{children:o?`${w.name.split(" ")[0]} from Framer`:w.name})}),(0,B.jsxs)("div",{className:ro,children:[(0,B.jsxs)(tt,{ref:c,as:se.button,variant:"link",className:io,onClick:v,children:[(0,B.jsx)(k,{children:S}),(0,B.jsx)(ze,{})]}),(0,B.jsx)(mr,{...u})]})]}),(0,B.jsx)(dt,{initial:!1,mode:"wait",children:(0,B.jsx)(J,{className:to,large:!0,onClick:f,children:m?(0,B.jsx)(ot,{}):(0,B.jsx)(k,{children:"Accept"})})})]})});function Fn(){s.modalStore.set({type:"Confirmation",source:"invite_panel",title:"Add Project Restrictions",description:"Purchase a plan to manage project restrictions and access even more features.",confirmLabel:"Dismiss",onConfirm:ht})}async function bm(t,e,{isDarkMode:o,triggerRef:r}){let{top:i,left:n,height:c}=r!=null&&r.current?r.current.getBoundingClientRect():t.currentTarget.getBoundingClientRect(),m=[{action:"view",label:Un("view"),checked:e==="view"},{action:"none",label:Un("none"),checked:e==="none"}],l=await wo.show(m,{isDarkMode:o,location:{x:n-1,y:i+c+5}});return l?l.action:void 0}function Un(t){switch(t){case"view":return"Anyone with link can view";case"none":return"Only members can access";default:ks(t)}}var Ne=g(N());function Sm({isViewOnly:t,isDraftProject:e,isCurrentUserOwner:o,onCopyProjectURL:r,projectState:i,onAccessChange:n}){let{project:c}=i,{publicAccess:m,settings:l}=c,p=Be("canUsePrivateLink"),a=!t&&l.featureFlags.canChangeProjectAccess==="on"&&(!e||o),{isDarkMode:u}=Se(),v=s.wrapHandler(()=>{Nt(Jr(c).toString()).catch(O),r()}),w=()=>{Fn()};return(0,Ne.jsx)("div",{className:Ht,children:(0,Ne.jsxs)("div",{className:no,children:[(0,Ne.jsx)(fo,{color:uo.tintDimmed,textCustomStyles:nm,text:(0,Ne.jsx)(ca,{})}),(0,Ne.jsxs)(F,{direction:"column",gap:eo,justifyContent:"center",children:[(0,Ne.jsx)("div",{className:V(ne,oo),children:(0,Ne.jsx)(k,{children:"Project Link"})}),(0,Ne.jsx)("div",{className:V(ro,En),children:(0,Ne.jsxs)(tt,{as:se.button,variant:"link",className:io,enabled:a,onClick:async S=>{q("ui_interaction",{page:"invite-panel",id:"open-project-link-settings"});let U=await bm(S,m||[],{isDarkMode:u});U==="none"&&!p?w():U&&n(U)},children:[(0,Ne.jsx)(k,{children:Un(m)}),a&&(0,Ne.jsx)(ze,{})]})})]}),(0,Ne.jsx)(Ur,{className:to,large:!0,title:"Copy",onClick:v})]})})}var At=g(N());function Cm({displayName:t,avatar:e}){let o=ft.extractInitials(t||"");return(0,At.jsx)("div",{className:Ht,children:(0,At.jsxs)("div",{className:no,children:[(0,At.jsx)(fo,{color:uo.tint,src:e||void 0,text:o}),(0,At.jsxs)(F,{direction:"column",gap:eo,justifyContent:"center",children:[(0,At.jsx)("div",{className:V(ne,oo),children:t}),(0,At.jsx)("div",{className:V(ro,En),children:(0,At.jsx)(k,{children:"All members can access"})})]})]})})}var qe=g(N());function wm({user:t,projectState:e,isDraftProject:o,isCurrentUserOwner:r,onAccessChange:i,onCopyProjectURL:n}){let{activeIds:c,project:m,accessRequests:l}=e,{space:p}=m,a=t.spaces.find(({id:$})=>$===p.id),u=Yt("canInviteCollaborators"),v=Cc(),w=Ze(),{invitedUsers:S,acl:U,dispatchInvites:f,getStableEntryKey:y}=kn(e.acl),[b,P,A,M]=Hr({acl:U,activeIds:c,order:"chronologically",userId:t.id}),R=be(a)&&a.role==="admin",h=(b==null?void 0:b.role)==="owner",T=Pm.default.useContext(an);function j($,Z,he){a&&(s.popover.active=0,s.modalStore.set({type:"UpgradeTeamPlan",source:"invite_panel",paywall:$,teamId:a==null?void 0:a.ownerId,currentTeamLicense:m.teamLicenseType,editorList:Z,subscriptionPrices:T,onUpgrade:async Y=>{await he(),w&&await tn(w.pollProject,{projectLicenseType:m.license.type,teamLicenseType:Y})},onDismiss:()=>{s.modalStore.dismiss(),s.popover.active=2}}))}function D($,Z){$ instanceof kt&&$.isTemporary&&f({type:"updateInviteStatus",id:Z,status:!1})}async function W($){if(w)return w.inviteByEmail($)}return(0,qe.jsxs)(F,{gap:Tn,direction:"column",className:Gp,children:[(0,qe.jsx)("div",{className:zp,children:(0,qe.jsx)(k,{children:"Invite"})}),(0,qe.jsx)(fm,{isViewOnly:u,projectState:e,handleInvite:W,handleApiError:D,handleTeamUpgrade:j,pendingEntries:M,invitedUsers:S,dispatchInvites:f,currentUserPermissions:v}),(0,qe.jsx)("div",{className:Mi}),(0,qe.jsxs)(F,{gap:Mn,direction:"column",children:[p.displayName&&(0,qe.jsx)(Cm,{displayName:p.displayName,avatar:a==null?void 0:a.avatar}),(0,qe.jsx)(Sm,{isViewOnly:u,isDraftProject:o,isCurrentUserOwner:r,projectState:e,onCopyProjectURL:n,onAccessChange:i})]}),(0,qe.jsx)("div",{className:Mi}),(0,qe.jsx)("div",{className:Jp,children:(0,qe.jsx)(vm,{isViewOnly:u,projectState:e,handleInvite:W,handleApiError:D,handleTeamUpgrade:j,currentUserEntry:b,activeEntries:P,inactiveEntries:A,pendingEntries:M,accessRequestEntries:l,invitedUsers:S,dispatchInvites:f,currentUserPermissions:v,currentUserIsTeamAdmin:R,currentUserIsProjectOwner:h,getStableEntryKey:y})})]})}var zm=g(_());var Im="main_m1qqqi9r",km="shareUsers_s1gmod5c",Ni="shareUsersGrid_s1cc20ej",Tm="header_hw5sntf",Mm="sectionHeader_s1pvegcm",Di="isViewOnly_ie61lu6",Em="inputInner_i2tj1sj",Am="inputGrid_i1h1ba5a",Rm="roleSelect_r1fkm4u6",jm="projectLink_pdy16ua",xm="projectLinkSettings_p1k13gha",Lm="projectLinkCopy_p1ny9l3b",Fm="domains_d1m8xse2",Um="errorMessage_e182d5ua",Nm="separator_s33rzhp",Dm="warningMessage_w1lgukk2";var He=g(_());var ur="container_cel2zsj",Oi="editableRole_e1tesl13",fr="role_rxiebl9",gr="lastViewed_l16q6h28",yr="userInfo_u1ilo76u",Bi="badgeFramerEmployeeWrapper_b16q3199",hr="userInfoName_u1g5b2sh",Bm="button_b1f4zckn";var st=g(N()),Vm=({space:t})=>{let e=ft.extractInitials(t.displayName||"");return(0,st.jsxs)("li",{className:ur,children:[(0,st.jsx)("div",{children:(0,st.jsx)(fo,{color:uo.tint,text:e})}),(0,st.jsxs)("div",{className:yr,children:[(0,st.jsx)(ye,{className:V(ne,hr),children:t.displayName}),(0,st.jsx)(ye,{size:12,className:gr,children:(0,st.jsx)(k,{children:"All members can access"})})]}),(0,st.jsx)("div",{className:fr,children:(0,st.jsx)(k,{children:"Can access"})})]})};var Oo=g(_());var ee=g(N()),$m=g(_()),qm={duration:.15,ease:"easeInOut"},Nn={initial:{opacity:0,scale:.5},animate:{opacity:1,scale:1,transition:qm},exit:{opacity:0,scale:.5,transition:qm}},Do={["owner"]:"Owner",["collaborator"]:"Can edit",["viewer"]:"Can view",["prototypeViewer"]:"Can view prototype"},Hm=Oo.default.forwardRef(function({isCurrentUser:e,isViewOnly:o,currentUserIsTeamAdmin:r,currentUserIsProjectOwner:i,canInviteEditors:n,inactive:c=!1,entry:m,handleRetry:l,handleTeamUpgrade:p,indicateFramerEmployee:a,onClick:u,onClickHoverIcon:v},w){let S=Ze(),{user:U,role:f,pending:y}=m,[b,P]=(0,Oo.useState)(),A=b!=null?b:f,{isDarkMode:M}=Se(),R=f==="owner",h=r||i,T=!y&&!e,j=h&&!R&&!y,D=!R&&!e,W=tr();async function $(Q){let{top:fe,left:Ae}=Q.currentTarget.getBoundingClientRect(),$e=y?[{label:Do["collaborator"],action:"collaborator",disabled:!0},{label:Do["viewer"],action:"viewer",disabled:!0},{type:"separator"},{label:"Remove",action:"removeInvite"}]:[{label:Do["collaborator"],action:"collaborator",visible:T},{label:Do["viewer"],action:"viewer",visible:T},{type:"separator",visible:T},{label:"Make Project Owner",action:"moveOwner",visible:j},{label:"Remove",action:"remove",visible:D}],ae=await W({location:{x:Ae,y:fe},items:$e,enableTranslate:!0});if(!ae)return;let{action:Pe}=ae;if(Pe!==f)if(Pe==="collaborator"){if(!S)return;let ve=()=>S.updateUserPermissions({id:U.id,role:Pe,permissions:Vr});if(!n&&!U.isFramerEmployee){p(1,[U.name],ve);return}P(Pe),ve().catch(O)}else Pe==="viewer"?(P(Pe),S==null||S.updateUserPermissions({id:U.id,role:Pe,permissions:null}).catch(O)):ae.action==="remove"?S==null||S.removeUserPermissions({id:U.id}).catch(O):ae.action==="removeInvite"?S==null||S.removeInvite({id:U.id}).catch(O):ae.action==="moveOwner"&&xn(s,S,{ownerName:U.name,ownerId:U.id})}let Z,he=e&&j;y&&m.success===!1?Z=(0,ee.jsx)(tt,{as:se.button,...Nn,type:"button",className:V(Bm),onClick:()=>l(U.id),children:"Retry"}):!he&&(e||R||o)?Z=(0,$m.createElement)(se.span,{...Nn,key:"role"},Do[f]):Z=(0,ee.jsxs)(tt,{as:se.button,variant:"link",className:Oi,onClick:$,children:[Do[A],(0,ee.jsx)(ze,{})]});let oe=a?`${U.name.split(" ")[0]} from Framer`:U.name;return(0,ee.jsxs)(se.li,{ref:w,...Nn,className:V(ur),children:[(0,ee.jsxs)("div",{children:[(0,ee.jsx)(So,{entry:m,isDarkMode:M,onClick:u,onClickHoverIcon:v}),a?(0,ee.jsx)("div",{className:Bi,title:"Framer Employee",children:(0,ee.jsx)(go,{width:"6",height:"9"})}):null]}),(0,ee.jsxs)("div",{className:yr,children:[(0,ee.jsx)(ye,{className:V(ne,hr),title:U.name,children:oe}),(0,ee.jsx)(ye,{size:12,className:gr,children:y?(0,ee.jsx)(k,{children:"Pending"}):Or(m,!c)})]}),(0,ee.jsx)("div",{className:fr,children:(0,ee.jsx)(dt,{initial:!1,mode:"wait",children:Z})})]})}),Wm=Oo.default.forwardRef(function({entry:e,indicateFramerEmployee:o,canInviteEditors:r,handleTeamUpgrade:i},n){let c=Ze(),[m,l]=Oo.default.useState(!1),{isDarkMode:p}=Se(),a=tr(),{user:u,id:v,email:w}=e;async function S(U){if(!c||m)return;let{top:f,left:y}=U.currentTarget.getBoundingClientRect(),b=await a({location:{x:y,y:f},items:[{label:"Accept",action:"grantProjectAccessRequest"},{label:"Decline",action:"denyProjectAccessRequest"}],enableTranslate:!0});if((b==null?void 0:b.action)==="grantProjectAccessRequest"){q("ui_interaction",{id:"grant-access",page:"invite-panel"});let P=async()=>{l(!0),await c.grantProjectAccessRequest({id:v}).catch(A=>{jn(u,A),l(!1)})};r||u.isFramerEmployee?P():i(2,[u.name],P)}else(b==null?void 0:b.action)==="denyProjectAccessRequest"&&(q("ui_interaction",{id:"deny-access",page:"invite-panel"}),l(!0),c.denyProjectAccessRequest({id:v}).catch(()=>{Rn(u),l(!1)}))}return(0,ee.jsxs)(se.li,{ref:n,...Nn,className:V(ur),children:[(0,ee.jsxs)("div",{children:[(0,ee.jsx)(So,{entry:e,isDarkMode:p}),o?(0,ee.jsx)("div",{className:Bi,title:"Framer Employee",children:(0,ee.jsx)(go,{width:"6",height:"9"})}):null]}),(0,ee.jsxs)("div",{className:yr,children:[(0,ee.jsx)(ye,{className:V(ne,hr),title:u.name,children:o?`${u.name.split(" ")[0]} from Framer`:u.name}),(0,ee.jsx)(ye,{size:12,className:gr,children:(0,ee.jsx)(k,{children:w})})]}),(0,ee.jsx)("div",{className:fr,children:(0,ee.jsx)(dt,{initial:!1,mode:"wait",children:(0,ee.jsxs)(tt,{as:se.button,variant:"link",className:Oi,onClick:S,disabled:m,children:[(0,ee.jsx)(k,{children:"Review"}),(0,ee.jsx)(ze,{})]})})})]})});var K=g(N());function Gm({user:t,isViewOnly:e,projectState:o,handleTeamUpgrade:r}){let i=t.id,{activeIds:n,accessRequests:c,project:m}=o,{space:l,settings:p}=m,a=t.spaces.find(({id:I})=>I===l.id),{isDarkMode:u}=Se(),v=Mr(),w=(0,He.useRef)(0),{invitedUsers:S,acl:U,dispatchInvites:f,getStableEntryKey:y}=kn(o.acl),b=Be("canInviteEditors"),[P,A]=(0,He.useState)(!1),[M,R]=(0,He.useState)(""),h=b?"collaborator":"viewer",[T,j]=(0,He.useState)(h),[D,W,$,Z]=Hr({acl:U,activeIds:n,order:"alphabetically",filter:({role:I})=>I!=="prototypeViewer",userId:i}),he=be(a)&&a.role==="admin",Y=(D==null?void 0:D.role)==="owner";(0,He.useEffect)(()=>{j(b?"collaborator":"viewer")},[b]);function De(I,z){I instanceof kt&&I.isTemporary&&f({type:"updateInviteStatus",id:z,status:!1})}let oe=Ze();async function Q(I){if(oe)return oe.inviteByEmail(I)}async function fe(I){f({type:"updateInviteStatus",id:I,status:null});try{let z=S.find(({user:ge})=>ge.id===I);if(z)await Q({email:z.email,role:z.role,permissions:z.permissions});else throw new Error}catch(z){De(z,I)}}async function Ae(I){I.preventDefault();let z=M.toLowerCase().trim();if(cn(z)&&!S.find(({user:ge})=>ge.name===z)&&!Z.find(({user:ge})=>ge.name===z)){let[,ge]=z.split("@");if(ge&&vf(p)&&p.allowedDomains.length>0&&!p.allowedDomains.includes(ge)){A(!0);return}let Xe=`${w.current++}`,xe={kind:"invite",user:{id:Xe,name:z,initials:""},role:T,permissions:T==="collaborator"?Vr:void 0,pending:!0,color:null,lastOpenedAt:null,success:null,email:z},Rt=()=>Q({email:xe.email,role:xe.role,permissions:xe.permissions}),qo=!b&&!Io(z);if(T==="collaborator"&&qo){r(0,[z],async()=>{await Rt()});return}f({type:"addEntry",entry:xe}),R(""),v.start({scale:1,transition:{type:"spring",velocity:-20,restDelta:.01,restSpeed:.01,stiffness:2e3,damping:40}}).catch(O);try{let Qe=await Rt();Qe&&f({type:"resolveEntry",id:Xe,resourceId:Qe.user.id})}catch(Qe){De(Qe,Xe),f({type:"removeEntry",id:Xe})}}else v.start({x:0,transition:{type:"spring",velocity:600,stiffness:5e3,damping:20}}).catch(O)}async function $e(I){if(e)return;let{top:z,left:ge}=I.currentTarget.getBoundingClientRect(),Xe=["collaborator","viewer"].map(Rt=>({action:Rt,label:Xn(Rt)})),xe=await wo.show(Xe,{enableTranslate:!0,isDarkMode:u,location:{x:ge,y:z}});xe&&j(xe.action)}function ae(I){P&&A(!1),R(I)}let Pe=(0,He.useMemo)(()=>{let I=[];return D&&I.push({entry:D,isCurrentUser:!0}),S.forEach(z=>{I.push({entry:z,isCurrentUser:!1})}),W.forEach(z=>{I.push({entry:z,isCurrentUser:!1})}),$.forEach(z=>{I.push({entry:z,isCurrentUser:!1,inactive:!0})}),Z.forEach(z=>{I.push({entry:z,isCurrentUser:!1,inactive:!0})}),I},[D,S,W,$,Z]),ve=(0,He.useMemo)(()=>[...c].sort(Aa),[c]),St=(0,He.useCallback)(I=>{var z;(z=s.remoteDocument)==null||z.setSpectatedUser(I.id)},[]);return(0,K.jsxs)(K.Fragment,{children:[(0,K.jsxs)("form",{className:Am,onSubmit:Ae,children:[(0,K.jsxs)(se.div,{animate:v,style:{originY:.9},children:[(0,K.jsxs)(ho,{hasError:P,large:!0,children:[(0,K.jsx)(vo,{autoFocus:!0,type:"email",name:"email",placeholder:"email@example.com",value:M,onChange:ae,constantChange:!0,enabled:!e,className:V(Em,e&&Di),"data-1p-ignore":!0}),(0,K.jsxs)(J,{variant:"link",onClick:$e,className:V(Rm,e&&Di),children:[Xn(T),(0,K.jsx)(ze,{})]})]}),(0,K.jsx)(bo,{className:Dm,visible:Io(M),children:(0,K.jsx)(k,{children:"You won\u2019t be billed for any invited Framer employees."})}),(0,K.jsx)(bo,{className:Um,visible:P,children:p.allowedDomains.length>2?(0,K.jsx)(k,{children:"The email domain you entered is not allowed"}):(0,K.jsxs)(K.Fragment,{children:[(0,K.jsx)(k,{children:"Only"}),(0,K.jsxs)("span",{className:Fm,children:[" ",p.allowedDomains.map(I=>`@${I}`).join(", ")," "]}),(0,K.jsx)(k,{children:"emails are allowed"})]})})]}),(0,K.jsx)(J,{enabled:!e,large:!0,title:"Send",type:"submit",variant:"primary",onClick:ht})]}),(0,K.jsxs)("section",{className:V(km),children:[ve.length>0&&(0,K.jsxs)(K.Fragment,{children:[(0,K.jsx)("div",{className:Mm,children:(0,K.jsx)(k,{children:"Requesting Access"})}),(0,K.jsx)("ul",{className:Ni,children:(0,K.jsx)(dt,{initial:!1,children:ve.map(I=>(0,K.jsx)(Wm,{canInviteEditors:b,handleTeamUpgrade:r,indicateFramerEmployee:!!I.user.isFramerEmployee&&!(D!=null&&D.user.isFramerEmployee),entry:I},I.id))})}),(0,K.jsx)("div",{className:Nm})]}),(0,K.jsxs)("ul",{className:Ni,children:[l.displayName&&(0,K.jsx)(Vm,{space:l},l.id),(0,K.jsx)(dt,{initial:!1,children:Pe.map(({entry:I,isCurrentUser:z,inactive:ge})=>(0,K.jsx)(Hm,{isCurrentUser:z,isViewOnly:e,currentUserIsTeamAdmin:he,currentUserIsProjectOwner:Y,indicateFramerEmployee:!!I.user.isFramerEmployee&&!(D!=null&&D.user.isFramerEmployee),canInviteEditors:b,entry:I,handleRetry:fe,handleTeamUpgrade:r,inactive:ge,onClick:!ge&&I!==D?()=>St(I.user):void 0,onClickHoverIcon:(0,K.jsx)(Yo,{})},y(I)))})]})]})]})}function vf(t){return t.featureFlags.canInviteAnyDomain==="off"}var je=g(N());function Km(t){let e=zm.default.useContext(an),{user:o,projectState:r,isDraftProject:i,isCurrentUserOwner:n,onAccessChange:c,onCopyProjectURL:m}=t,{project:l}=r,{publicAccess:p,settings:a,space:u}=l,v=o.spaces.find(({id:A})=>A===u.id),w=Yt("canInviteCollaborators"),S=Ze(),U=s.wrapHandler(()=>{Nt(Jr(l).toString()).catch(O),m()}),f=Be("canUsePrivateLink");function y(){q("ui_interaction",{page:"invite-panel",id:"open-project-link-settings"})}function b(){s.popover.active=0,f?c("none"):Fn()}function P(A,M,R){v&&(s.popover.active=0,s.modalStore.set({type:"UpgradeTeamPlan",source:"invite_panel",paywall:A,teamId:v==null?void 0:v.ownerId,currentTeamLicense:l.teamLicenseType,editorList:M,subscriptionPrices:e,onUpgrade:async h=>{await R(),S&&await tn(S.pollProject,{projectLicenseType:l.license.type,teamLicenseType:h})},onDismiss:()=>{s.modalStore.dismiss(),s.popover.active=2}}))}return(0,je.jsx)(je.Fragment,{children:(0,je.jsxs)("div",{className:Im,children:[(0,je.jsx)("section",{children:(0,je.jsx)("div",{className:Tm,children:(0,je.jsx)(k,{children:"Invite Collaborators"})})}),(0,je.jsx)(Gm,{...t,user:o,isViewOnly:w||i,handleTeamUpgrade:P}),(0,je.jsxs)("section",{className:jm,children:[(0,je.jsxs)(fa,{enabled:!w&&a.featureFlags.canChangeProjectAccess==="on"&&(!i||n),large:!0,className:xm,onClick:y,children:[(0,je.jsx)(Jn,{title:"Anyone with the link can view",selected:p==="view",onSelect:()=>c("view")},"public"),(0,je.jsx)(Jn,{title:"Only collaborators can access",selected:p==="none",onSelect:b},"space")]}),(0,je.jsx)(Ur,{title:"Copy Link",onClick:U,className:Lm})]})]})})}function Zm(t){let e=t.projectStore.useState(n=>{var c;return((c=n.resourceLimits)==null?void 0:c.searchablePages)||null}),o=Tt("TreeStore",()=>!!t.treeStore.treeIndex.searchComponentNodeIds.size),r=Tt("Tree",()=>Za(t));return{show:o&&e!==null&&r>e,limit:e}}var jd=g(_());var Bo=g(_());var Sf=mt("app");function Ym(t,e){var S;let o=e.treeVersion||0,r=((S=s.remoteDocument)==null?void 0:S.treeVersion())||0,i=o!==0&&r!==0,n=i&&o!==r,[c,m]=Bo.default.useState(n),[l,p]=Bo.default.useState([]),[a,u]=Bo.default.useState(!1),v=ko(()=>new AbortController),w=Bo.default.useCallback(()=>{v.abort(),p([]),u(!1),m(!1)},[v]);return Bo.default.useEffect(()=>(n&&wf(s.tree,t,o,r,v.signal).then(U=>p(U)).catch(U=>{U.name!=="AbortError"&&(Sf.reportError(U),u(!0))}).finally(()=>m(!1)),()=>{v.abort()}),[]),{isEnabled:i,isLoadingChanges:c,hasChanges:l.length>0,hasError:a,changes:l,resetChanges:w}}function Cf(){return{fetchingApiMs:0,computingMs:0,totalMs:0}}function Pf(t){return typeof t=="object"&&t!==null&&"diffs"in t&&typeof t.diffs=="object"}async function wf(t,e,o,r,i){let n=new $a(Cf()),c=n.time("totalMs"),m=n.time("fetchingApiMs"),{diffs:l}=await Ef(e,o,r,i);m.done();let p=n.time("computingMs"),a=If(t,l);p.done(),c.done();let u=n.get();return q("changelog",{projectId:e,...u}),a}function If(t,e){var n;if(Object.entries(e).length===0)return[];let o={["WebPage"]:[],["SmartComponent"]:[],["CollectionItem"]:[]},r;for(let c of Object.values(e)){if(((n=c.to)==null?void 0:n.__class)!=="RootNode")continue;let m=Ko(c.to);ce(Ds(m),"Expected RootNode to deserialize as RootNode"),r=m}ce(r,"Expected RootNode to be in diffs");for(let c of Object.values(e)){let m=c.to||c.from;if(!m)continue;let l=Ko(m,m.parentid);if(!l)continue;let p=kf(t,l,e,r);if(!p)continue;let a=Tf(c);a!==void 0&&o[p.type].push({type:p.type,nodeId:l.id,name:p.name,status:a,userIds:new Set(c.userIds)})}let i=[];for(let[c,m]of Object.entries(o))m.sort(c==="WebPage"?Mf:Jm),i.push(...m);return i}function kf(t,e,o,r){var i,n,c;if(_s(e)){let m=t.get(e.webPageId);m&&!(m.id in o)&&(e=m)}if(Ar(e)){let m=r.homePageNodeId;return{type:"WebPage",name:e.id===m?"Home":Ws(t,e)||$s(t,e)||mo(e)}}else{if(Ut(e))return{type:"SmartComponent",name:e.name||mo(e)};if(Rr(e)){ce(e.parentid,"Expected CollectionItemNode to have parentid");let m=((i=o[e.parentid])==null?void 0:i.to)||((n=o[e.parentid])==null?void 0:n.from);ce(m,"Expected CollectionItemNode's parent to exist in the diffs map");let l=Ko(m,m.parentid);ce(Bs(l),"Expected CollectionItemNode's parent to be a CollectionNode");let p=l.name||mo(l),a=l.variables.find(w=>w.type==="slug"),u=a&&((c=e.getControlProp(a.id))==null?void 0:c.value);return{type:"CollectionItem",name:ut(u)?`${p}/${u}`:`${p}/Item`}}}}function Tf(t){return _i(t.from)?_i(t.to)?0:2:_i(t.to)?1:void 0}function _i(t){if(!t)return!1;let e=Ko(t,t.parentid);return e?!(Zs(e)&&e.isDraft):!1}function Jm(t,e){return t.name.localeCompare(e.name,void 0,{sensitivity:"base"})}function Mf(t,e){return t.name==="Home"&&e.name==="Home"?0:t.name==="Home"?-1:e.name==="Home"?1:Jm(t,e)}async function Ef(t,e,o,r){let i=await Ha(`/projects/${t}/tree/v2/changes/${e}-${o}`,{signal:r});if(!i.ok)throw new Error(`Non-OK HTTP response: ${i.status}`);let n=await i.json();if(Pf(n))return n;throw new Error("Invalid response format")}var rd=g(_());var Xm="container_c1ei30bi",Vi="removed_rg4mzjt",Qm="icon_i1rud32t",ed="name_nauun69",td="nameLink_n8oy0xx",od="avatarList_a1mis7ef";var de=g(N()),nd=rd.default.memo(function({changes:e}){let{isDarkMode:o}=Se(),{acl:r}=s.projectStore.useState();return(0,de.jsx)(ga,{className:Xm,children:(0,de.jsx)(F,{children:e.map((i,n)=>(0,de.jsx)(xf,{change:i,acl:r,isDarkMode:o},n))})})}),Rf=3,jf={["WebPage"]:(0,de.jsx)(ia,{}),["SmartComponent"]:(0,de.jsx)(aa,{width:"12",height:"12"}),["CollectionItem"]:(0,de.jsx)(la,{})};function xf({change:t,acl:e,isDarkMode:o}){let r=e.filter(i=>t.userIds.has(i.user.id));return(0,de.jsxs)(F,{direction:"row",alignItems:"center",children:[(0,de.jsx)("div",{className:V(Qm,t.status===2&&Vi),children:jf[t.type]}),(0,de.jsx)(F,{direction:"row",alignItems:"center",className:ed,children:Lf(t)}),(0,de.jsx)("div",{className:od,children:(0,de.jsx)(Sa,{entries:r,isDarkMode:o,maxAvatars:Rf,size:"small",ignoreStatus:!0})})]})}function Lf(t){let e=t.status===2?(0,de.jsx)("span",{className:V(Vi,ne),children:t.name}):(0,de.jsx)(yo,{onClick:()=>Ff(t.nodeId),className:V(ne,td),children:t.name}),o;return t.status===1?o=(0,de.jsx)(Zo,{children:"NEW"}):t.status===2&&(o=(0,de.jsx)(Zo,{variant:"neutral",children:"REMOVED"})),(0,de.jsxs)(de.Fragment,{children:[e,(0,de.jsx)(F,{direction:"row",gap:4,children:o})]})}function Ff(t){let e=s.tree.getNode(t);e&&(qs(e)?s.scopeStore.select(e.id):Rr(e)&&(s.scopeStore.select(jr),s.selection.set(e.id)))}function id({permissions:t,stagingEnabled:e,upsellPublishMultiPageSite:o}){if(!(e?t.canPublishToStaging:t.canPublish))return{buttonLabel:"No permissions to update",tooltipText:e&&!t.canPublishToStaging?"You need at least one assigned role to deploy to the staged site":"You do not have permission to deploy to the live site"};if(o)return{buttonLabel:"Exceeded page limit",tooltipText:"The Mini plan only allows a /home page and a /404 page. Upgrade your plan or delete all other web pages to update your site."}}var _o=g(_());var sd="icon_i56tfwf",ad="nameLink_nya0ulq",cd="name_n1fnyb8q",ld="caret_ckyq5g1",pd="divider_d9j2n2q",md="title_t1bd5rpr";var ue=g(N());function Nf(){let[t,e]=(0,_o.useState)(()=>s.codeGenerationStore.isIdle());return(0,_o.useEffect)(()=>{if(t)return;let o=setInterval(()=>{if(s.codeGenerationStore.isIdle())return e(!0)},1e3);return()=>clearInterval(o)},[t]),t}function Df(t,e){return e.visible===!1&&t.getReplicaVariants().every(o=>{var r;return((r=s.tree.get(Vs(o.id,e.id)))==null?void 0:r.visible)===!1})}function Of(t){switch(t){case"form":case"component":return!0;case"code-generation":return!1;default:pe(t)}}function Bf(t){return t.moduleIdentifier?"component":t.type==="Form"?"form":"code-generation"}function _f(t,e){let o=[];for(let{node:r,skipChildren:i}of t.getPrimaryVariant().walkWithSkipChildren())if(!(!Os(r)||zt.componentForIdentifier(r.codeComponentIdentifier)||e.has(r.codeComponentIdentifier))){if(Df(t,r)){i();continue}e.add(r.codeComponentIdentifier),o.push({type:"component",nodeId:r.id,scopeId:t.id,moduleIdentifier:Ss(r.codeComponentIdentifier)?r.codeComponentIdentifier:void 0})}return o}function Vf(){var r,i;let t=new Set,e=[],o=new Set;return(i=(r=s.tree.get(Ys))==null?void 0:r.children)==null||i.forEach(n=>{if(t.has(n.nodeId)||o.has(n.moduleIdentifier)||!n.nodeId||!n.scopeId||!s.tree.get(n.scopeId)||!s.tree.get(n.nodeId))return;let m=Bf(n);Of(m)&&(e.push({type:m,nodeId:n.nodeId,scopeId:n.scopeId,moduleIdentifier:n.moduleIdentifier}),o.add(n.moduleIdentifier),t.add(n.nodeId))}),zt.componentIdentifiers().forEach(n=>{if(!zt.errorForIdentifier(n)||o.has(n))return;let m=Go(n);if(Tr(m)&&(m.type==="screen"||m.type==="canvasComponent")){let l=s.tree.get(m.localIdName);if(Ar(l)||Ut(l)){let p=_f(l,o);if(e.push(...p),p.length>0)return}}}),e}function qf(t,e){return o=>{switch(o.type){case"form":return e;default:return t}}}var Hf=["Tree","ActiveBundle"];function dd(){let t=Ft("codeGenerationPublishErrors"),e=Ft("forms"),o=Nf(),r=Tt(Hf,Vf),i=t&&e?r:r.filter(qf(t,e));return!o||i.length===0?null:(0,ue.jsxs)(ue.Fragment,{children:[(0,ue.jsx)("div",{className:pd}),(0,ue.jsx)(F,{direction:"row",justifyContent:"space-between",children:(0,ue.jsxs)("span",{className:md,children:[i.length," ",i.length===1?"Error":"Errors"]})}),(0,ue.jsx)(F,{children:i.map((n,c)=>(0,ue.jsx)(Wf,{scopeId:n.scopeId,nodeId:n.nodeId,type:n.type},c))})]})}function Wf({nodeId:t,scopeId:e,type:o}){let r=(0,_o.useCallback)(()=>{let i=s.tree.get(t);if(!i||!e)return;s.scopeStore.select(e),s.selection.set(t);let n=s.tree.getCanvasBoundingRectCached(i);s.canvasStore.scrollToVisible(n),setTimeout(()=>{_a({id:Kf(o),flash:!0})},250)},[t,o,e]);return(0,ue.jsxs)(F,{direction:"row",alignItems:"center",onClick:r,children:[(0,ue.jsx)("div",{className:V(sd),children:zf(o)}),(0,ue.jsx)(yo,{onClick:r,className:V(ne,ad),children:(0,ue.jsx)(F,{direction:"row",alignItems:"center",className:cd,children:Zf(o,e)})}),(0,ue.jsx)("div",{className:ld,children:(0,ue.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",children:(0,ue.jsx)("path",{d:"M 4 2.5 L 7.5 6 L 4 9.5",fill:"transparent",strokeWidth:"1.5",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round"})})})]})}var $f=(0,ue.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",children:(0,ue.jsx)("path",{d:"M 1 3 C 1 1.895 1.895 1 3 1 L 9 1 C 10.105 1 11 1.895 11 3 L 11 9 C 11 10.105 10.105 11 9 11 L 3 11 C 1.895 11 1 10.105 1 9 Z M 3 4 C 3 4.552 3.448 5 4 5 L 8 5 C 8.552 5 9 4.552 9 4 C 9 3.448 8.552 3 8 3 L 4 3 C 3.448 3 3 3.448 3 4 Z M 3 8 C 3 8.552 3.448 9 4 9 L 8 9 C 8.552 9 9 8.552 9 8 C 9 7.448 8.552 7 8 7 L 4 7 C 3.448 7 3 7.448 3 8 Z",fill:"currentColor"})}),Gf=(0,ue.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"11",children:(0,ue.jsx)("path",{d:"M 0 1.5 C 0 0.672 0.672 0 1.5 0 L 3.75 0 L 3.75 3.75 L 0 3.75 Z M 3.75 8.5 L 1.5 8.5 C 0.672 8.5 0 7.828 0 7 L 0 4.75 L 3.75 4.75 Z M 7 0 C 7.828 0 8.5 0.672 8.5 1.5 L 8.5 3.75 L 4.75 3.75 L 4.75 0 Z M 8.5 7 C 8.5 7.828 7.828 8.5 7 8.5 L 4.75 8.5 L 4.75 4.75 L 8.5 4.75 Z",transform:"translate(1.25 1.25) rotate(45 4.25 4.25)",fill:"currentColor"})});function zf(t){switch(t){case"component":case"code-generation":return Gf;case"form":return $f;default:pe(t)}}function Kf(t){switch(t){case"component":case"code-generation":return"code-component-panel";case"form":return"form-panel";default:pe(t)}}function Zf(t,e){var i;let o=s.tree.get(e);ce(o,"PublishErrors: Error should have a scope node.");let r=(i=o==null?void 0:o.name)!=null?i:mo(o);switch(t){case"component":case"code-generation":return`${r} Component`;case"form":return`${r} Form`;default:pe(t)}}var ud="container_c70v5i5",vr="title_t1m6d3um",Dn="button_ba9eeph",fd="tooltip_tklurhb",gd="site_sg8hahu",yd="icon_i7ed8wv",hd="hostname_h42o8li",vd="link_l1agk2wg",bd="description_d1854po0",qi="info_i1p0yt0i",Hi="infoHover_ishjax2",Sd="warning_w1gzj9e3",Cd="warningHover_w15kuguu",Wi="divider_d1q39ypx",Pd="changeLogTitleLoading_c1exh9nz",wd="infoCard_itq4iqk",Id="infoCardTitle_irnc4ju",kd="iconWrapper_i16wl99r",Td="infoCardCopy_i1kdm6pf";var Md=g(_());var bt=g(N()),$i="search-upsell";function Ed({searchIndexingUpsell:t,onClose:e}){let{project:o}=s.projectStore.useState();Is(o,"Project should exist in upsell modal");let{updatePurchaseOrigin:r}=Pc(),i=Qo(()=>{e(),r($i,{projectId:o.id,site:o.license.type,team:o.teamLicenseType},null),q("ui_interaction",{page:$i,id:"confirm-upsell"}),s.publishStore.handleSearchLimitUpsell(s,t.limit)},[e,t.limit,r,o]);return(0,Md.useEffect)(()=>{q("ui_impression",{page:$i})},[]),(0,bt.jsxs)(F,{className:wd,gap:15,padding:"20px 15px",alignItems:"center",children:[(0,bt.jsx)("div",{className:kd,children:(0,bt.jsx)(Lr,{})}),(0,bt.jsxs)(F,{gap:4,paddingTop:5,alignItems:"center",children:[(0,bt.jsx)("h6",{className:V(vr,Id),children:"Search limit reached"}),(0,bt.jsxs)("div",{className:Td,children:[`You have more than ${t.limit} page${t.limit===1?"":"s"},`,(0,bt.jsx)("br",{}),"site search will be disabled."]})]}),(0,bt.jsx)(J,{variant:"link",bold:!0,onClick:i,children:"Upgrade"})]})}var Ad=g(_());var te=g(N());function Jf(t,e){if(t.status==="invalid_dns")return{tooltipText:"Invalid DNS"};if(Ca(e.status))return{tooltipText:"Optimization issues"}}function Gi({hostname:t,deployment:e,displayMinimalUI:o,isLatest:r,isPending:i,isOptimizing:n,onOpenVersion:c,onOpenPendingDomain:m,onOpenWarning:l}){let p=Jf(t,e),a=Ad.default.useRef(null),{triggerProps:u,tooltipProps:v}=Nr({interactive:!0,disabled:!(p!=null&&p.tooltipText),triggerRef:a}),w=()=>{q("ui_interaction",{page:"publish-popover",id:t.type==="custom"?"open-custom-link":"open-published-link"})};return(0,te.jsxs)("div",{className:gd,children:[(0,te.jsx)("div",{className:yd,children:(0,te.jsx)(sa,{})}),(0,te.jsx)("div",{className:V(hd,ne),children:(0,te.jsx)(yo,{href:zr(s,t.hostname),onMouseDown:w,className:vd,children:t.hostname})}),(0,te.jsxs)("div",{className:bd,children:[i&&(0,te.jsx)("span",{className:V(qi,!o&&Hi),onClick:m,children:(0,te.jsx)(k,{children:"Pending Connection\u2026"})}),!i&&(0,te.jsxs)(te.Fragment,{children:[(0,te.jsxs)("span",{className:V(qi,!o&&Hi),onClick:c,children:[(0,te.jsx)(k,{children:"Updated"})," ",(0,te.jsx)(Xf,{isoTimestamp:e.createdAt}),!r&&(0,te.jsxs)(te.Fragment,{children:[" (",t.deploymentId,")"]})]}),r&&(0,te.jsxs)("span",{children:[" \xB7 ",e.deployedBy.name]}),p&&(0,te.jsxs)(te.Fragment,{children:[(0,te.jsx)("span",{children:" \xB7 "}),(0,te.jsx)("span",{ref:a,...u,className:V(Sd,!o&&Cd),onClick:l,children:(0,te.jsx)(k,{children:"Warning"})}),(0,te.jsx)(Dr,{...v,children:p.tooltipText})]}),!p&&n&&(0,te.jsxs)(te.Fragment,{children:[(0,te.jsx)("span",{children:" \xB7 "}),(0,te.jsx)(k,{children:"Optimizing..."})]})]})]})]})}function Xf({isoTimestamp:t}){return(0,te.jsx)("time",{dateTime:t,title:gc(t),children:ha(ya(t),{addSuffix:!0})})}var Ye=g(_());var Ee=g(N());function Rd({enabled:t,onClick:e,onSuccess:o,publishStatus:r,infoTooltip:i}){let[n,c]=(0,Ye.useState)(),m=(0,Ye.useRef)();(0,Ye.useEffect)(()=>()=>{m.current&&window.clearTimeout(m.current)},[]);let l=(0,Ye.useCallback)(async()=>{let S=await e();c(S?0:1),S&&o(),m.current&&window.clearTimeout(m.current),m.current=window.setTimeout(()=>c(void 0),2e3)},[e,o]),{label:p,content:a}=(0,Ye.useMemo)(()=>{if(i)return{label:i.buttonLabel,content:(0,Ee.jsxs)(F,{justifyContent:"center",alignItems:"center",direction:"row",gap:8,children:[(0,Ee.jsx)(Lr,{}),(0,Ee.jsx)(k,{children:i.buttonLabel})]})};if(n===0){let S="Updated";return{label:S,content:(0,Ee.jsxs)(F,{gap:3,direction:"row",justifyContent:"center",alignItems:"center",children:[(0,Ee.jsx)(pa,{children:(0,Ee.jsx)(na,{})}),(0,Ee.jsx)(k,{children:S})]})}}else return n===1?{label:"Update failed",content:(0,Ee.jsx)(k,{children:"Update failed"})}:r===3?{label:"Publishing\u2026",content:(0,Ee.jsx)(ot,{})}:r===2?{label:"Update",content:(0,Ee.jsx)(k,{children:"Update"})}:{label:"Publish",content:(0,Ee.jsx)(k,{children:"Publish"})}},[n,r,i]),u=Ye.default.useRef(null),{triggerProps:v,tooltipProps:w}=Nr({className:fd,direction:"right",disabled:!i,triggerRef:u});return(0,Ee.jsxs)("div",{ref:u,...v,children:[(0,Ee.jsx)(J,{variant:"withDepthPrimary",large:!0,title:p,enabled:t,onClick:l,className:Dn,children:a}),(0,Ee.jsx)(Dr,{...w,children:i==null?void 0:i.tooltipText})]})}var ie=g(N());function xd({projectId:t,canPublish:e,onPublish:o,publishStatus:r,onClose:i,defaultHostname:n,customHostname:c,defaultHostnameDeployment:m,customHostnameDeployment:l,deploymentStrategy:p}){return!n||!m||!p?null:(0,ie.jsx)(eg,{projectId:t,canPublish:e,onPublish:o,publishStatus:r,onClose:i,defaultHostname:n,customHostname:c,defaultHostnameDeployment:m,customHostnameDeployment:l,deploymentStrategy:p})}var Qf="publish-popover";function eg({projectId:t,canPublish:e,onPublish:o,publishStatus:r,onClose:i,defaultHostname:n,customHostname:c,defaultHostnameDeployment:m,customHostnameDeployment:l,deploymentStrategy:p}){let{isEnabled:a,isLoadingChanges:u,hasChanges:v,hasError:w,changes:S,resetChanges:U}=Ym(t,m),f=Ft("codeGenerationErrorTracking"),y=Ft("forms"),b=f||y,P=Qo(()=>{s.chromeStore.displayMinimalUI||(i(),s.siteSettings.setActiveTab({tab:"domains"}).catch(O))},[i]),A=Qo(()=>{s.chromeStore.displayMinimalUI||(i(),s.siteSettings.setActiveTab({tab:"versions"}).catch(O))},[i]),M=ti(m.status);(0,jd.useEffect)(()=>{q("ui_impression",{page:Qf})},[]);let R=Xr(),h=Ya(s,Tt),T=Zm(s),j=c&&l,D=p==="manual",W=id({permissions:R,stagingEnabled:!!j&&D,upsellPublishMultiPageSite:h}),$=(0,ie.jsx)(Rd,{onClick:o,onSuccess:U,enabled:e&&!h,publishStatus:r,infoTooltip:W});return(0,ie.jsxs)(F,{padding:15,gap:15,className:ud,children:[(0,ie.jsx)("span",{className:vr,children:"Domains"}),(0,ie.jsx)(Gi,{hostname:n,deployment:m,displayMinimalUI:s.chromeStore.displayMinimalUI,isLatest:!0,isOptimizing:M,onOpenVersion:A,onOpenPendingDomain:P,onOpenWarning:P}),j&&D&&$,j&&(0,ie.jsx)(Gi,{hostname:c,deployment:l,displayMinimalUI:s.chromeStore.displayMinimalUI,isLatest:c.deploymentId===n.deploymentId,isPending:c.status!=="active",isOptimizing:ti(l.status),onOpenVersion:A,onOpenPendingDomain:P,onOpenWarning:P}),(!j||!D)&&(0,ie.jsxs)(F,{gap:10,children:[!j&&!s.siteSettings.isOpen&&!s.chromeStore.displayMinimalUI&&(0,ie.jsx)(J,{large:!0,className:Dn,onClick:P,children:(0,ie.jsx)(k,{children:"Add Custom Domain"})}),$]}),T.show?(0,ie.jsxs)(ie.Fragment,{children:[(0,ie.jsx)("div",{className:Wi}),(0,ie.jsx)(Ed,{searchIndexingUpsell:T,onClose:i})]}):a&&(0,ie.jsxs)(ie.Fragment,{children:[(0,ie.jsx)("div",{className:Wi}),(0,ie.jsxs)(F,{direction:"row",justifyContent:"space-between",children:[(0,ie.jsx)("span",{className:V(vr,u&&Pd),children:u?"Loading Changes...":w?"Error Loading Changes":`${S.length} ${S.length===1?"Change":"Changes"}`}),u&&(0,ie.jsx)(ot,{inline:!0})]}),!u&&v&&(0,ie.jsx)(nd,{changes:S})]}),b&&(0,ie.jsx)(dd,{})]})}var Je=g(N());function Ld({canPublish:t,user:e,projectState:o,activePopover:r,onActivePopoverChange:i,onAccessChange:n,onCopyProjectURL:c,onShowMoveProjectMenu:m,onConfirmMoveProject:l,moveProjectDestination:p,onPublish:a,publishStatus:u,defaultHostname:v,customHostname:w,defaultHostnameDeployment:S,customHostnameDeployment:U,deploymentStrategy:f,onUpgradePlan:y}){let b=(0,Vo.useRef)(null),{id:P,space:A}=o.project,M=(0,Vo.useMemo)(()=>{let oe=e.spaces.find(Q=>Q.id===A.id);return be(oe)?oe.license:null},[A.id,e.spaces]),R=document.getElementById("toolbar-invite-button"),h=document.getElementById("toolbar-publish-button");function T(){i(0)}let j=(0,Vo.useCallback)(()=>{u!==3&&i(0)},[u,i]),D=Oe(o.project.space),W=e.id===o.project.owner.id,$=D&&W,Z=Kt("sites"),he=rn(),Y=!Z||!he,De=r===2&&(M==null?void 0:M.type)!=="enterprise";return(0,Je.jsx)(ma,{ref:b,className:jc,children:(0,Je.jsxs)(el,{shouldFetch:De,teamId:A.ownerId,children:[r===2&&(0,Je.jsx)(Fr,{className:on,anchor:Z?R:b.current,alignSelf:Z?"center":"end",attachTo:"bottom",offset:Z?{x:0,y:oa.tooltipArrowHeight+1}:{x:15,y:-5},arrow:{anchor:R,alignSelf:"center"},onClose:T,children:$?(0,Je.jsx)(Wp,{user:e,projectState:o,onShowMoveProjectMenu:m,onConfirmMoveProject:l,moveProjectDestination:p}):Y?(0,Je.jsx)(Km,{user:e,projectState:o,isDraftProject:D,isCurrentUserOwner:W,onAccessChange:n,onCopyProjectURL:c}):(0,Je.jsx)(wm,{user:e,projectState:o,isDraftProject:D,isCurrentUserOwner:W,onAccessChange:n,onCopyProjectURL:c})}),r===4&&(0,Je.jsx)(Fr,{className:on,anchor:b.current,alignSelf:"end",attachTo:"bottom",offset:{x:15,y:-5},arrow:{anchor:h,alignSelf:"center"},onClose:j,children:(0,Je.jsx)(xd,{projectId:P,canPublish:t,onPublish:a,publishStatus:u,onClose:T,defaultHostname:v,customHostname:w,defaultHostnameDeployment:S,customHostnameDeployment:U,deploymentStrategy:f})}),r===1&&(0,Je.jsx)(Fr,{className:on,anchor:b.current,alignSelf:"end",attachTo:"bottom",offset:{x:15,y:-5},arrow:{anchor:h,alignSelf:"center"},backdropEnabled:!1,focusTrapEnabled:!1,children:(0,Je.jsx)(Np,{canPublish:t,publishStatus:u,onPublish:a,onDismiss:T})})]})})}var so=g(_());function Fd({isUserPartOfTeam:t,api:e,projectTeamId:o,autoJoinDefaultRole:r}){let[i,n]=so.default.useState(),[c,m]=so.default.useState(!0),[l,p]=so.default.useState(!1),[a,u]=Zr("recommended-teams-joined-pending-welcome-modal",[]),v=r==="editor"?"an Editor":`a ${Ns(r)}`,w=so.default.useCallback(async()=>{if(i)try{q("ui_interaction",{page:"canvas-autojoin-toast",id:"joinTeam"}),p(!0),await ol({teamId:i.id,source:"recommended-canvas"}),u(S=>[...S,i.id]),p(!1),n(void 0),E({variant:"success",key:"joined-team-sucess",icon:"success",text:`You have joined the ${i.displayName} team as ${v}`,type:"add"})}catch{E({variant:"error",key:"joined-team-error",icon:"error",text:"Failed to join team",type:"add"})}},[i,u,v]);return so.default.useEffect(()=>{let S=!0;if(t){m(!1);return}return tl().then(U=>{if(!S)return;let f=U.find(({id:y})=>o===y);f&&n(f),m(!1)}).catch(()=>{}),()=>{S=!1}},[t,e,o]),so.default.useEffect(()=>{let S="recommended-team";i?(q("ui_impression",{page:"canvas-autojoin-toast"}),E({variant:"info",key:S,text:`Join the ${i.displayName} team as ${v}`,action:{onClick:w,title:"Join"},styleOverride:"fallback-tool",permanent:!!i||l,type:"add",icon:"view-only",duration:1/0})):E({type:"remove",key:S})}),{isShowingRecommendedTeamToast:c||!!i}}var We=g(_());var Dd=g(_());var Ud="description_d1mpdoho",zi="resource_rbg65ev",Nd="divider_d1m3gl5g",Ki="icon_i5ixusr";var X=g(N()),rg="request-editor-access";function Od({space:t,projectAccessStatus:e,teamAccessStatus:o,onRequestProjectEditAccess:r,onRequestTeamEditAccess:i,onDismiss:n,showRequestTeamEditorAccess:c}){return(0,Dd.useEffect)(()=>{q("ui_impression",{page:rg})},[]),(t==null?void 0:t.scope)!=="organization"?null:(0,X.jsx)(Dt,{visible:!0,onDismiss:n,children:(0,X.jsxs)(F,{gap:15,children:[(0,X.jsxs)(F,{gap:20,children:[(0,X.jsx)(ye,{className:Ot.title,children:(0,X.jsx)(k,{children:"Request Edit Access"})}),(0,X.jsxs)(ye,{className:Ud,children:[(0,X.jsx)(k,{children:"You are currently a viewer in this project."}),(0,X.jsx)("br",{}),(0,X.jsx)(k,{children:"Request edit access below."})]})]}),(0,X.jsx)("hr",{className:Nd}),(0,X.jsxs)(F,{gap:15,children:[(0,X.jsxs)(F,{direction:"row",gap:0,justifyContent:"space-between",children:[(0,X.jsxs)(F,{direction:"row",gap:10,justifyContent:"center",alignItems:"center",children:[(0,X.jsx)(F,{className:Ki,justifyContent:"center",alignItems:"center",children:(0,X.jsx)(ng,{})}),(0,X.jsx)(ye,{className:zi,children:(0,X.jsx)(k,{children:"This Project"})})]}),(0,X.jsx)(J,{large:!0,variant:"primary",title:"Request Access",onClick:r,enabled:e!=="pending"&&e!=="loading",children:(0,X.jsx)(k,{children:e==="pending"?"Pending":"Request"})})]}),t&&c&&(0,X.jsxs)(F,{direction:"row",gap:0,justifyContent:"space-between",children:[(0,X.jsxs)(F,{direction:"row",gap:10,justifyContent:"center",alignItems:"center",children:[(0,X.jsx)(F,{className:Ki,justifyContent:"center",alignItems:"center",children:(0,X.jsx)(rl,{avatar:null,displayName:t.displayName,organization:null})}),(0,X.jsx)(ye,{className:zi,children:(0,X.jsx)(k,{children:"All Projects in Workspace"})})]}),(0,X.jsx)(J,{large:!0,variant:"primary",title:"Request Access",onClick:i,enabled:o!=="pending"&&o!=="loading",children:(0,X.jsx)(k,{children:o==="pending"?"Pending":"Request"})})]})]})]})})}function ng(){return(0,X.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",children:(0,X.jsx)("path",{d:"M 9.828 3.343 C 10.024 3.148 10.34 3.148 10.536 3.343 L 12.657 5.464 C 12.852 5.66 12.852 5.976 12.657 6.172 L 6.26 12.568 C 6.051 12.777 5.784 12.92 5.494 12.978 L 3.139 13.449 C 2.789 13.519 2.481 13.211 2.551 12.861 L 3.022 10.506 C 3.08 10.216 3.223 9.949 3.432 9.74 Z M 11.939 1.232 C 12.135 1.037 12.451 1.037 12.646 1.232 L 14.768 3.354 C 14.963 3.549 14.963 3.865 14.768 4.061 L 14.061 4.768 C 13.865 4.963 13.549 4.963 13.354 4.768 L 11.232 2.646 C 11.037 2.451 11.037 2.135 11.232 1.939 Z",fill:"currentColor"})})}var _d=g(N()),Bn=Mc(E);function ig({isUserPartOfTeam:t,isUserEditorInTeam:e}){return t&&!e}function Bd({project:t,isUserPartOfTeam:e,isUserEditorInTeam:o,toastKey:r,api:i}){let[n,c]=(0,We.useState)(!1),[m,l]=(0,We.useState)(),[p,a]=(0,We.useState)(),u=Oe(t.space),v=(0,We.useMemo)(()=>u?"Dismiss":e&&p==="pending"||!e&&m==="pending"?"Request Pending":"Request Access",[e,u,m,p]),w=(0,We.useCallback)(async()=>{q("ui_interaction",{page:"request-editor-access",id:"request-project-editor-access"});try{l("loading");let{status:f}=await i.requestAccess({resourceType:"project",resourceId:t.id});l(f),Bn.projectSuccess()}catch{l(void 0),Bn.projectError()}},[t.id,i]),S=(0,We.useCallback)(async()=>{if(t.space.displayName){q("ui_interaction",{page:"request-editor-access",id:"request-team-editor-access"});try{a("loading");let{status:f}=await i.requestAccess({resourceType:"team",resourceId:t.space.ownerId});a(f),l(f),Bn.teamSuccess(t.space.displayName)}catch{a(void 0),Bn.teamError(t.space.displayName)}}},[t.space.displayName,t.space.ownerId,i]);return(0,We.useEffect)(()=>{if(!r)return;E({variant:"info",key:r,text:"You do not have editing rights for this project",action:u?void 0:{title:v,onClick:()=>{c(!0)}},permanent:!u,styleOverride:u?void 0:"request-editor-access",showCloseButton:u?"auto":"never",type:"add",icon:"view-only",duration:1/0})},[r,v,u]),(0,We.useEffect)(()=>{if(!r)return;let f=!0;return(async()=>{try{let{accessRequests:y}=await sg(t.id);if(!f)return;y.team&&e&&(a(y.team.status),l(y.team.status)),y.project&&l(y.project.status)}catch(y){O(y)}})(),()=>{f=!1}},[r,t.id,e,i]),(0,We.useMemo)(()=>!n||t.space.scope!=="organization"?null:(0,_d.jsx)(Od,{projectAccessStatus:m,teamAccessStatus:p,onRequestProjectEditAccess:w,onRequestTeamEditAccess:S,showRequestTeamEditorAccess:ig({isUserPartOfTeam:e,isUserEditorInTeam:o}),space:t.space,onDismiss:()=>{c(!1)}}),[w,S,n,t.space,m,p,e,o])}function sg(t){return gt.get(`/web/access-requests/projects/${t}`)}var Vd=g(_());function qd({shouldShowToast:t,accessRequests:e,onReviewRequests:o}){(0,Vd.useEffect)(()=>{let r="review-editor-access";e.length>0&&t?E({key:r,type:"add",variant:"info",text:e.length===1?"1 viewer is requesting access to edit this project":`${e.length} viewers are requesting access to edit this project`,permanent:!0,showCloseButton:"auto",icon:"view-only",duration:1/0,action:{title:"Review",onClick:o}}):E({key:r,type:"remove"})},[e,o,t])}var Hd=g(_());function Wd({disabled:t}){let e="missing-permissions",o=s.scopeStore.useState(u=>u.active.id===jr),r=s.siteSettings.useState(u=>u.active),i=o?"CMS":r?"SiteSettings":"Canvas",n=Xr(),c=i==="Canvas"&&!n.canDesign||i==="CMS"&&!n.canEditContent||i==="SiteSettings"&&!n.canEditSiteSettings,m=Kt("sites"),l=rn(),a=!t&&m&&l&&c;Hd.default.useEffect(()=>{a?E({type:"add",key:e,variant:"info",text:ag(i),permanent:!0,icon:"view-only",duration:1/0}):E({type:"remove",key:e})},[e,a,i])}function ag(t){switch(t){case"Canvas":return"You do not have design editing rights";case"CMS":return"You do not have content editing rights";case"SiteSettings":return"You don\u2019t have enough permissions to edit these settings";default:pe(t,"All sections should have a toast text")}}var ke=g(N()),cg=mt("projectHandlers"),lg=(0,G.lazy)(()=>import("https://app.framerstatic.com/AccountSettingsModal-6D4CHGMK.js")),pg=(0,G.lazy)(()=>import("https://app.framerstatic.com/TeamCreationModal-4SD3HGFL.js")),$d=t=>Zc(t,21),mg=typeof window!="undefined"&&!$r()?bp(window.location):null,dg=s.wrapHandler(t=>s.publishStore.publish(s,t));function Gd({projectState:t,initialUser:e,api:o,assetService:r,filePickerRef:i}){var ns;let{project:n}=t;(0,G.useEffect)(()=>{s.processWhenReady(()=>{s.projectStore.project=n})},[n]);let[c,m]=(0,G.useState)(!1),[l,p]=(0,G.useState)(!1),a=Lc(po().api,e),{user:u}=a,[v,w]=(0,G.useState)(!1),[S,U]=(0,G.useState)(null),[f,y]=(0,G.useState)(null),[b,P]=(0,G.useState)(!1),[A,M]=(0,G.useState)(null),R=(0,G.useCallback)(x=>{s.popover.active=x},[]),{publishStatus:h,defaultHostname:T,customHostname:j,defaultHostnameDeployment:D,customHostnameDeployment:W,deploymentStrategy:$}=s.publishStore.useState(),{active:Z}=s.popover.useState(),he=Ft("previewBreakpointSwitcher"),Y=x=>H=>{H.preventDefault(),H.stopPropagation(),x()},De=Jl(x=>{let H=yt("showPreview");ce(H,"togglePreviewVisible key binding is not set"),x(H,Y(ri),"Toggle Preview");let le=yt("goBack");ce(le,"goBackKeyBinding key binding is not set"),x(le,Y(yc),"Go Back");let Le=yt("goForward");if(ce(Le,"goForwardKeyBinding key binding is not set"),x(Le,Y(hc),"Go Forward"),he){let Pr=yt("previewNextBreakpoint");ce(Pr,"previewNextBreakpoint key binding is not set"),x(Pr,Y(()=>ii(s,1)),"Next Breakpoint");let Lt=yt("previewPreviousBreakpoint");ce(Lt,"previewPreviousBreakpoint key binding is not set"),x(Lt,Y(()=>ii(s,-1)),"Previous Breakpoint")}let et=yt("openFullScreen");ce(et,"openFullScreen key binding is not set"),x(et,Y(()=>Qr().openFullScreen()),"Present Preview");let Gt=yt("toggleHighlightsInLivePreview");ce(Gt,"toggleHighlightsInLivePreview key binding is not set"),x(Gt,Y(()=>s.previewStore.toggleHighlights()),"Show Interaction Highlights");let xt=yt("toggleConsole");ce(xt,"toggleConsole key binding is not set"),x(xt,Y(()=>Qr().toggleConsole()),"Toggle Preview Console");let Ge=yt("reload");ce(Ge,"reload key binding is not set"),x(Ge,Y(()=>Qr().reload()),"Reset Preview"),x("CommandOrControl+S",Y(()=>{Kr()||s.chromeStore.mainView===0&&E({type:"add",variant:"success",icon:"success",text:"Framer automatically saves your work",key:"auto-save-toast"})}),"Save")},[]),oe=s.documentSettings.isNewlyCreatedProject,Q=t.aclById[n.owner.id],fe=Ie.isOn("skipInterstitial"),Ae=((ns=t.aclById[u.id])==null?void 0:ns.role)||n.userRole,$e=Ae==="viewer",ae=Ae==="owner",Pe=Ae==="viewer",[ve,St]=(0,G.useState)(Zt(n)&&!oe);Ie.update(n.canvasFeatures);let I=(0,G.useMemo)(()=>u.spaces.find(x=>x.id===n.space.id),[n.space.id,u.spaces]),z=(0,G.useMemo)(()=>u.spaces.filter(be),[u.spaces]),ge=(0,G.useRef)(!0);(0,G.useEffect)(()=>{if(ge.current){ge.current=!1;return}r.refresh().catch(O)},[I,r]);let Xe=tr(),{canMoveProject:xe,availableCollectionsBySpace:Rt}=Xc({project:n,user:u});ep({channel:Fe,project:n,canMoveProject:xe,onShowMoveProjectMenu:Wn,onShowUpgradeOrTrialModal:qo});function qo(x,H){be(I)&&M({upsell:x,trackingPage:H})}(0,G.useEffect)(()=>{let x=n.settings.featureFlags,H=be(I)?I.license.featureFlags:{};xs(),n.teamExperiments&&It.update(n.teamExperiments),Gr.update({...H,...x})},[I,n.settings,n.teamExperiments]),(0,G.useEffect)(()=>{y(null)},[n.space,n.collection]),(0,G.useEffect)(()=>{s.processWhenReady(()=>{s.chromeStore.isPreviewingFeaturedTemplate=(Q==null?void 0:Q.user.isFramerEmployee)===!0&&fe&&$e})},[fe,Q==null?void 0:Q.user.isFramerEmployee,$e]);let{isPreviewingFeaturedTemplate:Qe}=s.chromeStore.useState(),Ct=$e||n.archived||Qe!==!1||v,ct=s.modalStore.useState(),Ho=(0,G.useRef)(!1);(0,G.useEffect)(()=>{if(n.space.scope==="organization"||Ct||s.modalStore.isVisible())return;if(!u.spaces.some(H=>be(H)&&H.permissions.write)){s.processWhenReady(()=>s.modalStore.set({type:"CreateTeam",source:"automatic"})),Ho.current=!0;return}Ho.current||sn.defaultProjectLocation.then(({defaultTeam:H})=>{if(!(H!=null&&H.spaceId))return;let{displayName:le,spaceId:Le}=H;y({spaceId:Le,destinationLabel:$d(`${le} / All`),spaceName:le})}).catch(cg.reportError).finally(()=>{s.modalStore.set({type:"DeprecatedDrafts",source:"automatic"}),Ho.current=!0})},[Ct,n.space.scope,ct,u.spaces]);let Sr=(Ct||Oe(n.space))&&!$r(),_n=ve&&!$r(),co=Oe(I)&&ae||be(I)&&I.permissions.write&&!$e;async function we(){let[,x]=ft.extract(ni(n.title));q("ui_interaction",{page:"project-menu-bar",id:"archive-project"});try{await o.updateProject({archived:!0},!1),E({type:"add",variant:"success",key:`archive-${n.id}`,text:`Archived ${x}`,icon:"success",duration:3e3})}catch(H){H instanceof kt&&H.status===409&&H.data.reason==="project_has_active_subscription"?E({type:"add",variant:"error",key:`archive-${n.id}-active-subscription-error`,text:"Unable to archive a project with an active subscription. Cancel the subscription and try again.",duration:1/0}):H instanceof kt&&H.status===409&&H.data.reason==="project_has_custom_domain_attached"?E({type:"add",variant:"error",key:`archive-${n.id}-custom-domain-attached-error`,text:"Unable to archive a project with a custom domain attached. Remove the domain and try again.",duration:1/0}):E({type:"add",variant:"error",key:`archive-${n.id}`,text:`Failed to archive ${x}`,icon:"error",duration:3e3}),U(null);return}o.wait(()=>{window.location.href=Co})}function jt(){n.space.scope==="organization"?U(n):we()}let $t=(0,G.useCallback)(async()=>{q("ui_interaction",{page:"canvas-unarchive-toast",id:"unarchive-project"});try{await o.updateProject({archived:!1}),E({type:"add",variant:"success",key:`unarchived-${n.id}`,text:"This project has been unarchived",icon:"success"})}catch{E({type:"add",variant:"error",key:`unarchived-${n.id}`,text:"Failed to unarchive project",icon:"error"})}},[o,n.id]);async function Cr(){q("ui_interaction",{page:"project-menu-bar",id:"save-template-as-project"});let x=`save-as-project-${n.id}`;try{await o.updateProject({type:"default"}),St(!1),E({type:"add",variant:"success",key:x,text:"This project is no longer a template",icon:"success",duration:3e3})}catch{E({type:"add",variant:"error",key:x,text:"This template could not be converted to a project",icon:"error",duration:3e3})}}let Pt="view-only-access",{isShowingRecommendedTeamToast:Kd}=Fd({isUserPartOfTeam:typeof I!="undefined",api:a,projectTeamId:n.space.ownerId,autoJoinDefaultRole:n.settings.featureFlags.canInviteEditors==="on"?n.settings.autoJoinDefaultRole:"viewer"}),Zd=Sr&&!Oe(n.space)&&Pe&&!n.archived&&!Kd&&!Qe?Pt:void 0,Zi=Bd({project:n,isUserPartOfTeam:typeof I!="undefined",isUserEditorInTeam:typeof I!="undefined"&&I.permissions.write,toastKey:Zd,api:o}),Yd=(0,G.useCallback)(()=>{R(2)},[R]);qd({shouldShowToast:Z!==2&&ct.active.type!=="UpgradeTeamPlan",accessRequests:t.accessRequests,onReviewRequests:Yd}),Wd({disabled:Pe||Oe(n.space)});let[Yi,Vn]=(0,G.useState)(null),Ji=er(u,n),qn=G.default.useCallback(async()=>{Ke(ai(n,{sites:!0})),Vn(null)},[n]),Xi=Kt("packages"),Qi=!Kt("codeModules"),Hn=G.default.useCallback(async()=>{let x=[];if(Qi&&x.push("Legacy Code"),Xi&&x.push("Packages"),x.length)Vn({unsupportedFeatures:x});else return qn()},[qn,Xi,Qi]);(0,G.useEffect)(()=>{Sr?v?E({key:Pt,variant:"info",text:"Legacy projects are deprecated and view-only",type:"add",icon:"view-only",duration:1/0,permanent:!0,action:Ji?{title:"Duplicate to edit",onClick:Hn}:void 0}):n.archived?E({key:Pt,variant:"info",text:`This file is archived and view-only. ${co?"Unarchive the file to edit.":""}`,action:co?{title:"Unarchive",onClick:()=>$t()}:void 0,type:"add",icon:"view-only",duration:1/0,permanent:!0}):Qe&&E({key:Pt,type:"add",variant:"prominent-info",icon:"view-only",text:"You\u2019re previewing a view-only version of this template",duration:1/0,permanent:!0,action:{title:"Use Template",onClick:()=>Ke(Cs({duplicateFrom:n.id}))}}):!oe&&_n?E({key:Pt,type:"add",variant:"info",icon:"warning",text:"You\u2019re viewing a template project",duration:1/0,showCloseButton:"never",action:Ct?void 0:{title:"Edit Template",onClick:()=>St(!1)}}):E({key:Pt,type:"remove"})},[Sr,n.archived,$t,co,oe,_n,Ct,n.id,n.space,Qe,v,Hn,Ji]),Kl(ni(n.title));let Jd=kp({channel:Fe});np({user:u,channel:Fe,permissions:{isViewOnly:Ct||ve||Oe(n.space)}});let Xd=Mp({channel:Fe}),{isFeedbackActive:Qd}=vp({vekterChannel:Fe,initialThread:mg});Cp({toast:E,userNotifications:Xd,isFeedbackActive:Qd}),wp({toast:E,isDocumentLoaded:c,action:async x=>x==="subscribe"?o.subscribeToNotifications():o.unsubscribeFromNotifications()}),(0,G.useEffect)(()=>{Ls.init({userId:u.id,appVersion:Qs,projectId:n.id}),s.processWhenReady(()=>{u.id&&(s.documentSettings.currentUserId=u.id),u.email&&(s.documentSettings.currentUserEmail=u.email),u.spaces&&(s.documentSettings.spaces=u.spaces)})},[n.id,u.email,u.id,u.spaces]);let eu=Ql();Ml(x=>{x(xa,()=>{setTimeout(()=>m(!0))}),x(La,async H=>{if(!H)return;let le=`renamed-${n.id}`;try{await o.updateProject({title:H})}catch{E({type:"add",variant:"error",key:le,text:"Failed to update project name",icon:"error"})}})});let tu=G.default.useCallback(async()=>{Wc({insertPanel:!0,spaceId:I==null?void 0:I.id},!0).catch(O)},[I==null?void 0:I.id]),ou=G.default.useCallback(async()=>{Ke(ai(n))},[n]);hp({appMenu:s.chromeStore.displayMinimalUI?gi.mobileWebAppMenu:gi.webAppMenu,archiveProject:jt,onPreviewToggle:ri,filePickerRef:i,openAccountSettings:os,onUploadMediaFilePick:eu,menuActionTargetService:Jd,saveTemplateAsProject:Cr,project:n,toast:E,unarchiveProject:$t,user:u,userCanArchive:co,handleNewProject:tu,handleProjectDuplication:ou,handleDuplicationAsSite:Hn}),ac({globalKeyBindings:De});async function ru(x){q("ui_interaction",{page:"project-menu-bar",id:"change-access"});try{await o.updateProject({publicAccess:x})}catch{E({type:"add",variant:"error",key:`access-change-${n.id}`,text:"Failed to change the access level of this project",icon:"error"})}}function nu(){q("ui_interaction",{page:"project-menu-bar",id:"copy-link"})}function iu(x,H,le=!1){let Le=Po(n,u),et=Le.spaceName.trim(),Gt=x?[{label:`Go to ${et}`,handler:()=>{window.location.href=Le.href}},{type:"separator"}]:[];if(!xe||Ct)return Gt;let xt=[];for(let[Ge,Pr]of Object.entries(Rt)){let{displayName:Lt,collections:pu}=Pr,mu=pu.map(lt=>{var as,cs;let[is,ss]=ft.extract(ka(lt));return{label:ss,handler:()=>{es({spaceId:Ge,destinationLabel:`${Lt} / ${ss}`,collection:lt,spaceName:Lt,skipConfirmation:H})},checked:f&&H?f.spaceId===Ge&&(((as=f.collection)==null?void 0:as.id)===lt.id||!f.collection&&lt.id==="recent"):n.space.id===Ge&&(((cs=n.collection)==null?void 0:cs.id)===lt.id||!n.collection&&lt.id==="recent"),value:{spaceId:Ge,collection:lt},icon:is?{src:is}:void 0}});if(Lt!==""){let lt=$d(Lt);xt.push({label:lt,submenu:mu,checked:f&&H?f.spaceId===Ge:n.space.id===Ge,handler:()=>es({spaceId:Ge,destinationLabel:lt,spaceName:Lt,skipConfirmation:H})})}else xt.push({label:"Drafts",checked:f&&H?f.spaceId===Ge:n.space.id===Ge,disabled:!0,visible:!le})}return[...Gt,{label:"Move to\u2026",disabled:!0},...xt]}async function Wn(x){let{location:H,showBackToDashboardItem:le=!0,skipConfirmation:Le,hideDrafts:et}=x;await Xe({items:iu(le,Le,et),location:H,within:document.body.getBoundingClientRect(),className:`${tp} ${wa}`})}let su=(0,G.useCallback)(()=>{s.siteSettings.setActiveTab({tab:"plans"}).catch(O)},[]),Wo=async({spaceId:x,destinationLabel:H,collection:le,dismissModal:Le=!0})=>{let et=le&&le.id!=="personal"&&le.id!=="recent"?le.id:null,Gt="move-project-toast";try{await o.updateProject({spaceId:x,collectionId:et}),n.space.id!==x&&await o.getACL(),E({type:"add",variant:"success",icon:"success",text:ft.removeFromText(`Project moved to ${H}`),key:Gt})}catch(xt){$c({err:vs(xt),targetTeamId:x,projectId:n.id,projectTitle:n.title,destination:H,onClickOpenPlans:su})}P(!1),Le&&(R(0),s.modalStore.dismiss())};async function es(x){var le,Le,et;let H=(Le=(le=n.collection)==null?void 0:le.id)!=null?Le:"recent";if(!(((et=x.collection)==null?void 0:et.id)===H&&x.spaceId===n.space.id)){if(n.space.id!==x.spaceId){if(y(x),x.skipConfirmation)return;P(!0);return}await Wo(x)}}let ts=()=>{y(null),P(!1)},au=()=>{U(null)};function os(){p(!l)}function cu(x){window.location.href=`${Co}?team=${x.id}&open-settings=1`}let rs=(x,H)=>s.siteSettings.setActiveTab({tab:"plans",upsellSitePlan:x,upsellTeamPlan:H});function lu(){if(!u.isOnLatestTerms)return ct.active.type==="CompleteSignup"?(0,ke.jsx)(zl,{accountApi:a}):(0,ke.jsx)(zc,{fetchMe:a.fetchMe});if(ct.active.type==="DeprecatedDrafts")return(0,ke.jsx)(_l,{user:u,project:n,onShowMoveProjectMenu:Wn,moveProjectDestination:f==null?void 0:f.destinationLabel,onConfirmMoveProject:async()=>{f&&await Wo({...f,dismissModal:!1})},onDismiss:()=>s.modalStore.set({type:"None",source:"automatic"})});if(ct.active.type==="CreateTeam")return(0,ke.jsx)(pg,{api:a,noEditRights:!0,onComplete:async x=>{let H=u.spaces.find(le=>le.ownerId===x);be(H)&&await Wo({spaceId:H.id,destinationLabel:H.displayName,dismissModal:!0})}});if(be(I)&&A)return(0,ke.jsx)(Kc,{canUpgrade:I.permissions.write,teamLicense:I.license,trackingPage:A.trackingPage,upsellType:A.upsell,onDismiss:()=>M(null),onUpgradePlan:rs});if(S)return(0,ke.jsx)(Jc,{action:"archive",project:S,onConfirm:we,onClose:au});if(f&&b)return(0,ke.jsx)(Hc,{isMovedFromDrafts:Oe(n.space),teamName:f.spaceName,onCancel:ts,onConfirm:()=>Wo(f),onDismiss:ts});if(l)return(0,ke.jsx)(lg,{userWorkspaces:z,onOpenWorkspaceSettings:cu,api:a,onDismiss:os});if(Zi)return Zi;if(Yi)return(0,ke.jsx)(Ll,{onConfirm:qn,onDismiss:()=>Vn(null),unsupportedFeatures:Yi.unsupportedFeatures})}let $n=(0,G.useMemo)(()=>I?be(I)?I.ownerId:null:n.space.scope==="user"||n.userRole==="prototypeViewer"||n.userRole==="viewer"?null:n.space.ownerId,[I,n.space.ownerId,n.space.scope,n.userRole]);return(0,G.useEffect)(()=>{$n&&s.libraryStore.getLibraryForTeam($n).catch(O)},[$n]),(0,G.useEffect)(()=>{if(n.canvasFeatures.sites||Bt.isOn("editableLegacyProjects"))return;let x=["e96bd9c5-e994-4069-955c-a665e70135ef"];I&&be(I)&&I.organization&&x.includes(I.organization.id)||(w(!0),setTimeout(()=>{var H;(H=s.remoteDocument)==null||H.makeReadOnly()}))},[n,I]),Gc(I==null?void 0:I.ownerId),(0,ke.jsxs)(ke.Fragment,{children:[(0,ke.jsx)(Ld,{projectState:t,user:u,activePopover:Z,onActivePopoverChange:R,onAccessChange:ru,onCopyProjectURL:nu,onShowMoveProjectMenu:Wn,moveProjectDestination:f==null?void 0:f.destinationLabel,onConfirmMoveProject:async()=>{f&&await Wo({...f,dismissModal:!1})},onPublish:dg,publishStatus:h,canPublish:s.publishStore.canPublish(s),defaultHostname:T,customHostname:j,defaultHostnameDeployment:D,customHostnameDeployment:W,deploymentStrategy:$,onUpgradePlan:rs}),(0,ke.jsx)(Pa,{children:lu()}),(0,ke.jsx)(vc,{project:n})]})}var ao=g(N());function zd(){var U,f,y;let t=window.framerUser,e=(f=(U=window.bootstrap)==null?void 0:U.project)==null?void 0:f.id;if(!e)throw Error("Can\u2019t find project id");if(!Ie.isOn("sites"))throw Dc;_c(),Vc(),qc(t.id,e),Bc(e);let o=ll(e),r=s.treeStore.getSocketURL(o),i=ug({projectId:e,userId:t.id}),n=qa({url:r,documentConnection:i,tunnel:ja()});(y=s.remoteDocument)==null||y.setSocket(n),s.publishStore.initialize(e,n),s.previewStore.initialize(e);let[c,m]=pl(e,n),l=Ec(po().api,n,c,m),p=fg(),a=ko(()=>new As(l));(0,at.useEffect)(()=>{s.webAssetsService=a,ps.on(Fe).register(a),a.refresh().catch(O)},[a]);let u=(0,at.useRef)(null);(0,at.useEffect)(()=>{sc(a,u)},[a,u]),(0,at.useEffect)(()=>{Da(l,a)},[l,a]);let v=yl({channel:Fe,socket:n});gl({channel:Fe,api:l,projectId:e,fileUpdatesService:v}),Cl({channel:Fe,api:l,socket:n,fileUpdatesService:v}),wl({api:l,channel:Fe}),bl({channel:Fe,toast:E}),dl({api:l,channel:Fe,engine:s}),cl(),(0,at.useEffect)(()=>{l.setInitialProject(sn.project)},[l]),(0,at.useEffect)(()=>n.onMessage(b=>{if(b.type!=="notifyProjectChange")return;let{scope:P}=b.value;P==="acl"?l.getACL():P==="assets"?a.refresh().catch(O):P==="metadata"?l.getProject():P==="sites"?s.publishStore.loadHostnames().catch(O):P==="settings"&&s.publishStore.loadProjectSettings().catch(O)}),[l,a,n]);let{isDarkMode:w}=Se(),S=(0,at.useRef)(c);return S.current=c,(0,at.useEffect)(()=>{i.setGetUserInfoFunction(b=>{let P=S.current.aclById[b];if(!P)return null;let A=ba(P.color||0,w),M=P.user.name.split(" ")[0],R=S.current.userStates[b];return R?{...P.user,shortName:M,color:A,state:R}:null})},[i,w]),(0,ao.jsxs)(Ac.Provider,{value:Rc(l),children:[(0,ao.jsx)(Rl,{socket:n,projectId:e,userId:t.id,documentConnection:i}),(0,ao.jsx)(ua,{mode:p,children:c.project&&(0,ao.jsx)(Gd,{projectState:c,initialUser:t,api:l,assetService:a,filePickerRef:u})}),(0,ao.jsx)(wc,{ref:u})]})}function ug({projectId:t,userId:e}){let o=(0,at.useRef)();if(o.current===void 0){let r=s.getLocalDocumentHandler(t,e),i=new un(r);r.setRemoteConnection(i),o.current=i}return o.current}function fg(){let t=s.toolStore.useState(r=>r.shapeModeActive),e=s.scopeStore.useState(r=>r.active),o=s.overlayStore.useState(r=>r.editModeActive);if(t)return o?"componentGraphicOverlayEditMode":"graphics";if(Ut(e))return o?"componentOverlayEditMode":"component"}var br=g(N());Oc();js();Xa((0,br.jsx)(ic,{children:(0,br.jsx)(nn,{location:"project",title:"Failed to load project",description:(0,br.jsx)(k,{children:"Something unexpected happened on our end while loading the project."}),children:(0,br.jsx)(zd,{})})}),document.getElementById("root"));
//# sourceMappingURL=https://app.framerstatic.com/web.QGSJEFFU.js.map
