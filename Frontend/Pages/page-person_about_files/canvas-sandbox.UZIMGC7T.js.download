import"https://app.framerstatic.com/chunk-ERDJ3ETS.js";import{a as Lr}from"https://app.framerstatic.com/chunk-ZIC2UCOV.js";import{a as gr}from"https://app.framerstatic.com/chunk-HLMBDK6H.js";import{a as Pr}from"https://app.framerstatic.com/chunk-JK2VB7PQ.js";import"https://app.framerstatic.com/chunk-VCOL7YW2.js";import{a as mt,b as ft,c as gt,i as Mr}from"https://app.framerstatic.com/chunk-BTHOS2UU.js";import{a as fr}from"https://app.framerstatic.com/chunk-5OT6VZ2X.js";import{a as lt,b as De,f as Sr,h as Ir,j as Nr}from"https://app.framerstatic.com/chunk-AYPJYRAD.js";import{b as rr,g as ir,h as ar,i as dr,k as Xe,s as Ye}from"https://app.framerstatic.com/chunk-JB6O2ZHZ.js";import"https://app.framerstatic.com/chunk-LL55HCXN.js";import"https://app.framerstatic.com/chunk-44X45VL3.js";import{c as br,e as xr,g as Cr,i as Tr,j as wr,l as Er}from"https://app.framerstatic.com/chunk-DVJXKY62.js";import{A as sr,B as cr,F as lr,I as mr,K as hr,l as Kt,q as tr,u as nr,x as or,z as Re}from"https://app.framerstatic.com/chunk-OKOAMIYK.js";import"https://app.framerstatic.com/chunk-BF2NTWHL.js";import{Bi as Bt,Fq as ve,Hf as ke,Ii as te,Je as Ft,Mf as ae,Mi as qt,Mv as $t,Nf as kt,Ps as jt,Rb as Ut,Zo as qe,_r as Xt,as as Yt,c as Ue,dj as Gt,dm as Vt,fw as Ge,kj as F,nm as Wt,nu as Qt,om as Ht,ou as Zt,qb as Fe,qf as zt,qt as ye,tb as ze,wb as se,xb as Ot}from"https://app.framerstatic.com/chunk-DKOXMNKG.js";import"https://app.framerstatic.com/chunk-CKP2GXTU.js";import"https://app.framerstatic.com/chunk-ZAVCCCEM.js";import"https://app.framerstatic.com/chunk-DSERDOJV.js";import"https://app.framerstatic.com/chunk-OVRPKLAN.js";import"https://app.framerstatic.com/chunk-HDYNDSQI.js";import{a as ut,b as pr}from"https://app.framerstatic.com/chunk-J4D3ZIM5.js";import{a as Jt}from"https://app.framerstatic.com/chunk-JCSLEJQI.js";import{a as yr,b as Rr}from"https://app.framerstatic.com/chunk-FVJCUIQH.js";import"https://app.framerstatic.com/chunk-GSGXB2GS.js";import{a as ur}from"https://app.framerstatic.com/chunk-SFYC6EGM.js";import{g as Ve,h as We,i as He,j as er}from"https://app.framerstatic.com/chunk-6AHRWCXD.js";import"https://app.framerstatic.com/chunk-GK6AYZCV.js";import"https://app.framerstatic.com/chunk-SAE32BGN.js";import{Q as B,R as Lt,da as Be,fa as At,v as A,w as wt}from"https://app.framerstatic.com/chunk-QBNACNR4.js";import{b as Pt,d as pe}from"https://app.framerstatic.com/chunk-F4NXOBHC.js";import{i as Ae}from"https://app.framerstatic.com/chunk-J2WXO73V.js";import{a as ht,b as pt}from"https://app.framerstatic.com/chunk-DETFLWJD.js";import"https://app.framerstatic.com/chunk-QWSCHP2Z.js";import{e as _t}from"https://app.framerstatic.com/chunk-RROMVHYB.js";import{a as vr}from"https://app.framerstatic.com/chunk-FABTAVFP.js";import{b as Jr}from"https://app.framerstatic.com/chunk-6KZDXDRD.js";import{K as Z,N as bt,Na as fe,T as xt,V as Ct,bc as ge,ha as Tt,j as x,l as S,s as It,w as Nt,wa as $,wb as Dt}from"https://app.framerstatic.com/chunk-MQUEQ42D.js";import{v as V}from"https://app.framerstatic.com/chunk-DDX2LCTW.js";import"https://app.framerstatic.com/chunk-S3XK3B27.js";import"https://app.framerstatic.com/chunk-M5JBPS3M.js";import"https://app.framerstatic.com/chunk-TWKDNXKF.js";import{i as Mt,n as Et}from"https://app.framerstatic.com/chunk-AD2YDBYK.js";import{a as he,lb as Kr}from"https://app.framerstatic.com/chunk-SSFV7Z3X.js";import{a as St}from"https://app.framerstatic.com/chunk-BG526CLQ.js";import{F as dt,G as ct,I as oe,J as yt,K as Rt}from"https://app.framerstatic.com/chunk-ZQZGYOKV.js";import{e as ee}from"https://app.framerstatic.com/chunk-N7CDOI6S.js";import{c as Oe,e as X,h as me,l as k,n as vt}from"https://app.framerstatic.com/chunk-6P446G74.js";import{e as H,g as J,h as le,i as at}from"https://app.framerstatic.com/chunk-G6RVR2BI.js";var Pe=H(St());function Dr(s){return!!s&&s.type==="SandboxUpdate"}var en="getFontsForLoading";function Or(s){return en in s}function Ur(s,t){t.debugRenderingFeatures=s,t.updateAllNodes();for(let[n,i]of Object.entries(s))document.body.classList.toggle(`framerdebug-${n}`,i);let e="debugRenderingFeaturesStyles";if(document.getElementById(e))return;let r=document.createElement("style");r.id=e,r.setAttribute("type","text/css"),r.setAttribute("data-framer-css","true"),r.innerText=`
        .framerdebug-hideCanvas {
            display: none !important;
        }
        .framerdebug-hideShadows * {
            box-shadow: none !important;
            text-shadow: none !important;
        }
        .framerdebug-hideFilters * {
            filter: none !important;
            backdrop-filter: none !important;
        }
        .framerdebug-hideBackgrounds * {
            background: none !important;
        }
        .framerdebug-hideLayers * {
            will-change: unset !important;
        }
        .framerdebug-hideImages img {
            display: none !important;
        }
    `,document.head.appendChild(r)}var Fr=H(Kr()),je=k("DeferredRendering");A.setTaskWrapper(Fr.unstable_batchedUpdates);var rn=10,nn=1e3,Se=class{constructor(t,e){this.renderCanvas=t;this.onFinishedLoading=e;this.renderingPhase="Unknown";this.isReadyToRender=!1;this.nodeResourceCounters={};this.groundNodeBatches=[];this.mutableNodesDeferredRendering=new Set;this.mutableNodesLoadingResources=new Set;this.nodesDeferredRendering=new Set;this.nodesLoadingResources=new Set;this.hasScheduledUpdateCanvas=!1;this.scheduleUpdateCanvas=()=>{this.hasScheduledUpdateCanvas||(this.hasScheduledUpdateCanvas=!0,setTimeout(this.updateCanvas))};this.updateCanvas=()=>{if(this.hasScheduledUpdateCanvas=!1,!this.isReadyToRender)return;if(this.prepareNextBatch(),this.nodesDeferredRendering=new Set(this.mutableNodesDeferredRendering),this.nodesLoadingResources=new Set(this.mutableNodesLoadingResources),this.nodesLoadingResources.size>0||this.nodesDeferredRendering.size>0){A.setPriority(4),this.renderCanvas(this.scheduleUpdateCanvas);return}let e=A.getPriority();if(e>0){A.hasImmediateTasksToRun()||A.setPriority(e-1),this.renderCanvas(this.scheduleUpdateCanvas);return}this.renderingPhase="Normal",je.debug("finished",this.activeScopeId),this.renderCanvas(this.onFinishedLoading)};this.batchUpdateResourceLoading=Tt(this.scheduleUpdateCanvas,200);this.hasGroundNodes=!1}prepareNextBatch(){let t=this.groundNodeBatches.shift();if(t!==void 0)for(let e of t)this.mutableNodesDeferredRendering.delete(e),this.mutableNodesLoadingResources.add(e)}groundNodeHasLoadedResources(t){delete this.nodeResourceCounters[t],this.mutableNodesLoadingResources.delete(t),this.nodesDeferredRendering.size===0&&this.batchUpdateResourceLoading()}setReadyToRender(t){this.isReadyToRender!==t&&(this.isReadyToRender=t,this.scheduleUpdateCanvas())}createNodeBatches(t){let e=0,r=[],n=()=>{this.groundNodeBatches.push(r),e=0,r=[]};for(let i of t)e>=nn&&n(),e+=zr(i),r.push(i.id);r.length!==0&&n()}setGroundNodes(t,e,r){if(this.activeScopeId!==r&&(this.activeScopeId=r,this.renderingPhase="Deferred",je.debug("switching scope id:",r),this.nodeResourceCounters={},this.groundNodeBatches=[],this.mutableNodesDeferredRendering=new Set,this.mutableNodesLoadingResources=new Set,this.nodesDeferredRendering=new Set,this.nodesLoadingResources=new Set,this.hasGroundNodes=!1),this.hasGroundNodes)return;if(this.hasGroundNodes=!0,t.length===0)return this.renderingPhase="Normal",je.debug("finished",this.activeScopeId,"groundNodes.length === 0"),this.onFinishedLoading();let n=new Set,i=new Set;for(let o of t){let a=o.id;this.nodeResourceCounters[a]=0,this.mutableNodesDeferredRendering.add(a),e.has(a)?n.add(o):i.add(o)}this.nodesDeferredRendering=new Set(this.mutableNodesDeferredRendering),this.createNodeBatches(n),this.createNodeBatches(i),this.scheduleUpdateCanvas()}shouldTrackResources(t){let e=this.nodesLoadingResources.has(t),r=this.nodesDeferredRendering.has(t);return e&&!r}trackResourceLoading(t,e){if(this.shouldTrackResources(t)){this.nodeResourceCounters[t]++;let n=()=>{this.nodeResourceCounters[t]--,this.checkLoadingState(t)};e().then(n).catch(n)}}checkLoadingState(t){this.shouldTrackResources(t)&&this.nodeResourceCounters[t]===0&&this.groundNodeHasLoadedResources(t)}};function zr(s){var e;let t=1;s instanceof ve&&(t+=rn);for(let r of(e=s.children)!=null?e:[])t+=zr(r);return t}var Qe=A.getTaskQueue("optimizedImages",{priority:0,maxBatchSize:1,useAnimationFrame:!0});var Ze=[128,512],on=4,Ie=class{constructor(t){this.trackThumbnailLoad=t;this.canRenderCanvasImage=t=>this.enabled?t.includes("framerusercontent.com/"):!1;this.enabled=!0;this.zoom=1;this.imageStates=new Map;this.resizeObserver=new ResizeObserver(t=>{for(let e of t){let r=e.target;if(!r.isConnected){this.imageStates.delete(r),this.resizeObserver.unobserve(r),this.intersectionObserver.unobserve(r);continue}let n=this.imageStates.get(r);if(!n||!n.inViewport)continue;let i=Math.round(e.contentRect.width/this.zoom),o=Math.round(e.contentRect.height/this.zoom);i===0||o===0||n&&n.width===i&&n.height===o||(n.width=i,n.height=o,this.computeNextImage(r,n))}});this.intersectionObserver=new IntersectionObserver(t=>{for(let e of t){let r=e.target;if(!r.isConnected){this.imageStates.delete(r),this.resizeObserver.unobserve(r),this.intersectionObserver.unobserve(r);continue}let n=this.imageStates.get(r);if(!n||e.boundingClientRect.width===0||e.boundingClientRect.height===0)continue;let i=0,o=0,a=e.isIntersecting||sn(e);a?(i=Math.round(e.boundingClientRect.width/this.zoom),o=Math.round(e.boundingClientRect.height/this.zoom)):(i=n.width,o=n.height),!(n&&n.width===i&&n.height===o&&n.inViewport===a)&&(n.width=i,n.height=o,n.inViewport=a,this.computeNextImage(r,n))}},{rootMargin:"50px",threshold:.05});this.renderCanvasImage=(t,e,r,n)=>{let i=t.parentElement;if(!i)return;let o=this.getOrCreateImageState(i,t,r),a=!1;a=this.updateImageSource(i,o,0,e,n),a=this.updateImageSource(i,o,1,e)||a,a=this.updateImageSource(i,o,2,e)||a,a&&(o.show=-1,this.computeNextImage(i,o),this.resizeObserver.observe(i),this.intersectionObserver.observe(i))};this.scheduled=!1;this.scheduledRenderings=new Set;this.processRenderMainImage=()=>{this.scheduled=!1;let t=0;for(let e of this.scheduledRenderings){this.scheduledRenderings.delete(e);let r=this.imageStates.get(e);if(r&&(this.renderImage(r),r.show!==0&&(t++,t>on)))break}this.scheduledRenderings.size>0&&(this.scheduled=!0,Qe.add(this.processRenderMainImage))}}getImageSrc(t,e){if(e===-1||e===2)return t;let r=Ze[e],n=t.match(/(.*?)\/assets\/(\d+)\/([^.]+\.[a-zA-Z\d]+)/);if(n)return`${n[1]}/assets/${r}/${n[3]}`;let i=t.match(/(.*?)\/assets\/([^.]+\.[a-zA-Z\d]+)/);if(i)return`${i[1]}/assets/${r}/${i[2]}`;let o=new URL(t);return o.searchParams.set("scale-down-to",String(r)),o.toString()}setEnabled(t){this.enabled=t}setZoom(t){if(this.zoom!==t){this.zoom=t;for(let[e,r]of this.imageStates)this.computeNextImage(e,r)}}getOrCreateImageState(t,e,r){var i,o,a;let n=this.imageStates.get(t);return n?(_e((i=n.images[0])==null?void 0:i.img,r,e),_e((o=n.images[1])==null?void 0:o.img,r,e),_e((a=n.images[2])==null?void 0:a.img,r,e),n):(n={width:0,height:0,inViewport:!0,error:!1,show:-1,images:[{img:$e(e,r,0),src:"",loaded:!1},{img:$e(e,r),src:"",loaded:!1},{img:$e(e,r),src:"",loaded:!1}]},this.imageStates.set(t,n),n)}hasSmallerImageLoaded(t,e){var r,n;return(n=(r=t.images[e-1])==null?void 0:r.loaded)!=null?n:!0}loadLargerImage(t,e){for(let r=e+1;r<=2;r++){let n=t.images[e+1];if(n&&!n.loaded&&n.img.src!==n.src){n.img.src=n.src;return}}}updateImageSource(t,e,r,n,i){let o=e.images[r];if(!o)return!1;let a=this.getImageSrc(n,r);if(o.src===a)return!1;o.src=a,o.loaded=!1,o.img.style.visibility!=="hidden"&&(o.img.style.visibility="hidden");let u=!1,c;return r===0&&i&&this.trackThumbnailLoad&&this.trackThumbnailLoad(i,()=>new Promise(d=>{c=d,u?d():setTimeout(d,2e3)})),o.img.onload=()=>{u=!0,c==null||c(),o.src===a&&(this.loadLargerImage(e,r),o.loaded=o.img.naturalWidth>0,r===2&&(e.error=!o.loaded),this.computeNextImage(t,e))},this.hasSmallerImageLoaded(e,r)&&(o.img.src=a),!0}updateImageVisibility(t,e){var i;let r=(i=t.images[e])==null?void 0:i.img.style;if(!r)return;let n=t.show===e?"visible":"hidden";r.visibility!==n&&(r.visibility=n)}computeShow(t){var i,o,a,u,c,d,m,l,h,f,p;if(t.error)return-1;let e=t.images;if(!t.inViewport)return(i=e[0])!=null&&i.loaded?0:-1;if(this.zoom>.9)return(o=e[2])!=null&&o.loaded?2:(a=e[1])!=null&&a.loaded?1:(u=e[0])!=null&&u.loaded?0:-1;let r=(c=window.devicePixelRatio)!=null?c:1,n=Math.max(t.width,t.height)*this.zoom*r;return n<=Ze[0]?(d=e[0])!=null&&d.loaded?0:-1:n<=Ze[1]?(m=e[1])!=null&&m.loaded?1:(l=e[0])!=null&&l.loaded?0:-1:(h=e[2])!=null&&h.loaded?2:(f=e[1])!=null&&f.loaded?1:(p=e[0])!=null&&p.loaded?0:-1}computeNextImage(t,e){let r=this.computeShow(e);if(e.show===r)return;let n=r<=0||r<e.show;e.show=r,n?this.renderImage(e):this.scheduleRenderMainImage(t)}renderImage(t){this.updateImageVisibility(t,0),this.updateImageVisibility(t,1),this.updateImageVisibility(t,2)}scheduleRenderMainImage(t){this.scheduledRenderings.add(t),this.scheduled||(this.scheduled=!0,Qe.add(()=>Qe.add(this.processRenderMainImage)))}};function sn(s){let t=s.intersectionRect;return t.width>5||t.height>5}function $e(s,t,e){let r=new Image;return r.loading=e===0?"eager":"lazy",Object.assign(r.style,t),r.style.position="absolute",s.appendChild(r),r}function _e(s,t,e){s&&(Object.assign(s.style,t),s.style.position="absolute",s.isConnected||e.appendChild(s))}function kr(s,t){let r=performance.now(),n=0,i=(...o)=>{performance.now()-r>60?(n=void 0,s(...o)):n=setTimeout(i,60,...o)};return(...o)=>{n&&clearTimeout(n),n=setTimeout(i,t,...o)}}function Ne(s,t=2){if(s=s||0,Number.isInteger(s))return s;let e=.5*Number.EPSILON*s,r=1;for(;t-- >0;)r*=10;return s<0&&(r*=-1),Math.round((s+e)*r)/r}var an=k("MeasureContext"),Je=Z.isChrome(),et=Z.isFirefox(),Te=Z.isEdge(),be=Z.isWebKit(),Y=pn();function we(){return(window==null?void 0:window.devicePixelRatio)||0}var q=new DOMMatrixReadOnly;var de,xe=class{constructor(t,e){this.useMatrixDomSizing=t;this.diffMatrixDomSizing=e;this.computedStyleCache=new Map;this.sizeCache=new Map;this.boundingClientRectCache=new Map;this.matrixCache=new Map;this.transformMatrixAndOffsetCacheDeprecated=new Map;this.untransformedRectCacheDeprecated=new Map;this.transformMatrixAndOffsetCache=new Map;this.untransformedRectCache=new Map;le(this,de,new Map)}getComputedStyle(t){let e=this.computedStyleCache.get(t);return e||(e=getComputedStyle(t),this.computedStyleCache.set(t,{display:e.display,width:e.width,height:e.height,transform:e.transform,opacity:e.opacity,filter:e.filter,overflow:e.overflow,transformStyle:e.transformStyle,transformOrigin:e.transformOrigin}),e)}getCreates3dTransformContext(t){let e=this.getComputedStyle(t);return!(e.transformStyle!=="preserve-3d"||e.opacity!=="1"||e.filter!=="none"||e.overflow!=="visible"&&e.overflow!=="none")}transformOriginPoint(t,e=t/2){if(t===0)return 0;let r=Math.round(e/t*100)/100;return be?Ke(t)*r:t*r}getTransformOrigin(t){let e=J(this,de).get(t);if(e)return e;let r=this.getComputedStyle(t),{width:n,height:i}=this.getSize(t),o=r.transformOrigin;if(!o)return{x:this.transformOriginPoint(n,.5),y:this.transformOriginPoint(i,.5)};let a=gn(o),u={x:this.transformOriginPoint(n,a==null?void 0:a.x),y:this.transformOriginPoint(i,a==null?void 0:a.y)};return J(this,de).set(t,u),u}getCachedSize(t){return t?this.sizeCache.get(t):void 0}getSize(t){let e=this.sizeCache.get(t);if(e)return e;let r=this.getComputedStyle(t),n=()=>{let u=t instanceof HTMLElement?t.offsetWidth:t.clientWidth;return r.display.startsWith("inline")?u+1:u},i=()=>t instanceof HTMLElement?t.offsetHeight:t.clientHeight,o=r.width.endsWith("px")?parseFloat(r.width):n(),a=r.height.endsWith("px")?parseFloat(r.height):i();return e={width:o||0,height:a||0},this.sizeCache.set(t,e),e}getCSSTransform(t){return this.getComputedStyle(t).transform||"none"}hasTransforms(t){return et?this.getCSSTransform(t)!=="none":!this.getMatrix(t).isIdentity}getMatrix(t){let e=this.matrixCache.get(t);if(e)return e;let r=this.getCSSTransform(t);return e=r==="none"?q:new DOMMatrix(r),this.matrixCache.set(t,e),e}getBoundingClientRect(t){let e=this.boundingClientRectCache.get(t);return e||(e=t.getBoundingClientRect(),this.boundingClientRectCache.set(t,e),e)}getUntransformedRectInGroundNode(t,e){if(this.diffMatrixDomSizing){let r=this.getUntransformedRectInGroundNodeByMatrixTransformation(t,e),n=this.getUntransformedRectInGroundNodeByOriginPoint(t,e);return S.equals(r,n)||an.trace("getUntransformedRectInGround: Rects are not equal",bt(t.id),r,n),r}return this.useMatrixDomSizing?this.getUntransformedRectInGroundNodeByMatrixTransformation(t,e):this.getUntransformedRectInGroundNodeByOriginPoint(t,e)}getUntransformedRectInGroundNodeByOriginPoint(t,e){let r=this.untransformedRectCacheDeprecated.get(t);if(r)return r;let n=this.getTransformAncestors(t),i={x:0,y:0,paintX:0,paintY:0,translationX:0,translationY:0},o=q,a={x:0,y:0,width:0,height:0};return[...n,t].forEach(c=>{let d=this.transformMatrixAndOffsetCacheDeprecated.get(c);if(d){i={...d.offset},o=d.matrix;return}let{width:m,height:l}=this.getSize(c),h=x(m/2,l/2),f=this.getBoundingClientRect(c),p=this.getMatrix(c),R=h.x,g=h.y,I=q.translate(R,g).multiplySelf(p).translateSelf(-R,-g),b,v=be;if(v){let ue=Ke(m)/2,ie=Ke(l)/2,_r=q.translate(ue,ie).multiplySelf(p).translateSelf(-ue,-ie);b=o.multiply(_r)}else b=o.multiply(I);let D=x(f.x+f.width/2,f.y+f.height/2),y=F.convertPoint(e,D),P=F.convertPoint(b,h),C=0,O=0;if(v){let ue=o.multiply(I),ie=F.convertPoint(ue,h);C=P.x-ie.x,O=P.y-ie.y}let K=y.x-P.x,j=y.y-P.y,W=q.translate(K,j).multiplySelf(b),E=x(y.x-C,y.y-O),Q=F.convertPoint(o.inverse(),E),L=x(_(Q.x-m/2),_(Q.y-l/2)),G=x(T(L.x),T(L.y)),z=this.hasTransforms(c),U=F.hasNonTranslationTransform(p),rt=Gr(c),{rect:nt,paintDelta:it,translation:ot}=qr(i,L,{width:m,height:l},p,z,rt),st=Br(z,U,rt,L,G);i.x+=st.x,i.y+=st.y,i.paintX+=it.x,i.paintY+=it.y,i.translationX+=ot.x,i.translationY+=ot.y,o=W,this.transformMatrixAndOffsetCacheDeprecated.set(c,{matrix:o,offset:{...i}}),this.untransformedRectCacheDeprecated.set(c,nt),a=nt}),a}getUntransformedRectInGroundNodeByMatrixTransformation(t,e){let r=this.untransformedRectCache.get(t);if(r)return r;let n=this.getTransformAncestors(t),i={x:0,y:0,paintX:0,paintY:0,translationX:0,translationY:0},o=q,a={x:0,y:0,width:0,height:0};return[...n,t].forEach(c=>{let d=this.getSize(c),m=this.getBoundingClientRect(c),l=this.getMatrix(c),h=l.m41/l.m44,f=l.m42/l.m44,{x:p,y:R}=this.getTransformOrigin(c),g=q.translate(p,R).multiplySelf(l).translateSelf(-p,-R),I=S.pointsAtOrigin(d),b=S.fromPoints(S.points(m).map(G=>e.transformPoint(G))),{x:v,y:D,matrix:y}=rr(o,g,b,I),P=x(_(v+h),_(D+f)),C=x(T(P.x),T(P.y)),O=this.hasTransforms(c),K=F.hasNonTranslationTransform(l),j=Gr(c),{rect:W,paintDelta:E,translation:Q}=qr(i,P,d,l,O,j),L=Br(O,K,j,P,C);i.x+=L.x,i.y+=L.y,i.paintX+=E.x,i.paintY+=E.y,i.translationX+=Q.x,i.translationY+=Q.y,o=this.getCreates3dTransformContext(c)?y:F.flatProjectionMatrix(y),this.transformMatrixAndOffsetCache.set(c,{matrix:o,offset:{...i}}),this.untransformedRectCache.set(c,W),a=W}),a}getTransformAncestors(t){var n;let e=[],r=t.parentElement;for(;r!=null&&!Ar(r)&&r!==((n=t.ownerDocument)==null?void 0:n.documentElement);)this.hasTransforms(r)&&e.unshift(r),r=r.parentElement;return e}getOffsetParentBoundingRect(t){if(!(t instanceof HTMLElement&&t.dataset.framerOffsetParentId))return;let e=document.getElementById(t.dataset.framerOffsetParentId);if(e)return this.getBoundingClientRect(e)}getParentRelativeRect(t,e,r){let n=this.getUntransformedRectInGroundNode(t,e),i=n,o,a,u=this.getOffsetParentBoundingRect(t);if(u){let m=e.transformPoint(new DOMPoint(u.x,u.y));return{x:n.x-m.x,y:n.y-m.y,width:n.width,height:n.height}}let c=t instanceof HTMLElement?t.offsetParent:t.parentElement;return c&&!Ar(c)?(i=this.getUntransformedRectInGroundNode(c,e),o=n.x-i.x,a=n.y-i.y):r?(o=r.x,a=r.y):(o=0,a=0),{x:o,y:a,width:n.width,height:n.height}}};de=new WeakMap;function Ar(s){var t;return s.classList.contains(Xe)||((t=s.parentElement)==null?void 0:t.classList.contains(Xe))}function Br(s,t,e,r,n){return et&&s?n:(Je||Te)&&t?{x:e.includes(0)?r.x:n.x,y:e.includes(1)?r.y:n.y}:r}function dn(s){let t=we();if(t<2)return Math.round(_(s));let e=Vr(s)/Y;return Ne(e*t,0)/t}function cn(s){return we()<2?Math.round(_(s)):Math.round(_(s)*2)/2}function un(s){let t=Vr(s),e=0,r=t%Y,n=Math.trunc(t/Y)*Y;return we()<=1?(r>=32&&(e=64),r<-32&&(e=-64)):(r>=16&&r<48&&(e=32),r>=48&&(e=64),r<-16&&r>=-24&&(e=-24),r<-24&&r>=-48&&(e=-32),r<-48&&r>=-56&&(e=-56),r<-56&&(e=-64)),(n+e)/Y}function ln(){return Je||Te?cn:be?un:dn}var T=ln();function Ce({x:s,y:t,width:e,height:r}){let n=T(s),i=T(t);return{x:n,y:i,width:T(s+e)-n,height:T(t+r)-i}}function Ke(s){let t=we();return Ne(s*t,0)/t}function _(s){return Ne(s*Y,0)/Y}function Vr(s){return Math.trunc(s*Y)}function mn({x:s,y:t,width:e,height:r},n){let{rotation:i,translation:o}=tt(n),a=x(s-o.x,t-o.y),u=Ce({...a,width:e,height:r}),c=x(u.x+T(e)/2,u.y+T(r)/2),d=q.translate(c.x+o.x,c.y+o.y).rotateSelf(i).translateSelf(-c.x,-c.y),m=F.convertPoint(d,S.center(u)),l=m.x-u.width/2,h=m.y-u.height/2;return{paintedRect:{x:l,y:h,width:u.width,height:u.height},snappedLayoutRect:u,translation:o}}function hn({x:s,y:t,width:e,height:r},n,i=[]){let{rotation:o,translation:a}=tt(n);i.includes(0)&&(a.x=-.5*e),i.includes(1)&&(a.y=-.5*r);let u=x(s-a.x,t-a.y),c=Ce({...u,width:e,height:r}),d=Math.round(e),m=Math.round(r),l=o!==0?d:c.width,h=o!==0?m:c.height,f=x(c.x+e/2,c.y+r/2),p=q.translate(f.x+a.x,f.y+a.y).rotateSelf(o).translateSelf(-f.x,-f.y),R=x(c.x+l/2,c.y+h/2),g=F.convertPoint(p,R),I=g.x-l/2,b=g.y-h/2;return{paintedRect:{x:I,y:b,width:l,height:h},snappedLayoutRect:c,translation:a}}function fn(s,t,{width:e,height:r},n){let{rotation:i,translation:o}=tt(n),a=x(t.x-o.x,t.y-o.y),u=s.x+T(a.x),c=s.y+T(a.y),d=x(u+e/2,c+r/2),m=q.translate(d.x+o.x,d.y+o.y).rotateSelf(i).translateSelf(-d.x,-d.y),l=F.convertPoint(m,x(u+e/2,c+r/2)),h=l.x-e/2,f=l.y-r/2;return{x:h,y:f,width:e,height:r}}function qr(s,t,e,r,n,i){let o={x:0,y:0},a={x:-s.paintX,y:-s.paintY},u={x:s.translationX,y:s.translationY},c={x:s.x-u.x+t.x,y:s.y-u.y+t.y,...e};if(be){let f=Ce(c),p=S.offset(f,{x:u.x+a.x,y:u.y+a.y});if(n){let{paintedRect:R,snappedLayoutRect:g,translation:I}=mn(c,r),b=S.offset(R,{x:u.x+a.x,y:u.y+a.y}),v=S.offset(g,I);return o={x:v.x-R.x,y:v.y-R.y},{rect:b,paintDelta:o,translation:I}}return{rect:p,paintDelta:o,translation:{x:0,y:0}}}if(Je||Te){let f=Ce(c),p=S.offset(f,{x:u.x+a.x,y:u.y+a.y});if(n){let{paintedRect:R,snappedLayoutRect:g,translation:I}=hn(c,r,i),b=S.offset(R,{x:u.x+a.x,y:u.y+a.y}),v=S.offset(g,I);return o={x:v.x-R.x,y:v.y-R.y},{rect:b,paintDelta:o,translation:I}}return{rect:p,paintDelta:o,translation:{x:0,y:0}}}let d=s.x+t.x,m=s.y+t.y,l={x:d,y:m,...e};if(n){let f=S.offset({x:s.x+T(t.x),y:s.y+T(t.y),width:l.width,height:l.height},a),p=S.offset(fn(s,t,e,r),a);return o={x:f.x-p.x,y:f.y-p.y},{rect:p,paintDelta:o,translation:{x:0,y:0}}}return{rect:S.offset(l,a),paintDelta:o,translation:{x:0,y:0}}}function tt(s){let t=Math.atan2(s.b,s.a)*(180/Math.PI),e={x:s.e,y:s.f};return{rotation:t,translation:e}}function Gr(s){let t=[];return s instanceof HTMLElement&&(s.dataset.framerLayoutHintCenterX&&t.push(0),s.dataset.framerLayoutHintCenterY&&t.push(1)),t}function pn(){return et?60:Te?100:64}function gn(s){let[t,e]=s.split(" ").map(r=>parseFloat(r));if(!(!Ae(t)||!Ae(e)))return{x:t,y:e}}var w=k("LayoutMeasureQueue"),yn=new DOMMatrixReadOnly,Wr=Z.isFirefox()?1:0,re=class{constructor(t,e){this.measureRequests=new Map;this.measureRequestsNodeIds=new Set;this.refinementRequests=new Map;this.refinementRequestsByGroundNodeId=new Map;this.richTextNodeIds=new Set;this.previousScopeNodeId="";this.resizeObserver=null;this.shouldMeasureTimerStarted=!1;this.shouldMeasureCallback=void 0;this.runShouldMeasureCallback=()=>{this.shouldMeasureTimerStarted=!1,this.size()!==0&&this.shouldMeasureCallback&&this.shouldMeasureCallback()};this.resized=(t,e)=>{if(this.resizeObserver===e)for(let r of t){let n=r.target;if(!n.isConnected||!n.id)return;this.add(ae(n.id),n)}};this.shouldMeasureCallback=t,this.renderingStateTracker=e}add(t,e,r){w.trace("layout measure queue:",t),!(!r&&this.measureRequests.has(e))&&(this.measureRequests.set(e,{nodeId:t,children:r}),this.measureRequestsNodeIds.add(t),this.shouldMeasureCallback&&!this.shouldMeasureTimerStarted&&(setTimeout(this.runShouldMeasureCallback,100),this.shouldMeasureTimerStarted=!0))}stylePresetChanged(t){for(let e of this.richTextNodeIds)this.remeasureNodeAndAncestors(t,t.get(e));this.richTextNodeIds.clear()}remeasureNodeAndAncestors(t,e){e&&(this.measureRequestsNodeIds.has(e.id)||(e.cache.htmlElement&&this.add(e.id,e.cache.htmlElement),this.remeasureNodeAndAncestors(t,t.getNodeParent(e))))}remeasureChildrenWithDOMRects(t){if(w.trace("remeasureChildrenWithLayout:",t.id),!!t.children&&!Fe(t))for(let e of t.children)e.cache.htmlElement&&(this.measureRequestsNodeIds.has(e.id)||te(e)&&!e.usesDOMRectCached()||(w.trace("remeasureChildrenWithLayout, child:",e.id),this.add(e.id,e.cache.htmlElement)))}remeasureLayoutChildren(t){if(w.trace("remeasureLayoutChildren:",t.id),!!Fe(t))for(let e of t.children)e.cache.htmlElement&&(this.measureRequestsNodeIds.has(e.id)||(w.trace("remeasureLayoutChildren, child:",e.id),this.add(e.id,e.cache.htmlElement)))}remeasureAutosizingAncestors(t,e){!e||!e.children||(w.trace("remeasureAutosizingAncestors:",e.id),this.remeasureLayoutChildren(e),Ue(e)&&(e.widthType!==2&&e.heightType!==2||e.cache.htmlElement&&(this.measureRequestsNodeIds.has(e.id)||(w.trace("remeasureAutosizingAncestors, add:",e.id),this.add(e.id,e.cache.htmlElement),this.remeasureAutosizingAncestors(t,t.getNodeParent(e))))))}process({scopeId:t,zoom:e,offsetX:r,offsetY:n,tree:i,groundNodesInViewport:o}){var I,b;this.previousScopeNodeId!==t&&(w.debug("switching to a new page",this.previousScopeNodeId,t),this.richTextNodeIds.clear(),this.refinementRequests.clear(),this.refinementRequestsByGroundNodeId.clear(),Hr(i.get(this.previousScopeNodeId)),this.previousScopeNodeId=t,this.resizeObserver&&this.resizeObserver.disconnect(),this.resizeObserver=new ResizeObserver(this.resized));let a=this.previousZoomLevel!==void 0&&e!==this.previousZoomLevel;this.previousZoomLevel=e;let u=this.previousGroundNodesInViewport!==void 0&&o!==this.previousGroundNodesInViewport,c=new Set([...o]),d=new Set;if(this.previousGroundNodesInViewport!==void 0)for(let v of o)this.previousGroundNodesInViewport.has(v)&&(c.delete(v),d.add(v));if(this.previousGroundNodesInViewport=o,u&&this.processRefinementRequests(c),(u||a)&&e>Wr&&this.processRefinementRequests(d),w.trace("process:",this.size()),this.size()===0)return[];let m=V.isOn("nodeBasedRenderer"),l=yn.scale(e).translateSelf(-r,-n),h=[],f=new Map,p=new xe(V.isOn("matrixDomSizing"),V.isOn("matrixDomSizingDiffing"));for(let[v,D]of this.measureRequests){let y=i.getNode(D.nodeId);y&&(this.remeasureAutosizingAncestors(i,i.getNodeParent(y)),m&&(this.remeasureChildrenWithDOMRects(y),this.remeasureLayoutChildren(y)))}let R=Rn(this.measureRequests.values(),i,l),g=new Set;for(let[v,D]of this.measureRequests){let{nodeId:y,children:P}=D,C=i.getNode(y);if(!C)continue;if(!v.isConnected){w.trace("measureRequest: not connected",y);continue}let O=R.get(y);C.cache.htmlElement=v;let K=O.matrix,j=O.rect;if(!o.has(O.id)){this.addRefinementRequest(y,{element:v,groundNodeId:O.id,measureRequest:D}),w.trace("measureRequest: refine",y);continue}let W;if(P){W=[];for(let L of P){if(br(L))continue;let G=ae(L.id),z=f.get(L);if(!z&&(z=p.getParentRelativeRect(L,K,j),f.set(L,z),G)){let U=i.getNode(G);U&&(U.cache.needsMeasure=!1),h.push({nodeId:G,layoutMetrics:z})}if(G){let U=i.getNode(G);if(U&&m&&(S.equals(U.cache.domRect,z)||g.add(U.id),U.cache.domRect=z),U&&!Gt(U,C))continue}W.push(z)}}let E=f.get(v);E?w.trace("measureRequest: cached",y,E):(E=p.getParentRelativeRect(v,K,j),f.set(v,E),w.trace("measureRequest: getParentRelativeRect",y,E)),e<=Wr&&this.addRefinementRequest(y,{element:v,groundNodeId:O.id,measureRequest:D});let Q={...E,childrenRects:W};C&&(C.cache.needsMeasure=!1,se(C)?this.richTextNodeIds.add(y):Ot(C)&&((I=this.resizeObserver)==null||I.observe(v)),m&&(S.equals(C.cache.domRect,E)||g.add(C.id),C.cache.domRect=E)),h.push({nodeId:y,layoutMetrics:Q})}return this.measureRequests.clear(),this.measureRequestsNodeIds.clear(),g.size>0&&((b=this.renderingStateTracker)==null||b.processNodesWithChangedRect(g)),h}size(){return this.measureRequests.size}addRefinementRequest(t,e){let r=this.refinementRequests.get(t);if(r&&r.groundNodeId){let n=this.refinementRequestsByGroundNodeId.get(r.groundNodeId);n==null||n.delete(r)}if(this.refinementRequests.set(t,e),e.groundNodeId){let n=this.refinementRequestsByGroundNodeId.get(e.groundNodeId);n||(n=new Set,this.refinementRequestsByGroundNodeId.set(e.groundNodeId,n)),n.add(e)}}processRefinementRequests(t){for(let e of t){let r=this.refinementRequestsByGroundNodeId.get(e);if(!(!r||r.size===0)){for(let n of r)this.refinementRequests.delete(n.measureRequest.nodeId),n.element.isConnected&&(this.measureRequestsNodeIds.has(n.measureRequest.nodeId)||(w.trace("refine:",n.measureRequest.nodeId),this.measureRequests.set(n.element,n.measureRequest)));r.clear()}}}};function Rn(s,t,e){var i;let r=new Map,n=new Map;for(let{nodeId:o}of s){let a=e,u=t.get(o),c=[],d=u;for(;d&&t.getParent(d.id);){let m=n.get(d.id);if(m){d=t.get(m);break}d=t.getParent(d.id),d&&c.push(d.id)}if(d&&Ue(d)){a=((i=r.get(d.id))==null?void 0:i.matrix)||a.translate(d.left||0,d.top||0).inverse();for(let l of c)n.set(l,d.id)}else a=a.inverse();r.set(o,{id:d==null?void 0:d.id,matrix:a,rect:d?Wt(d):null})}return r}function Hr(s){if(!s)return;s.cache.htmlElement=null;let t=s.children;if(t)for(let e of t)Hr(e)}function Xr(s){let t=new re;for(let e of s){let r=document.getElementById(kt(e.id));r&&t.add(e.id,r,Sn(e,r))}return t}function Sn(s,t){return s instanceof ve?xt(t):[]}var Me=class{constructor(){this.componentLoaderStateEmitter=new ee;this.componentLoaderStateStream=this.componentLoaderStateEmitter.newStream;this.componentLoaderStateEmitter.emit({type:"fullStateSync",hash:"initial",revision:-1,state:B.getSerializableState()})}emitComponentLoaderStateEvent(t){this.componentLoaderStateEmitter.emit(t)}async queryData(t){var a;let e=B.dataForIdentifier(t.identifier);X(e,"Missing data definition for identifier");let r=(a=e.annotations)==null?void 0:a.framerRecordIdKey,n=new Dt,i={from:{type:"Collection",data:e.class},select:t.fields.map(u=>({type:"Identifier",name:u}))};return t.id&&r&&(i.where={type:"BinaryOperation",operator:"==",left:{type:"Identifier",name:r},right:{type:"LiteralValue",value:t.id}}),{data:await n.query(i,void 0)}}};var Yr=H(St()),jr=H(Jr());var ce=H(he());function In({resolve:s,children:t}){return(0,Yr.useLayoutEffect)(s),(0,ce.jsx)(ce.Fragment,{children:t})}async function Qr(s,t){var a,u;let e=document.createElement("div");e.style.visibility="hidden",e.style.position="absolute",e.style.pointerEvents="none",document.body.appendChild(e);let r=(0,jr.createRoot)(e),n=[Be,...((a=s.root.locales)!=null?a:[]).map(fr)],i=[];for(let c of t){let d=s.get(c);if(!d)continue;let m=nr(d.html);for(let l of n){let h=d.html;if(l!==Be){let p=mr(m,(u=d.htmlLocalized)==null?void 0:u[l],h);if(!p)continue;h=p.type!=="rich-text"?Qt(h,p.value):lr(h,p.value)}let f=d.clone({...qt,textFitViewBoxSize:void 0,widthType:2,heightType:2,width:void 0,height:void 0,id:`${c}-${l}`,html:h});d.forceNeedsMeasure(),i.push(Tr(Cr,{node:f,groundNode:null,scopeNode:null,cachePath:[],forceRender:0}))}}await new Promise(c=>{r.render((0,ce.jsx)(In,{resolve:c,children:i}))});let o=[];for(let c of e.children){let{clientWidth:d,clientHeight:m,id:l}=c,[h,f]=ae(l).split("-",2);o.push({nodeId:h,localeId:f,width:d,height:m})}return r.unmount(),document.body.removeChild(e),{measurements:o}}var N=k("canvas-sandbox"),Zr=(s,t)=>new Promise((e,r)=>{setTimeout(()=>{r(Error(t))},s)}),ne,Ee=class{constructor(){this.nodeBasedRenderer=!1;this.renderingStateTracker=wr.shared();this.renderTarget=Nt.canvas;this.lastEngineUpdate=0;this.tree=Ge.createEmpty();this.layoutCache=new tr;this.sandboxCollectionData=new cr("sandbox");this.selection=[];this.inRelativeOverlayEditMode=!1;this.initialModuleUpdatesBufferState={buffering:!0,buffer:[]};this.modulesRevision=null;this.lazyModulesRevision=0;this.componentHash=null;this.loadedSomeUserData=!1;this.isInitialLoad=!0;this.isDarkMode=!1;this.scopeSwitchStartTime=0;this.scopeSwitchUpdateEndTime=0;this.scopeId="";this.groundNodes=[];this.groundNodeIdsInViewport=new Set;this.visibleRect={x:0,y:0,width:0,height:0};this.nodeIdsToRerender=new Set;this.lastPresetsListNodeUpdate=0;this.measureLayoutAndEmitUpdate=()=>{let t=performance.now(),e=this.lastRendering.update,r=this.measureLayout(e),n=this.sandboxCollectionData.getUpdates(),i=r.length,o=n.length;if(i===0&&o===0)return;N.trace("measureLayoutAndEmitUpdate","layoutMeasurementCount:",i,"collectionRecordUpdateCount:",o),this.updateTime+=performance.now()-t;let{updateTime:a,renderTime:u}=this.getAndResetTimings();this.renderedUpdateEmitter.emit({update:e,updateTime:a,renderTime:u,renderingPhase:this.deferredRendering.renderingPhase,moduleRuntimePhase:this.modulesRuntime.phase,layoutMeasurements:r,collectionRecordUpdates:n,scopeId:this.scopeId,updateEndTime:0,renderEndTime:0,scopeSwitchStartTime:0})};this.deferredRenderingFinished=()=>{this.isLoadingResourcesPromise.resolve(),this.isInitialLoad=!1;let t=this.lastRendering.update,e=this.measureLayout(t);e.length>0&&N.trace("deferredRenderingFinished",e.length);let{updateTime:r,renderTime:n}=this.getAndResetTimings();this.renderedUpdateEmitter.emit({update:t,updateTime:r,renderTime:n,renderingPhase:"Normal",moduleRuntimePhase:this.modulesRuntime.phase,layoutMeasurements:e,collectionRecordUpdates:this.sandboxCollectionData.getUpdates(),scopeId:this.scopeId,updateEndTime:this.scopeSwitchUpdateEndTime,renderEndTime:performance.now(),scopeSwitchStartTime:this.scopeSwitchStartTime}),this.scopeSwitchStartTime&&this.scopeSwitchUpdateEndTime&&(this.scopeSwitchStartTime=0,this.scopeSwitchUpdateEndTime=0)};this.deferredRendering=new Se(t=>this.triggerRenderer(t),this.deferredRenderingFinished);this.trackThumbnailLoad=(t,e)=>{let r=this.tree.get(t);if(!r)return;let n=this.tree.getGroundNodeFor(r);this.deferredRendering.trackResourceLoading(n.id,e)};this.imageLoader=new gr(this.trackThumbnailLoad);this.optimizedCanvasImageRenderer=new Ie(this.trackThumbnailLoad);this.performanceMode=!1;this.offsetX=0;this.offsetY=0;this.canvasZoom=1;this.liveZoom=void 0;this.inMoveTool=!1;this.updateTime=0;this.renderTime=0;this.nodeWithPlaceholder=null;this.previousNodeInTextEditor=ke;this.previousNodeInPathEditor=ke;this.previousNodesInEffectPreview=[];this.previousActiveEffect=null;this.previousActiveOverlayNodes=new Set;this.controlsVisibilityService=new ir(this);this.sandboxComponentLoaderService=new Me;this.sandboxComponentLoader=B;this.layoutMeasureQueue=new re(this.measureLayoutAndEmitUpdate,this.renderingStateTracker);this.vekterLocales=[];this.routerLocales=[];this.modulesRuntime=new Pr("waiting",this,()=>this.routerLocales);this.forceRender=1e3;this.assetMap=new Mt;this.svgRenderer=hr.shared();this.startedHeartbeat=!1;this.emitHeartbeat=()=>{let e={},{memory:r}=performance;r&&(e.memoryTotal=r.totalJSHeapSize,e.memoryUsed=r.usedJSHeapSize,e.memoryLimit=r.jsHeapSizeLimit),e.domNodes=document.querySelectorAll("*").length,this.heartbeatEmitter.emit({vitals:e,next:1e4}),window.setTimeout(this.emitHeartbeat,1e4)};this.requestNodesRerender=kr(()=>{this.invalidateNodes(this.nodeIdsToRerender),this.nodeIdsToRerender.clear(),this.triggerRenderer()},250);this.viewportSize={width:800,height:800};this.updateViewportSize=()=>{let t={width:window.innerWidth||document.documentElement.clientWidth,height:window.innerHeight||document.documentElement.clientHeight};return Ct(t,this.viewportSize)?!1:(this.viewportSize=t,!0)};this.renderedUpdateEmitter=new ee;this.errorEmitter=new ee;this.heartbeatEmitter=new ee;this.needsRender=!1;this.lastRendering={update:0,scopeId:"",zoom:1,offsetX:0,offsetY:0,tree:this.tree,groundNodesInViewport:new Set};this.scheduledPostRenderMicroQueue=!1;le(this,ne,[]);this.reportError=t=>{this.errorEmitter.emit(t)};this.isLoadingResourcesPromise=Oe();this.isTrackingUpdates=!1;this.triggerRenderer=()=>{};this.renderingStateTracker.sandboxCollectionData=this.sandboxCollectionData;let t=!1,e=De.service.fingerprint,r=De.on(oe).register({initialize:async({renderTarget:i,upgradeToMessagePortChannel:o,treeVersion:a})=>{if(this.renderTarget=i,t=o,a!==zt)throw new Error("Incompatible tree version")}});this.setupExperimentsUpdatesStream(oe),window.addEventListener("resize",this.updateViewportSize),setTimeout(this.updateViewportSize),window.addEventListener("visibilitychange",()=>{if(document.visibilityState!=="visible")return;this.updateViewportSize()&&(this.updateViewportRect(),this.updateGroundNodesInViewport(),this.triggerRenderer())}),ct.interceptMessageEventsFromOpenerFrame(i=>{if(i.data!==e||!(i instanceof MessageEvent))return!1;r();let o=i.ports[0];X(o,"CanvasSandboxApp expected parent frame to transfer a MessagePort"),X(!this.channelToOpenerFrame,"CanvasSandboxApp already has a channel to the parent frame"),N.debug("CanvasSandboxApp: received port to parent frame; should use it to upgrade:",t);let a=t?new dt(o):oe;return this.channelToOpenerFrame=a,lt.on(a).register(this),gt.on(a).register(this.sandboxComponentLoaderService),mt.on(a).register(this.controlsVisibilityService),ft.on(a).register(this.modulesRuntime),t&&this.setupExperimentsUpdatesStream(a),Et(ut.on(a).discover(),async u=>{u.assets&&(this.assetMap.set(u.assets),$.importCustomFonts(u.assets),this.triggerRenderer())}),pt.on(a).discover().then(async u=>{let c=g=>{this.modulesRevision!==null&&g<this.modulesRevision&&N.reportError(new Error("Assertion error: processing modules update out of order.")),this.nodeBasedRenderer||Re(this.tree,this.sandboxCollectionData),this.markGroundNodesNeedRendering(),this.modulesRevision=g,this.rerenderGroundNodesIfNeeded()};u.moduleUpdatesStream().read(async g=>{if(this.initialModuleUpdatesBufferState.buffering)this.initialModuleUpdatesBufferState.buffer.push(g);else{let{patches:I,dependentModules:b,revision:v,initialized:D}=g;try{await this.modulesRuntime.handleLocalModulesUpdate({patches:I,dependentModules:b,initialized:D,revision:v}),c(v)}catch(y){N.reportError(y,{context:"Failed to handle modules update"})}}}).catch(N.reportError);let{dependenciesModule:d,modules:m,revision:l,initialized:h}=await u.getModules(),f=l,p=[],R=new Set;d&&p.push({op:"add",path:[`${d.type}/${d.name}`],value:d});for(let g of Object.values(m))p.push({op:"add",path:[`${g.type}/${g.name}`],value:g});X(this.initialModuleUpdatesBufferState.buffering);for(let g of this.initialModuleUpdatesBufferState.buffer)g.revision<=f||(f=g.revision,p.push(...g.patches),g.dependentModules.forEach(I=>R.add(I)));this.initialModuleUpdatesBufferState={buffering:!1},this.modulesRuntime.handleLocalModulesUpdate({patches:p,dependentModules:Array.from(R),initialized:h,revision:f}).then(()=>{c(f)}).catch(N.reportError)}).catch(N.reportError),N.debug("CanvasSandboxApp: registered services"),!0});let n=i=>{for(let o of i)this.nodeIdsToRerender.add(o);this.requestNodesRerender()};jt.updateNodes=n,$t.updateNodes=n,Zt.updateNodes=n,Xt.updateNodes=n,Yt.updateNodes=n,N.debug("CanvasSandboxApp: ready to initialize"),Nr(oe)}calculateCodeRevision(){return this.lazyModulesRevision<=0?this.componentHash+"_"+this.modulesRevision:this.componentHash+"_"+this.modulesRevision+"."+this.lazyModulesRevision}get codeRevision(){return this.calculateCodeRevision()}localModulesLoaded(t,e){this.modulesRevision=t,this.lazyModulesRevision=e,this.sandboxComponentLoaderService.emitComponentLoaderStateEvent({type:"fullStateSync",hash:this.calculateCodeRevision(),revision:t,state:B.getSerializableState()}),this.nodeBasedRenderer&&this.renderingStateTracker.updateState({componentLoaderHash:this.calculateCodeRevision()})}externalModulesLoadingStateChange(t){t||this.rerenderComponentPresets()}externalModuleLoaded(t,e){this.sandboxComponentLoaderService.emitComponentLoaderStateEvent({type:"externalModuleLoaded",externalModuleBareIdentifier:t,entities:e})}get assetMapHash(){return this.assetMap.hash^this.forceRender}setupExperimentsUpdatesStream(t){ht.on(t).discover().then(async e=>{e.experimentsUpdatesStream({replay:"latest"}).read(r=>V.update(r)).catch(N.reportError),e.projectFeaturesUpdatesStream().read(r=>fe.update(r)).catch(N.reportError)}).catch(N.reportError)}invalidateNodes(t){for(let e of t){let r=this.tree.get(e);r&&(this.rerenderNode(r),this.nodeBasedRenderer||(r.cache.reset(),te(r)&&r.forceNeedsMeasure()))}this.groundNodes=this.getGroundNodes(qe)}updateTransform(t){var e;this.offsetX=t[0],this.offsetY=t[1],this.canvasZoom=t[2],this.liveZoom=t[3],this.inMoveTool=(e=t[4])!=null?e:!1}async waitForViewportSize(t){let e=Oe(),r=()=>{window.innerWidth===t.width&&window.innerHeight===t.height&&e.resolve()};window.addEventListener("resize",r),r();try{await Promise.race([e,Zr(5e3,`CanvasSandboxApp: expected resize to (${t.width}x${t.height}) within 5s, but viewport is still ${window.innerWidth}x${window.innerHeight}`)])}finally{window.removeEventListener("resize",r)}return{pixelRatio:window.devicePixelRatio}}updateViewportRect(){let t=this.liveZoom||this.canvasZoom,e=0,r=0,n=0,i=0;this.visibleRect={x:this.offsetX+e/t,y:this.offsetY+n/t,width:(this.viewportSize.width-e-r)/t,height:(this.viewportSize.height-n-i)/t}}updateGroundNodesInViewport(){if(this.liveZoom)return;let t=this.visibleRect,e=new Set,r=this.groundNodeIdsInViewport,n=this.groundNodes,i=!0;for(let a=0,u=n.length;a<u;a++){let c=n[a],d=c.id;S.intersects(Ht(c),t)&&(e.add(d),i&&!r.has(d)&&(i=!1))}(!i||e.size!==r.size)&&(this.groundNodeIdsInViewport=e);let o=ye(this.tree);o&&o.update!==this.lastPresetsListNodeUpdate&&(this.lastPresetsListNodeUpdate=o.update,this.loadStylePresetFontsAndThenMeasure())}updateCache(){this.nodeBasedRenderer||sr(this.tree,this.layoutCache,this.sandboxCollectionData,this.activeLocaleId,this.scopeId),this.previousCachedScopeId=this.scopeId}markNeedsReactRendering(){this.needsRender=!0}markGroundNodesNeedRendering(){this.needsRender=!0,this.groundNodes=[]}rerenderNode(t){if(this.nodeBasedRenderer){this.needsRender=!0,this.renderingStateTracker.updateNode(t.id);return}or(this.tree,t),this.markGroundNodesNeedRendering()}setTree(t){this.tree=t,this.markGroundNodesNeedRendering()}_update(t){var n,i,o,a,u,c;this.needsRender=!1,window.name=JSON.stringify(t.update),this.svgRenderer.update(),t.transform&&(this.updateTransform(t.transform),this.markNeedsReactRendering());let e=(n=t.document)!=null?n:{};e.loadedAllUserData?(this.loadedSomeUserData=!0,this.modulesRuntime.setEvaluationMode("eager")):e.loadedSomeUserData&&(this.loadedSomeUserData=!0,Jt.isOn("disableLazyModuleLoading")?this.modulesRuntime.setEvaluationMode("eager"):this.modulesRuntime.setEvaluationMode("lazy")),e.renderScope&&(this.scopeId=e.renderScope,this.groundNodeMap=void 0,this.isInitialLoad||(this.scopeSwitchStartTime=performance.now()),this.markNeedsReactRendering()),e.renderNodes&&(this.scopeId="",this.groundNodeMap=e.renderNodes,this.markNeedsReactRendering()),e.activeLocaleId&&(this.activeLocaleId=e.activeLocaleId,this.markNeedsReactRendering());let r=e.partialTreeUpdate;if(r){this.partialTreeReceiver||(this.partialTreeReceiver=new Lr(B));let d=this.partialTreeReceiver.update(r);this.setTree(d),r.tree&&this.loadStylePresetFontsAndThenMeasure(),r.changes&&r.changes.length>0&&this.layoutCache.pruneAfterTreeChanges(r.changes)}else{if(e.tree){N.debug("update",`took ${Date.now()-(e.timestamp||0)}ms to receive update`);let d=(i=Ge.fromJS(e.tree,B))!=null?i:void 0;if(d===void 0)throw Error("[Sandbox] Unable to build tree: "+e.tree);this.setTree(d),this.loadStylePresetFontsAndThenMeasure()}e.changes&&e.changes.length>0&&(Kt(this.tree,e.changes),this.layoutCache.pruneAfterTreeChanges(e.changes),this.setTree(this.tree.commitDiffs()))}if(this.tree.root.locales&&this.vekterLocales!==this.tree.root.locales&&(this.vekterLocales=this.tree.root.locales,this.routerLocales=ur(this.vekterLocales,{includeDrafts:!0}),this.modulesRuntime.refreshCollectionModules().catch(me)),this.previousCachedScopeId!==this.scopeId&&this.markGroundNodesNeedRendering(),e.nodeInTextEditor!==void 0){if(this.previousNodeInTextEditor){let m=this.tree.get(this.previousNodeInTextEditor);m&&(m.cache.isEditable=!1,this.rerenderNode(m))}this.previousNodeInTextEditor=e.nodeInTextEditor;let d=this.tree.get(e.nodeInTextEditor);d&&(d.cache.isEditable=!0,this.rerenderNode(d))}if(e.nodeInPathEditor!==void 0){if(this.previousNodeInPathEditor){let m=this.tree.get(this.previousNodeInPathEditor);m&&(m.cache.isEditable=!1)}this.previousNodeInPathEditor=e.nodeInPathEditor;let d=this.tree.get(e.nodeInPathEditor);d&&(d.cache.isEditable=!0)}if(e.nodesInEffectPreview!==void 0){if(this.previousNodesInEffectPreview){let l=new Set(e.nodesInEffectPreview);for(let h of this.previousNodesInEffectPreview){if(l.has(h))continue;let f=this.tree.get(h);f&&(f.cache.isEffectPreview=!1,f.cache.effectType=null,f.cache.effectIds=null,f.cache.webPageEffect=void 0,this.rerenderNode(f))}}this.previousActiveEffect=(o=e.activeEffect)!=null?o:this.previousActiveEffect,this.previousNodesInEffectPreview=e.nodesInEffectPreview;let d=this.tree.get(this.scopeId),m=ze(d);for(let l of e.nodesInEffectPreview){let h=this.tree.get(l);h&&(h.cache.isEffectPreview=!0,h.cache.effectType=(a=e.activeEffect)!=null?a:this.previousActiveEffect,h.cache.effectIds=(u=e.activeEffectIds)!=null?u:null,h.cache.webPageEffect=m,this.rerenderNode(h))}}if(e.activeOverlayNodes!==void 0){if(this.previousActiveOverlayNodes.size>0){let m=e.activeOverlayNodes;for(let l of this.previousActiveOverlayNodes){if(m.has(l))continue;let h=this.tree.get(l);h&&(Ye(this.tree,h,!1),this.rerenderNode(h))}}e.activeOverlayNodes.size===0&&this.renderingStateTracker.clearEntriesByNodeRectMeasured(),this.previousActiveOverlayNodes=e.activeOverlayNodes;let d=!1;for(let m of e.activeOverlayNodes){let l=this.tree.get(m);l&&(Ye(this.tree,l,!0),this.rerenderNode(l),d||(d=Ft(l)))}d!==this.inRelativeOverlayEditMode&&(this.inRelativeOverlayEditMode=d,this.markNeedsReactRendering())}if(this.nodeWithPlaceholder&&e.placeholder!==void 0){let d=this.tree.get(this.nodeWithPlaceholder.id);this.nodeWithPlaceholder.cache.placeholders=null,this.nodeWithPlaceholder=null,d&&(this.rerenderNode(d),this.nodeBasedRenderer||te(d)&&d.forceNeedsMeasure())}if(e.placeholder){let{id:d,placeholders:m}=e.placeholder,l=this.tree.get(d);l&&(this.nodeWithPlaceholder=l,l.cache.placeholders=m,this.rerenderNode(l),this.nodeBasedRenderer||te(l)&&l.forceNeedsMeasure())}if(e.scripts&&(dr(),ar(),B.updateStateWithScripts(e.scripts.map,ge),this.componentHash=e.scripts.hash,this.sandboxComponentLoaderService.emitComponentLoaderStateEvent({type:"fullStateSync",hash:this.calculateCodeRevision(),revision:(c=this.modulesRevision)!=null?c:-1,state:B.getSerializableState()}),this.nodeBasedRenderer||(Re(this.tree,this.sandboxCollectionData),this.markGroundNodesNeedRendering())),typeof e.isReadyToRender=="boolean"&&this.deferredRendering.setReadyToRender(e.isReadyToRender),typeof e.isDarkMode=="boolean"&&(this.updateDarkMode(e.isDarkMode),this.markNeedsReactRendering()),typeof e.performanceMode=="boolean"&&(this.performanceMode=e.performanceMode,this.markNeedsReactRendering()),e.collectionItemId){let d=this.tree.get(this.scopeId);ze(d)&&(d.cache.collectionItemSelector={selectedCollectionItemId:e.collectionItemId},this.nodeBasedRenderer?(this.renderingStateTracker.updateState({collectionItemId:e.collectionItemId}),this.markNeedsReactRendering()):(Re(this.tree,this.sandboxCollectionData),this.markGroundNodesNeedRendering()))}this.needsRender&&this.rerenderGroundNodesIfNeeded()}updateGroundNodeOverflowSizes(t){for(let[e,r]of Object.entries(t)){let n=this.tree.get(e);n&&(n.cache.minX=r.minX,n.cache.maxX=r.maxX,n.cache.minY=r.minY,n.cache.maxY=r.maxY)}}updateDarkMode(t){this.isDarkMode!==t&&(this.isDarkMode=t,document.body.classList.toggle("framer-theme-dark",t),document.body.dataset.framerTheme=t?"dark":"light")}rerenderComponentPresets(){let t=ye(this.tree);if(!t)return;let e=t.getComponentPresets();for(let r of e){let n=r.cache;n.isComponentLoaded||!n.links||this.invalidateNodes(n.links)}this.rerenderGroundNodesIfNeeded()}rerenderGroundNodesIfNeeded(){let t=this.getGroundNodes(qe);At(this.groundNodes,t)||(this.groundNodes=t),N.trace("rerenderGroundNodesIfNeeded"),this.triggerRenderer()}beforeRendering(){this.nodeBasedRenderer&&(this.renderingStateTracker.updateState({zoom:this.canvasZoom,assetHash:this.assetMapHash}),this.renderingStateTracker.signalChanges(this.groundNodes,this.tree.get(this.scopeId)))}startRendering(){let t=performance.now();this.updateCache(),this.updateViewportRect(),this.updateGroundNodesInViewport(),this.loadedSomeUserData&&this.deferredRendering.setGroundNodes(this.groundNodes,this.groundNodeIdsInViewport,this.scopeId),this.lastRendering.zoom=this.canvasZoom,this.lastRendering.scopeId=this.scopeId,this.lastRendering.offsetX=this.offsetX,this.lastRendering.offsetY=this.offsetY,this.lastRendering.tree=this.tree,this.lastRendering.groundNodesInViewport=this.groundNodeIdsInViewport,this.lastRendering.update=this.lastEngineUpdate;let e=performance.now();this.updateTime+=e-t,N.trace("startRendering: zoom",this.canvasZoom,"scroll",this.offsetX,this.offsetY,"rendering phase",this.deferredRendering.renderingPhase,"liveZoom",!!this.liveZoom),!this.scheduledPostRenderMicroQueue&&(this.scheduledPostRenderMicroQueue=!0,queueMicrotask(()=>{this.scheduledPostRenderMicroQueue=!1,this.renderTime+=performance.now()-e,this.measureLayoutAndEmitUpdate()}))}measureLayout(t){if(this.liveZoom)return[];if(this.previousNodesInEffectPreview.length>0)return[];Ve("LayoutMeasure");let e=this.layoutMeasureQueue.process(this.lastRendering);We(`LayoutMeasure ${t}`,"LayoutMeasure"),He("LayoutMeasure");let r=this.layoutCache.processLayoutMeasurements(e);return this.nodeBasedRenderer||Vt(this.tree,this.layoutCache,r,!1),e}getGroundNodes(t){let e=this.tree;if(this.scopeId){let n=e.get(this.scopeId);return X(n instanceof Bt,"Can't find active page in tree"),n.getGroundNodes(t)}let r=[];if(this.groundNodeMap)for(let n in this.groundNodeMap){let i=e.get(n);if(!i)continue;let o=this.groundNodeMap[n],a=Ir(e,i,this.layoutCache,this.sandboxCollectionData,o,this.isDarkMode);r.push(a)}return r}command({command:t,args:e}){t==="clearCache"?(this.forceRender+=1,this.tree.resetDraftNodesAndCache(),this.setTree(this.tree)):t==="setEnvironment"&&pe(e)?Object.assign(yt,e):t==="setLogLevel"&&Pt(e)?vt(e,!1):t==="renderingFeatures"&&pe(e)?Ur(e,this.renderingStateTracker):t==="updateGroundNodeOverflowSizes"&&pe(e)?this.updateGroundNodeOverflowSizes(e):N.warn("unknown command:",t,e)}getAndResetTimings(){let t=this.updateTime,e=this.renderTime;return this.updateTime=0,this.renderTime=0,{updateTime:t,renderTime:e}}update({fixmeOpaqueJSON:t}){var c;Ve("sandbox"),this.nodeBasedRenderer=V.isOn("nodeBasedRenderer");let e=this.scopeId;this.startedHeartbeat||(this.startedHeartbeat=!0,setTimeout(this.emitHeartbeat));let r=performance.now(),n=!1,i=-1;Dr(t)?(i=t.update,this.lastEngineUpdate=t.update,this._update(t),n=!0):Sr(t)&&this.command(t);let o=this.deferredRendering.renderingPhase;this.updateTime+=performance.now()-r,e!==this.scopeId&&!this.isInitialLoad&&(this.scopeSwitchUpdateEndTime=performance.now());let{updateTime:a,renderTime:u}=this.getAndResetTimings();return this.renderedUpdateEmitter.emit({update:i,updateTime:a,renderTime:u,renderingPhase:o,moduleRuntimePhase:this.modulesRuntime.phase,layoutMeasurements:[],collectionRecordUpdates:this.sandboxCollectionData.getUpdates(),scopeId:(c=this.scopeId)!=null?c:"",updateEndTime:0,renderEndTime:0,scopeSwitchStartTime:0}),It(),We("Sandbox "+i,"sandbox"),He("sandbox"),er(),J(this,ne).forEach(d=>d()),at(this,ne,[]),n}runAfterNextUpdate(t){J(this,ne).push(t)}renderedUpdateStream(t){return this.renderedUpdateEmitter.newStream(t)}loadStylePresetFontsAndThenMeasure(){let t=ye(this.tree);if(!t)return;let e=[];for(let r of t.children){if(Ut(r))continue;let n=r.getFontsForCodeGeneration();for(let i of n)$.isSelectorLoaded(i)||e.push(i)}e.length>0?$.loadFonts(e).then(()=>this.layoutMeasureQueue.stylePresetChanged(this.tree)).catch(me):this.layoutMeasureQueue.stylePresetChanged(this.tree)}async waitUntilFontsLoaded(){let t=this.getGroundNodes(),e=[];for(let n of t)for(let i of n.walk())Or(i)&&i.hasFontsToLoad()&&e.push(i);let r=new Set;try{await Promise.allSettled(e.map(n=>{let i=n.getFontsForLoading();return $.loadFonts(i).then(({newlyLoadedFontCount:o})=>{o>0&&r.add(n.id)}).catch(me)}))}catch{}for(let n of this.nodeIdsToRerender)r.add(n);this.invalidateNodes(r),this.nodeIdsToRerender.clear(),await new Promise(n=>{this.triggerRenderer(n)})}errorStream(t){return this.errorEmitter.newStream(t)}heartbeatStream(t){return this.heartbeatEmitter.newStream(t)}async waitUntilResourcesLoaded(){await this.isLoadingResourcesPromise}assertTrackingUpdates(t){X(t===this.isTrackingUpdates,"Update tracking (willStartUpdates/waitForCompleteRenderAfterUpdates) must be balanced and not nested")}async willStartUpdates(){this.assertTrackingUpdates(!1),this.isTrackingUpdates=!0}async waitForCompleteRenderAfterUpdates(){this.assertTrackingUpdates(!0),await this.waitUntilResourcesLoaded(),await this.waitUntilPlaceholdersSettled(),await this.waitUntilFontsLoaded(),await this.renderingQueuesDrained(),await Promise.race([new Promise(t=>requestAnimationFrame(t)),Zr(1e3,"CanvasSandboxApp: didn't render after 1s")]).finally(()=>{this.isTrackingUpdates=!1})}async renderingQueuesDrained(){await new Promise(t=>requestAnimationFrame(t));for(let t=0;t<100;t++){if(!A.hasImmediateTasksToRun())return;await new Promise(e=>requestAnimationFrame(e))}}async preloadFonts({selectors:t}){await $.loadFonts(t)}async getFitTextViewBoxes({ids:t,update:e}){for(;this.lastEngineUpdate<e;)await new Promise(n=>this.runAfterNextUpdate(n));let r=[];for(let n of this.tree.getNodesWithTrait(Object.keys(t),se))se(n)&&r.push(...n.getFontsForLoading());return await $.loadFonts(r),Qr(this.tree,t)}async measureNodes({ids:t}){if(this.previousNodesInEffectPreview.length>0)return{measurements:[]};let e=this.tree.getNodes(t),r=Xr(e).process({scopeId:this.scopeId,zoom:this.canvasZoom,offsetX:this.offsetX,offsetY:this.offsetY,tree:this.tree,groundNodesInViewport:this.groundNodeIdsInViewport});return N.trace("measureNodes:",r.length),{measurements:r}}async waitUntilPlaceholdersSettled(){return wt()}};ne=new WeakMap;var Le=H(he());Rt({name:"canvas",security:{allowChannelToOpenerWithOrigin:_t(document.referrer).origin}});var $r=k("canvas-sandbox"),M=new Ee;Object.assign(window,{Framer:ge,sandboxApp:M});$r.debug({assetMap:M.assetMap});var Nn=pr(M.assetMap),bn=M.layoutMeasureQueue.add.bind(M.layoutMeasureQueue);Lt({assetResolver:Nn,fetchGoogleFontsList:Rr,fetchFontshareFontsList:yr,enableFontStore:!0,executionTimeBudgets:{frame:500,component:150},queueMeasureRequest:bn,experiments:V,projectFeatures:fe,useImageSource:M.imageLoader.useImageSource,useImageElement:M.imageLoader.useImageElement,canRenderOptimizedCanvasImage:M.optimizedCanvasImageRenderer.canRenderCanvasImage,renderOptimizedCanvasImage:M.optimizedCanvasImageRenderer.renderCanvasImage,getLogger(s){return $r.extend(s)}});var xn=()=>{let[s,t]=Pe.default.useState(0),e=Er();return M.triggerRenderer=r=>{r&&e.add(r),M.beforeRendering(),t(s+1)},Pe.default.useEffect(()=>{for(let r of e)e.delete(r),r()}),M.startRendering(),M};vr((0,Le.jsx)(Pe.default.StrictMode,{children:(0,Le.jsx)(xr.Provider,{value:M.modulesRuntime,children:(0,Le.jsx)(Mr,{useState:xn})})}),document.querySelector("main"));
//# sourceMappingURL=https://app.framerstatic.com/canvas-sandbox.UZIMGC7T.js.map
